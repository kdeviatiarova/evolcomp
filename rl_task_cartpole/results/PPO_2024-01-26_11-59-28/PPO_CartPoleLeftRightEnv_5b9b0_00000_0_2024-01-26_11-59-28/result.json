{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9767049811780453, "cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 6.4413667023181915, "policy_loss": -0.01676596701145172, "vf_loss": 8.08001697063446, "vf_explained_var": 0.0008457135409116745, "kl": 0.005006789280985614, "entropy": 0.6882338244467974, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 16.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 2055, "num_env_steps_trained": 2055, "num_agent_steps_sampled": 2055, "num_agent_steps_trained": 2055}, "sampler_results": {"episode_reward_max": 53.104476787451375, "episode_reward_min": 5.806830189845882, "episode_reward_mean": 15.807755563736618, "episode_len_mean": 22.833333333333332, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.21391846775006, 23.758031733954276, 19.239901136630746, 12.687733095754078, 11.757106497134856, 8.795660735724148, 8.051477714665841, 15.636090300404987, 10.27876306107282, 11.853392051897899, 11.932727405807114, 11.039998135707025, 11.789388419009553, 25.41179583275334, 13.37933099221666, 9.406100260417807, 11.15268317017265, 16.32626773836135, 6.556496816781377, 29.829674036133902, 14.82944900863843, 22.286153497741612, 7.901334569499495, 22.3175342776828, 12.542747612142897, 15.597500014461701, 8.763326256420596, 38.40972326023514, 13.392235427865831, 10.367131494315458, 31.529126355300527, 13.204897384302564, 53.104476787451375, 11.67594795037361, 8.780574549608202, 24.19994416186893, 17.062131537529304, 15.718967517814082, 9.649840159321485, 6.35429470315802, 13.247168202019033, 13.253671815489362, 23.125725661335927, 37.24332522503497, 16.288185886111144, 5.806830189845882, 10.36269869231689, 11.644533618508353, 23.028651103662046, 12.521162108900334, 12.500429334174486, 14.849930640273266, 13.221696485823008, 14.09154869860258, 14.726070917256857, 15.513692455455224, 17.159489575516464, 17.722997654106074, 13.954074775058753, 12.530902308256353, 20.218641347618604, 10.33447937129197, 14.783530782214985, 14.836351084451312, 16.94390683061185, 16.32415652455323, 8.8082629963634, 32.37371484342939, 8.753327181898412, 11.021511646176158, 14.724981164743717, 7.147444870437863, 12.569776765803352, 26.055965060055055, 17.093585533859894, 12.55593267374526, 7.891297043374312, 29.73352082038009, 9.435900859649351, 17.0731596465408, 11.702562239129866, 19.29957117754564, 12.569898164119822, 14.881676186602743, 24.6552342701611, 16.437965861206802, 9.492950938532717, 6.419256682944642, 7.290437473395233, 41.69234121962859], "episode_lengths": [15, 33, 27, 19, 17, 14, 13, 22, 15, 18, 18, 17, 18, 36, 20, 14, 17, 23, 11, 41, 22, 31, 12, 32, 18, 23, 14, 53, 20, 16, 43, 19, 73, 17, 14, 34, 24, 23, 15, 10, 19, 20, 33, 52, 24, 10, 16, 17, 33, 18, 18, 21, 19, 20, 21, 22, 24, 25, 20, 19, 28, 16, 21, 22, 25, 24, 14, 44, 14, 17, 21, 11, 18, 36, 24, 19, 12, 42, 14, 25, 17, 28, 18, 22, 34, 23, 14, 10, 12, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5332037864492097, "mean_inference_ms": 1.4634974271870769, "mean_action_processing_ms": 0.2036843782269073, "mean_env_wait_ms": 4.567514017862104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007655090755886502, "StateBufferConnector_ms": 0.006113847096761067, "ViewRequirementAgentConnector_ms": 0.17002185185750326}}, "episode_reward_max": 53.104476787451375, "episode_reward_min": 5.806830189845882, "episode_reward_mean": 15.807755563736618, "episode_len_mean": 22.833333333333332, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.21391846775006, 23.758031733954276, 19.239901136630746, 12.687733095754078, 11.757106497134856, 8.795660735724148, 8.051477714665841, 15.636090300404987, 10.27876306107282, 11.853392051897899, 11.932727405807114, 11.039998135707025, 11.789388419009553, 25.41179583275334, 13.37933099221666, 9.406100260417807, 11.15268317017265, 16.32626773836135, 6.556496816781377, 29.829674036133902, 14.82944900863843, 22.286153497741612, 7.901334569499495, 22.3175342776828, 12.542747612142897, 15.597500014461701, 8.763326256420596, 38.40972326023514, 13.392235427865831, 10.367131494315458, 31.529126355300527, 13.204897384302564, 53.104476787451375, 11.67594795037361, 8.780574549608202, 24.19994416186893, 17.062131537529304, 15.718967517814082, 9.649840159321485, 6.35429470315802, 13.247168202019033, 13.253671815489362, 23.125725661335927, 37.24332522503497, 16.288185886111144, 5.806830189845882, 10.36269869231689, 11.644533618508353, 23.028651103662046, 12.521162108900334, 12.500429334174486, 14.849930640273266, 13.221696485823008, 14.09154869860258, 14.726070917256857, 15.513692455455224, 17.159489575516464, 17.722997654106074, 13.954074775058753, 12.530902308256353, 20.218641347618604, 10.33447937129197, 14.783530782214985, 14.836351084451312, 16.94390683061185, 16.32415652455323, 8.8082629963634, 32.37371484342939, 8.753327181898412, 11.021511646176158, 14.724981164743717, 7.147444870437863, 12.569776765803352, 26.055965060055055, 17.093585533859894, 12.55593267374526, 7.891297043374312, 29.73352082038009, 9.435900859649351, 17.0731596465408, 11.702562239129866, 19.29957117754564, 12.569898164119822, 14.881676186602743, 24.6552342701611, 16.437965861206802, 9.492950938532717, 6.419256682944642, 7.290437473395233, 41.69234121962859], "episode_lengths": [15, 33, 27, 19, 17, 14, 13, 22, 15, 18, 18, 17, 18, 36, 20, 14, 17, 23, 11, 41, 22, 31, 12, 32, 18, 23, 14, 53, 20, 16, 43, 19, 73, 17, 14, 34, 24, 23, 15, 10, 19, 20, 33, 52, 24, 10, 16, 17, 33, 18, 18, 21, 19, 20, 21, 22, 24, 25, 20, 19, 28, 16, 21, 22, 25, 24, 14, 44, 14, 17, 21, 11, 18, 36, 24, 19, 12, 42, 14, 25, 17, 28, 18, 22, 34, 23, 14, 10, 12, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5332037864492097, "mean_inference_ms": 1.4634974271870769, "mean_action_processing_ms": 0.2036843782269073, "mean_env_wait_ms": 4.567514017862104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007655090755886502, "StateBufferConnector_ms": 0.006113847096761067, "ViewRequirementAgentConnector_ms": 0.17002185185750326}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2055, "num_agent_steps_trained": 2055, "num_env_steps_sampled": 2055, "num_env_steps_trained": 2055, "num_env_steps_sampled_this_iter": 2055, "num_env_steps_trained_this_iter": 2055, "num_env_steps_sampled_throughput_per_sec": 143.77464272997744, "num_env_steps_trained_throughput_per_sec": 143.77464272997744, "timesteps_total": 2055, "num_steps_trained_this_iter": 2055, "agent_timesteps_total": 2055, "timers": {"training_iteration_time_ms": 14293.153, "sample_time_ms": 13994.089, "load_time_ms": 0.468, "load_throughput": 4393116.575, "learn_time_ms": 297.878, "learn_throughput": 6898.808, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 2055, "num_env_steps_trained": 2055, "num_agent_steps_sampled": 2055, "num_agent_steps_trained": 2055}, "done": false, "episodes_total": 90, "training_iteration": 1, "trial_id": "5b9b0_00000", "date": "2024-01-26_11-59-44", "timestamp": 1706270384, "time_this_iter_s": 14.294938802719116, "time_total_s": 14.294938802719116, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 14.294938802719116, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 82.63809523809525, "ram_util_percent": 16.085714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6139144375920296, "cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 7.019101947546005, "policy_loss": -0.010781791293993592, "vf_loss": 8.794979810714722, "vf_explained_var": -0.0006011836230754852, "kl": 0.00314952631598836, "entropy": 0.6730027310550213, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 48.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 4108, "num_env_steps_trained": 4108, "num_agent_steps_sampled": 4108, "num_agent_steps_trained": 4108}, "sampler_results": {"episode_reward_max": 81.39922203018638, "episode_reward_min": 6.419256682944642, "episode_reward_mean": 21.588837796793623, "episode_len_mean": 30.29, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.36269869231689, 11.644533618508353, 23.028651103662046, 12.521162108900334, 12.500429334174486, 14.849930640273266, 13.221696485823008, 14.09154869860258, 14.726070917256857, 15.513692455455224, 17.159489575516464, 17.722997654106074, 13.954074775058753, 12.530902308256353, 20.218641347618604, 10.33447937129197, 14.783530782214985, 14.836351084451312, 16.94390683061185, 16.32415652455323, 8.8082629963634, 32.37371484342939, 8.753327181898412, 11.021511646176158, 14.724981164743717, 7.147444870437863, 12.569776765803352, 26.055965060055055, 17.093585533859894, 12.55593267374526, 7.891297043374312, 29.73352082038009, 9.435900859649351, 17.0731596465408, 11.702562239129866, 19.29957117754564, 12.569898164119822, 14.881676186602743, 24.6552342701611, 16.437965861206802, 9.492950938532717, 6.419256682944642, 7.290437473395233, 41.69234121962859, 20.112333866884704, 26.075584604049354, 34.1878985242746, 15.653073158070214, 23.117528318592495, 14.825359278506236, 12.60185609004032, 17.151617888079176, 28.477328957493963, 21.76948480430101, 19.440758606986712, 11.045710120059903, 30.694435172622956, 8.746264019430933, 15.615298976893524, 51.85391332365463, 29.352743661404773, 33.34314510666852, 23.589824072597473, 27.168519459651332, 23.20690339628824, 15.674293769451928, 17.07680993110498, 39.44037041727716, 37.60261913765677, 30.06533898661472, 81.39922203018638, 25.778991447360173, 25.703604951346286, 28.724552413250976, 17.782117661761102, 51.75988674683045, 22.546349922016056, 11.842582406039071, 68.67573901849623, 29.873329285707822, 33.68369550929765, 29.820343262675244, 21.513681259233564, 26.88198427953818, 21.739955089270058, 26.933591891130526, 29.20574683415568, 21.799217116275567, 10.985626554553521, 13.322761162043795, 40.73220365256049, 34.4066960039186, 30.186842726739023, 27.14832622950724, 27.525735895853074, 14.125380373867209, 15.564698258080377, 14.77107989581763, 33.12841013335603, 16.483194391460785], "episode_lengths": [16, 17, 33, 18, 18, 21, 19, 20, 21, 22, 24, 25, 20, 19, 28, 16, 21, 22, 25, 24, 14, 44, 14, 17, 21, 11, 18, 36, 24, 19, 12, 42, 14, 25, 17, 28, 18, 22, 34, 23, 14, 10, 12, 58, 28, 36, 46, 22, 32, 21, 19, 24, 39, 30, 28, 17, 43, 14, 22, 69, 40, 47, 33, 38, 32, 23, 24, 53, 52, 41, 107, 36, 35, 40, 26, 71, 31, 18, 89, 41, 46, 41, 31, 37, 31, 38, 40, 30, 16, 20, 57, 47, 42, 38, 38, 20, 22, 22, 46, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49312718317948523, "mean_inference_ms": 1.3758520625049602, "mean_action_processing_ms": 0.18584377809480188, "mean_env_wait_ms": 4.1468299061368326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006899118423461914, "StateBufferConnector_ms": 0.005511283874511719, "ViewRequirementAgentConnector_ms": 0.13918447494506836}}, "episode_reward_max": 81.39922203018638, "episode_reward_min": 6.419256682944642, "episode_reward_mean": 21.588837796793623, "episode_len_mean": 30.29, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.36269869231689, 11.644533618508353, 23.028651103662046, 12.521162108900334, 12.500429334174486, 14.849930640273266, 13.221696485823008, 14.09154869860258, 14.726070917256857, 15.513692455455224, 17.159489575516464, 17.722997654106074, 13.954074775058753, 12.530902308256353, 20.218641347618604, 10.33447937129197, 14.783530782214985, 14.836351084451312, 16.94390683061185, 16.32415652455323, 8.8082629963634, 32.37371484342939, 8.753327181898412, 11.021511646176158, 14.724981164743717, 7.147444870437863, 12.569776765803352, 26.055965060055055, 17.093585533859894, 12.55593267374526, 7.891297043374312, 29.73352082038009, 9.435900859649351, 17.0731596465408, 11.702562239129866, 19.29957117754564, 12.569898164119822, 14.881676186602743, 24.6552342701611, 16.437965861206802, 9.492950938532717, 6.419256682944642, 7.290437473395233, 41.69234121962859, 20.112333866884704, 26.075584604049354, 34.1878985242746, 15.653073158070214, 23.117528318592495, 14.825359278506236, 12.60185609004032, 17.151617888079176, 28.477328957493963, 21.76948480430101, 19.440758606986712, 11.045710120059903, 30.694435172622956, 8.746264019430933, 15.615298976893524, 51.85391332365463, 29.352743661404773, 33.34314510666852, 23.589824072597473, 27.168519459651332, 23.20690339628824, 15.674293769451928, 17.07680993110498, 39.44037041727716, 37.60261913765677, 30.06533898661472, 81.39922203018638, 25.778991447360173, 25.703604951346286, 28.724552413250976, 17.782117661761102, 51.75988674683045, 22.546349922016056, 11.842582406039071, 68.67573901849623, 29.873329285707822, 33.68369550929765, 29.820343262675244, 21.513681259233564, 26.88198427953818, 21.739955089270058, 26.933591891130526, 29.20574683415568, 21.799217116275567, 10.985626554553521, 13.322761162043795, 40.73220365256049, 34.4066960039186, 30.186842726739023, 27.14832622950724, 27.525735895853074, 14.125380373867209, 15.564698258080377, 14.77107989581763, 33.12841013335603, 16.483194391460785], "episode_lengths": [16, 17, 33, 18, 18, 21, 19, 20, 21, 22, 24, 25, 20, 19, 28, 16, 21, 22, 25, 24, 14, 44, 14, 17, 21, 11, 18, 36, 24, 19, 12, 42, 14, 25, 17, 28, 18, 22, 34, 23, 14, 10, 12, 58, 28, 36, 46, 22, 32, 21, 19, 24, 39, 30, 28, 17, 43, 14, 22, 69, 40, 47, 33, 38, 32, 23, 24, 53, 52, 41, 107, 36, 35, 40, 26, 71, 31, 18, 89, 41, 46, 41, 31, 37, 31, 38, 40, 30, 16, 20, 57, 47, 42, 38, 38, 20, 22, 22, 46, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49312718317948523, "mean_inference_ms": 1.3758520625049602, "mean_action_processing_ms": 0.18584377809480188, "mean_env_wait_ms": 4.1468299061368326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006899118423461914, "StateBufferConnector_ms": 0.005511283874511719, "ViewRequirementAgentConnector_ms": 0.13918447494506836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4108, "num_agent_steps_trained": 4108, "num_env_steps_sampled": 4108, "num_env_steps_trained": 4108, "num_env_steps_sampled_this_iter": 2053, "num_env_steps_trained_this_iter": 2053, "num_env_steps_sampled_throughput_per_sec": 205.56090718400114, "num_env_steps_trained_throughput_per_sec": 205.56090718400114, "timesteps_total": 4108, "num_steps_trained_this_iter": 2053, "agent_timesteps_total": 4108, "timers": {"training_iteration_time_ms": 12140.216, "sample_time_ms": 11894.554, "load_time_ms": 0.43, "load_throughput": 4782181.746, "learn_time_ms": 244.69, "learn_throughput": 8394.285, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 4108, "num_env_steps_trained": 4108, "num_agent_steps_sampled": 4108, "num_agent_steps_trained": 4108}, "done": false, "episodes_total": 146, "training_iteration": 2, "trial_id": "5b9b0_00000", "date": "2024-01-26_11-59-54", "timestamp": 1706270394, "time_this_iter_s": 9.988407135009766, "time_total_s": 24.283345937728882, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 24.283345937728882, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 76.80714285714286, "ram_util_percent": 16.407142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8363521602004766, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 7.106592684984207, "policy_loss": -0.01662584245787002, "vf_loss": 8.911609023809433, "vf_explained_var": 0.017873667180538177, "kl": 0.004216002118037979, "entropy": 0.6490424554795027, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 80.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 6164, "num_env_steps_trained": 6164, "num_agent_steps_sampled": 6164, "num_agent_steps_trained": 6164}, "sampler_results": {"episode_reward_max": 90.84390996433284, "episode_reward_min": 7.329899126544289, "episode_reward_mean": 29.342410665003108, "episode_len_mean": 40.45, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.1878985242746, 15.653073158070214, 23.117528318592495, 14.825359278506236, 12.60185609004032, 17.151617888079176, 28.477328957493963, 21.76948480430101, 19.440758606986712, 11.045710120059903, 30.694435172622956, 8.746264019430933, 15.615298976893524, 51.85391332365463, 29.352743661404773, 33.34314510666852, 23.589824072597473, 27.168519459651332, 23.20690339628824, 15.674293769451928, 17.07680993110498, 39.44037041727716, 37.60261913765677, 30.06533898661472, 81.39922203018638, 25.778991447360173, 25.703604951346286, 28.724552413250976, 17.782117661761102, 51.75988674683045, 22.546349922016056, 11.842582406039071, 68.67573901849623, 29.873329285707822, 33.68369550929765, 29.820343262675244, 21.513681259233564, 26.88198427953818, 21.739955089270058, 26.933591891130526, 29.20574683415568, 21.799217116275567, 10.985626554553521, 13.322761162043795, 40.73220365256049, 34.4066960039186, 30.186842726739023, 27.14832622950724, 27.525735895853074, 14.125380373867209, 15.564698258080377, 14.77107989581763, 33.12841013335603, 16.483194391460785, 9.4731957845439, 11.77977926641685, 33.249282834398954, 20.12455593003499, 40.314357477922016, 37.39595390268663, 10.256374531358706, 26.19671957986689, 19.20929914127528, 13.462426480458458, 30.19580168953359, 12.495869037820206, 68.36202308136296, 44.083527330602905, 39.19449868670599, 20.38522365154195, 46.861220312268564, 34.50975862506572, 21.793921024605638, 7.329899126544289, 12.623247168252233, 55.79402009355772, 24.68710443856606, 73.75111609588906, 14.823093239167566, 29.161025346066452, 14.148798998613158, 31.5257135383778, 22.582135042712846, 11.865612264061365, 47.376897442263605, 44.02115768896726, 29.845192378764665, 25.53823825783777, 29.229949779135875, 31.392230983487245, 90.84390996433284, 55.10100645198209, 68.47385434515601, 17.038508314009785, 35.186396964265526, 32.2236302560188, 17.93321391104786, 60.942452250761924, 40.14003798512716, 35.572194226822496], "episode_lengths": [46, 22, 32, 21, 19, 24, 39, 30, 28, 17, 43, 14, 22, 69, 40, 47, 33, 38, 32, 23, 24, 53, 52, 41, 107, 36, 35, 40, 26, 71, 31, 18, 89, 41, 46, 41, 31, 37, 31, 38, 40, 30, 16, 20, 57, 47, 42, 38, 38, 20, 22, 22, 46, 24, 14, 18, 45, 29, 54, 51, 15, 36, 27, 20, 42, 18, 93, 59, 54, 29, 63, 47, 31, 12, 19, 74, 34, 102, 22, 40, 21, 44, 32, 18, 64, 60, 41, 36, 40, 44, 117, 73, 91, 25, 48, 45, 25, 79, 56, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45082311150812066, "mean_inference_ms": 1.2854375325861382, "mean_action_processing_ms": 0.16741816279542973, "mean_env_wait_ms": 3.7110215544121616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006790637969970703, "StateBufferConnector_ms": 0.005540370941162109, "ViewRequirementAgentConnector_ms": 0.14294075965881348}}, "episode_reward_max": 90.84390996433284, "episode_reward_min": 7.329899126544289, "episode_reward_mean": 29.342410665003108, "episode_len_mean": 40.45, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.1878985242746, 15.653073158070214, 23.117528318592495, 14.825359278506236, 12.60185609004032, 17.151617888079176, 28.477328957493963, 21.76948480430101, 19.440758606986712, 11.045710120059903, 30.694435172622956, 8.746264019430933, 15.615298976893524, 51.85391332365463, 29.352743661404773, 33.34314510666852, 23.589824072597473, 27.168519459651332, 23.20690339628824, 15.674293769451928, 17.07680993110498, 39.44037041727716, 37.60261913765677, 30.06533898661472, 81.39922203018638, 25.778991447360173, 25.703604951346286, 28.724552413250976, 17.782117661761102, 51.75988674683045, 22.546349922016056, 11.842582406039071, 68.67573901849623, 29.873329285707822, 33.68369550929765, 29.820343262675244, 21.513681259233564, 26.88198427953818, 21.739955089270058, 26.933591891130526, 29.20574683415568, 21.799217116275567, 10.985626554553521, 13.322761162043795, 40.73220365256049, 34.4066960039186, 30.186842726739023, 27.14832622950724, 27.525735895853074, 14.125380373867209, 15.564698258080377, 14.77107989581763, 33.12841013335603, 16.483194391460785, 9.4731957845439, 11.77977926641685, 33.249282834398954, 20.12455593003499, 40.314357477922016, 37.39595390268663, 10.256374531358706, 26.19671957986689, 19.20929914127528, 13.462426480458458, 30.19580168953359, 12.495869037820206, 68.36202308136296, 44.083527330602905, 39.19449868670599, 20.38522365154195, 46.861220312268564, 34.50975862506572, 21.793921024605638, 7.329899126544289, 12.623247168252233, 55.79402009355772, 24.68710443856606, 73.75111609588906, 14.823093239167566, 29.161025346066452, 14.148798998613158, 31.5257135383778, 22.582135042712846, 11.865612264061365, 47.376897442263605, 44.02115768896726, 29.845192378764665, 25.53823825783777, 29.229949779135875, 31.392230983487245, 90.84390996433284, 55.10100645198209, 68.47385434515601, 17.038508314009785, 35.186396964265526, 32.2236302560188, 17.93321391104786, 60.942452250761924, 40.14003798512716, 35.572194226822496], "episode_lengths": [46, 22, 32, 21, 19, 24, 39, 30, 28, 17, 43, 14, 22, 69, 40, 47, 33, 38, 32, 23, 24, 53, 52, 41, 107, 36, 35, 40, 26, 71, 31, 18, 89, 41, 46, 41, 31, 37, 31, 38, 40, 30, 16, 20, 57, 47, 42, 38, 38, 20, 22, 22, 46, 24, 14, 18, 45, 29, 54, 51, 15, 36, 27, 20, 42, 18, 93, 59, 54, 29, 63, 47, 31, 12, 19, 74, 34, 102, 22, 40, 21, 44, 32, 18, 64, 60, 41, 36, 40, 44, 117, 73, 91, 25, 48, 45, 25, 79, 56, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45082311150812066, "mean_inference_ms": 1.2854375325861382, "mean_action_processing_ms": 0.16741816279542973, "mean_env_wait_ms": 3.7110215544121616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006790637969970703, "StateBufferConnector_ms": 0.005540370941162109, "ViewRequirementAgentConnector_ms": 0.14294075965881348}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6164, "num_agent_steps_trained": 6164, "num_env_steps_sampled": 6164, "num_env_steps_trained": 6164, "num_env_steps_sampled_this_iter": 2056, "num_env_steps_trained_this_iter": 2056, "num_env_steps_sampled_throughput_per_sec": 201.81439702937067, "num_env_steps_trained_throughput_per_sec": 201.81439702937067, "timesteps_total": 6164, "num_steps_trained_this_iter": 2056, "agent_timesteps_total": 6164, "timers": {"training_iteration_time_ms": 11489.328, "sample_time_ms": 11258.196, "load_time_ms": 0.403, "load_throughput": 5093319.515, "learn_time_ms": 230.25, "learn_throughput": 8923.638, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 6164, "num_env_steps_trained": 6164, "num_agent_steps_sampled": 6164, "num_agent_steps_trained": 6164}, "done": false, "episodes_total": 192, "training_iteration": 3, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-00-04", "timestamp": 1706270404, "time_this_iter_s": 10.188788175582886, "time_total_s": 34.47213411331177, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 34.47213411331177, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 77.2, "ram_util_percent": 16.326666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6212782636284828, "cur_kl_coeff": 0.05, "cur_lr": 0.0003, "total_loss": 7.233766630291939, "policy_loss": -0.018235600786283612, "vf_loss": 9.072536259889603, "vf_explained_var": -0.009497711434960365, "kl": 0.004863246838426552, "entropy": 0.6269869320094585, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 112.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 8220, "num_env_steps_trained": 8220, "num_agent_steps_sampled": 8220, "num_agent_steps_trained": 8220}, "sampler_results": {"episode_reward_max": 90.84390996433284, "episode_reward_min": 7.329899126544289, "episode_reward_mean": 34.18420297557552, "episode_len_mean": 46.8, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.88198427953818, 21.739955089270058, 26.933591891130526, 29.20574683415568, 21.799217116275567, 10.985626554553521, 13.322761162043795, 40.73220365256049, 34.4066960039186, 30.186842726739023, 27.14832622950724, 27.525735895853074, 14.125380373867209, 15.564698258080377, 14.77107989581763, 33.12841013335603, 16.483194391460785, 9.4731957845439, 11.77977926641685, 33.249282834398954, 20.12455593003499, 40.314357477922016, 37.39595390268663, 10.256374531358706, 26.19671957986689, 19.20929914127528, 13.462426480458458, 30.19580168953359, 12.495869037820206, 68.36202308136296, 44.083527330602905, 39.19449868670599, 20.38522365154195, 46.861220312268564, 34.50975862506572, 21.793921024605638, 7.329899126544289, 12.623247168252233, 55.79402009355772, 24.68710443856606, 73.75111609588906, 14.823093239167566, 29.161025346066452, 14.148798998613158, 31.5257135383778, 22.582135042712846, 11.865612264061365, 47.376897442263605, 44.02115768896726, 29.845192378764665, 25.53823825783777, 29.229949779135875, 31.392230983487245, 90.84390996433284, 55.10100645198209, 68.47385434515601, 17.038508314009785, 35.186396964265526, 32.2236302560188, 17.93321391104786, 60.942452250761924, 40.14003798512716, 35.572194226822496, 79.20922932028176, 12.428679660129317, 63.535415591777195, 21.948919827165607, 67.37339264309807, 45.57559414098598, 44.63491891840039, 47.810394015805514, 70.24033912915809, 71.1836651752049, 65.41797823353686, 73.0278952500597, 49.4461291253068, 7.34428555444968, 21.71431052544613, 20.834731855590583, 27.203159082271522, 67.64645880541717, 68.7308949890648, 22.3980412459082, 21.75486637985066, 44.75185195445378, 23.091904409179822, 44.84965447851783, 26.94933207335088, 25.410529255484803, 10.986413768455188, 34.01388896823288, 14.915490429296344, 29.73741601231167, 25.605075981499457, 23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084], "episode_lengths": [37, 31, 38, 40, 30, 16, 20, 57, 47, 42, 38, 38, 20, 22, 22, 46, 24, 14, 18, 45, 29, 54, 51, 15, 36, 27, 20, 42, 18, 93, 59, 54, 29, 63, 47, 31, 12, 19, 74, 34, 102, 22, 40, 21, 44, 32, 18, 64, 60, 41, 36, 40, 44, 117, 73, 91, 25, 48, 45, 25, 79, 56, 49, 105, 18, 92, 31, 87, 64, 59, 66, 92, 94, 83, 102, 68, 12, 30, 29, 37, 87, 92, 32, 31, 63, 32, 60, 37, 35, 16, 46, 21, 41, 35, 33, 28, 28, 66, 94, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4363245633521104, "mean_inference_ms": 1.2576651304046664, "mean_action_processing_ms": 0.16168562232671996, "mean_env_wait_ms": 3.578626114357535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006850719451904297, "StateBufferConnector_ms": 0.0054929256439208984, "ViewRequirementAgentConnector_ms": 0.14676117897033691}}, "episode_reward_max": 90.84390996433284, "episode_reward_min": 7.329899126544289, "episode_reward_mean": 34.18420297557552, "episode_len_mean": 46.8, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.88198427953818, 21.739955089270058, 26.933591891130526, 29.20574683415568, 21.799217116275567, 10.985626554553521, 13.322761162043795, 40.73220365256049, 34.4066960039186, 30.186842726739023, 27.14832622950724, 27.525735895853074, 14.125380373867209, 15.564698258080377, 14.77107989581763, 33.12841013335603, 16.483194391460785, 9.4731957845439, 11.77977926641685, 33.249282834398954, 20.12455593003499, 40.314357477922016, 37.39595390268663, 10.256374531358706, 26.19671957986689, 19.20929914127528, 13.462426480458458, 30.19580168953359, 12.495869037820206, 68.36202308136296, 44.083527330602905, 39.19449868670599, 20.38522365154195, 46.861220312268564, 34.50975862506572, 21.793921024605638, 7.329899126544289, 12.623247168252233, 55.79402009355772, 24.68710443856606, 73.75111609588906, 14.823093239167566, 29.161025346066452, 14.148798998613158, 31.5257135383778, 22.582135042712846, 11.865612264061365, 47.376897442263605, 44.02115768896726, 29.845192378764665, 25.53823825783777, 29.229949779135875, 31.392230983487245, 90.84390996433284, 55.10100645198209, 68.47385434515601, 17.038508314009785, 35.186396964265526, 32.2236302560188, 17.93321391104786, 60.942452250761924, 40.14003798512716, 35.572194226822496, 79.20922932028176, 12.428679660129317, 63.535415591777195, 21.948919827165607, 67.37339264309807, 45.57559414098598, 44.63491891840039, 47.810394015805514, 70.24033912915809, 71.1836651752049, 65.41797823353686, 73.0278952500597, 49.4461291253068, 7.34428555444968, 21.71431052544613, 20.834731855590583, 27.203159082271522, 67.64645880541717, 68.7308949890648, 22.3980412459082, 21.75486637985066, 44.75185195445378, 23.091904409179822, 44.84965447851783, 26.94933207335088, 25.410529255484803, 10.986413768455188, 34.01388896823288, 14.915490429296344, 29.73741601231167, 25.605075981499457, 23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084], "episode_lengths": [37, 31, 38, 40, 30, 16, 20, 57, 47, 42, 38, 38, 20, 22, 22, 46, 24, 14, 18, 45, 29, 54, 51, 15, 36, 27, 20, 42, 18, 93, 59, 54, 29, 63, 47, 31, 12, 19, 74, 34, 102, 22, 40, 21, 44, 32, 18, 64, 60, 41, 36, 40, 44, 117, 73, 91, 25, 48, 45, 25, 79, 56, 49, 105, 18, 92, 31, 87, 64, 59, 66, 92, 94, 83, 102, 68, 12, 30, 29, 37, 87, 92, 32, 31, 63, 32, 60, 37, 35, 16, 46, 21, 41, 35, 33, 28, 28, 66, 94, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4363245633521104, "mean_inference_ms": 1.2576651304046664, "mean_action_processing_ms": 0.16168562232671996, "mean_env_wait_ms": 3.578626114357535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006850719451904297, "StateBufferConnector_ms": 0.0054929256439208984, "ViewRequirementAgentConnector_ms": 0.14676117897033691}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8220, "num_agent_steps_trained": 8220, "num_env_steps_sampled": 8220, "num_env_steps_trained": 8220, "num_env_steps_sampled_this_iter": 2056, "num_env_steps_trained_this_iter": 2056, "num_env_steps_sampled_throughput_per_sec": 203.4570117448414, "num_env_steps_trained_throughput_per_sec": 203.4570117448414, "timesteps_total": 8220, "num_steps_trained_this_iter": 2056, "agent_timesteps_total": 8220, "timers": {"training_iteration_time_ms": 11143.319, "sample_time_ms": 10889.347, "load_time_ms": 0.456, "load_throughput": 4505642.823, "learn_time_ms": 253.013, "learn_throughput": 8122.119, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 8220, "num_env_steps_trained": 8220, "num_agent_steps_sampled": 8220, "num_agent_steps_trained": 8220}, "done": false, "episodes_total": 229, "training_iteration": 4, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-00-14", "timestamp": 1706270414, "time_this_iter_s": 10.109488010406494, "time_total_s": 44.58162212371826, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 44.58162212371826, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 75.07857142857142, "ram_util_percent": 16.392857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3908079667016864, "cur_kl_coeff": 0.025, "cur_lr": 0.0003, "total_loss": 7.4927529245615005, "policy_loss": -0.034957280731759965, "vf_loss": 9.41718503832817, "vf_explained_var": 0.07926127687096596, "kl": 0.005874696384212522, "entropy": 0.6184625905007124, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 144.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 10308, "num_env_steps_trained": 10308, "num_agent_steps_sampled": 10308, "num_agent_steps_trained": 10308}, "sampler_results": {"episode_reward_max": 175.97355063038322, "episode_reward_min": 7.329899126544289, "episode_reward_mean": 44.20182905600592, "episode_len_mean": 59.89, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.256374531358706, 26.19671957986689, 19.20929914127528, 13.462426480458458, 30.19580168953359, 12.495869037820206, 68.36202308136296, 44.083527330602905, 39.19449868670599, 20.38522365154195, 46.861220312268564, 34.50975862506572, 21.793921024605638, 7.329899126544289, 12.623247168252233, 55.79402009355772, 24.68710443856606, 73.75111609588906, 14.823093239167566, 29.161025346066452, 14.148798998613158, 31.5257135383778, 22.582135042712846, 11.865612264061365, 47.376897442263605, 44.02115768896726, 29.845192378764665, 25.53823825783777, 29.229949779135875, 31.392230983487245, 90.84390996433284, 55.10100645198209, 68.47385434515601, 17.038508314009785, 35.186396964265526, 32.2236302560188, 17.93321391104786, 60.942452250761924, 40.14003798512716, 35.572194226822496, 79.20922932028176, 12.428679660129317, 63.535415591777195, 21.948919827165607, 67.37339264309807, 45.57559414098598, 44.63491891840039, 47.810394015805514, 70.24033912915809, 71.1836651752049, 65.41797823353686, 73.0278952500597, 49.4461291253068, 7.34428555444968, 21.71431052544613, 20.834731855590583, 27.203159082271522, 67.64645880541717, 68.7308949890648, 22.3980412459082, 21.75486637985066, 44.75185195445378, 23.091904409179822, 44.84965447851783, 26.94933207335088, 25.410529255484803, 10.986413768455188, 34.01388896823288, 14.915490429296344, 29.73741601231167, 25.605075981499457, 23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084, 68.09840103900034, 60.627427771582084, 28.462717086413278, 30.03296482983193, 59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272], "episode_lengths": [15, 36, 27, 20, 42, 18, 93, 59, 54, 29, 63, 47, 31, 12, 19, 74, 34, 102, 22, 40, 21, 44, 32, 18, 64, 60, 41, 36, 40, 44, 117, 73, 91, 25, 48, 45, 25, 79, 56, 49, 105, 18, 92, 31, 87, 64, 59, 66, 92, 94, 83, 102, 68, 12, 30, 29, 37, 87, 92, 32, 31, 63, 32, 60, 37, 35, 16, 46, 21, 41, 35, 33, 28, 28, 66, 94, 110, 88, 79, 40, 41, 82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4247111668875331, "mean_inference_ms": 1.2359795676188698, "mean_action_processing_ms": 0.1574122458701644, "mean_env_wait_ms": 3.47678081076591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006883144378662109, "StateBufferConnector_ms": 0.005434274673461914, "ViewRequirementAgentConnector_ms": 0.14613127708435059}}, "episode_reward_max": 175.97355063038322, "episode_reward_min": 7.329899126544289, "episode_reward_mean": 44.20182905600592, "episode_len_mean": 59.89, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.256374531358706, 26.19671957986689, 19.20929914127528, 13.462426480458458, 30.19580168953359, 12.495869037820206, 68.36202308136296, 44.083527330602905, 39.19449868670599, 20.38522365154195, 46.861220312268564, 34.50975862506572, 21.793921024605638, 7.329899126544289, 12.623247168252233, 55.79402009355772, 24.68710443856606, 73.75111609588906, 14.823093239167566, 29.161025346066452, 14.148798998613158, 31.5257135383778, 22.582135042712846, 11.865612264061365, 47.376897442263605, 44.02115768896726, 29.845192378764665, 25.53823825783777, 29.229949779135875, 31.392230983487245, 90.84390996433284, 55.10100645198209, 68.47385434515601, 17.038508314009785, 35.186396964265526, 32.2236302560188, 17.93321391104786, 60.942452250761924, 40.14003798512716, 35.572194226822496, 79.20922932028176, 12.428679660129317, 63.535415591777195, 21.948919827165607, 67.37339264309807, 45.57559414098598, 44.63491891840039, 47.810394015805514, 70.24033912915809, 71.1836651752049, 65.41797823353686, 73.0278952500597, 49.4461291253068, 7.34428555444968, 21.71431052544613, 20.834731855590583, 27.203159082271522, 67.64645880541717, 68.7308949890648, 22.3980412459082, 21.75486637985066, 44.75185195445378, 23.091904409179822, 44.84965447851783, 26.94933207335088, 25.410529255484803, 10.986413768455188, 34.01388896823288, 14.915490429296344, 29.73741601231167, 25.605075981499457, 23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084, 68.09840103900034, 60.627427771582084, 28.462717086413278, 30.03296482983193, 59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272], "episode_lengths": [15, 36, 27, 20, 42, 18, 93, 59, 54, 29, 63, 47, 31, 12, 19, 74, 34, 102, 22, 40, 21, 44, 32, 18, 64, 60, 41, 36, 40, 44, 117, 73, 91, 25, 48, 45, 25, 79, 56, 49, 105, 18, 92, 31, 87, 64, 59, 66, 92, 94, 83, 102, 68, 12, 30, 29, 37, 87, 92, 32, 31, 63, 32, 60, 37, 35, 16, 46, 21, 41, 35, 33, 28, 28, 66, 94, 110, 88, 79, 40, 41, 82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4247111668875331, "mean_inference_ms": 1.2359795676188698, "mean_action_processing_ms": 0.1574122458701644, "mean_env_wait_ms": 3.47678081076591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006883144378662109, "StateBufferConnector_ms": 0.005434274673461914, "ViewRequirementAgentConnector_ms": 0.14613127708435059}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10308, "num_agent_steps_trained": 10308, "num_env_steps_sampled": 10308, "num_env_steps_trained": 10308, "num_env_steps_sampled_this_iter": 2088, "num_env_steps_trained_this_iter": 2088, "num_env_steps_sampled_throughput_per_sec": 226.48761094818497, "num_env_steps_trained_throughput_per_sec": 226.48761094818497, "timesteps_total": 10308, "num_steps_trained_this_iter": 2088, "agent_timesteps_total": 10308, "timers": {"training_iteration_time_ms": 10758.458, "sample_time_ms": 10510.054, "load_time_ms": 0.448, "load_throughput": 4601903.739, "learn_time_ms": 247.47, "learn_throughput": 8330.694, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 10308, "num_env_steps_trained": 10308, "num_agent_steps_sampled": 10308, "num_agent_steps_trained": 10308}, "done": false, "episodes_total": 252, "training_iteration": 5, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-00-23", "timestamp": 1706270423, "time_this_iter_s": 9.22011923789978, "time_total_s": 53.80174136161804, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 53.80174136161804, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 67.88571428571429, "ram_util_percent": 16.492857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.24087207089178264, "cur_kl_coeff": 0.025, "cur_lr": 0.0003, "total_loss": 7.662917926907539, "policy_loss": -0.02323807244829368, "vf_loss": 9.6152523458004, "vf_explained_var": -0.03881186246871948, "kl": 0.0026010076819910355, "entropy": 0.6110698413103819, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 176.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 12399, "num_env_steps_trained": 12399, "num_agent_steps_sampled": 12399, "num_agent_steps_trained": 12399}, "sampler_results": {"episode_reward_max": 242.55197585078557, "episode_reward_min": 7.34428555444968, "episode_reward_mean": 56.084822425611875, "episode_len_mean": 75.34, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.623247168252233, 55.79402009355772, 24.68710443856606, 73.75111609588906, 14.823093239167566, 29.161025346066452, 14.148798998613158, 31.5257135383778, 22.582135042712846, 11.865612264061365, 47.376897442263605, 44.02115768896726, 29.845192378764665, 25.53823825783777, 29.229949779135875, 31.392230983487245, 90.84390996433284, 55.10100645198209, 68.47385434515601, 17.038508314009785, 35.186396964265526, 32.2236302560188, 17.93321391104786, 60.942452250761924, 40.14003798512716, 35.572194226822496, 79.20922932028176, 12.428679660129317, 63.535415591777195, 21.948919827165607, 67.37339264309807, 45.57559414098598, 44.63491891840039, 47.810394015805514, 70.24033912915809, 71.1836651752049, 65.41797823353686, 73.0278952500597, 49.4461291253068, 7.34428555444968, 21.71431052544613, 20.834731855590583, 27.203159082271522, 67.64645880541717, 68.7308949890648, 22.3980412459082, 21.75486637985066, 44.75185195445378, 23.091904409179822, 44.84965447851783, 26.94933207335088, 25.410529255484803, 10.986413768455188, 34.01388896823288, 14.915490429296344, 29.73741601231167, 25.605075981499457, 23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084, 68.09840103900034, 60.627427771582084, 28.462717086413278, 30.03296482983193, 59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563], "episode_lengths": [19, 74, 34, 102, 22, 40, 21, 44, 32, 18, 64, 60, 41, 36, 40, 44, 117, 73, 91, 25, 48, 45, 25, 79, 56, 49, 105, 18, 92, 31, 87, 64, 59, 66, 92, 94, 83, 102, 68, 12, 30, 29, 37, 87, 92, 32, 31, 63, 32, 60, 37, 35, 16, 46, 21, 41, 35, 33, 28, 28, 66, 94, 110, 88, 79, 40, 41, 82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41895664327161264, "mean_inference_ms": 1.2267402832972525, "mean_action_processing_ms": 0.1555316634130015, "mean_env_wait_ms": 3.433899457142078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069332122802734375, "StateBufferConnector_ms": 0.0055081844329833984, "ViewRequirementAgentConnector_ms": 0.1460106372833252}}, "episode_reward_max": 242.55197585078557, "episode_reward_min": 7.34428555444968, "episode_reward_mean": 56.084822425611875, "episode_len_mean": 75.34, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.623247168252233, 55.79402009355772, 24.68710443856606, 73.75111609588906, 14.823093239167566, 29.161025346066452, 14.148798998613158, 31.5257135383778, 22.582135042712846, 11.865612264061365, 47.376897442263605, 44.02115768896726, 29.845192378764665, 25.53823825783777, 29.229949779135875, 31.392230983487245, 90.84390996433284, 55.10100645198209, 68.47385434515601, 17.038508314009785, 35.186396964265526, 32.2236302560188, 17.93321391104786, 60.942452250761924, 40.14003798512716, 35.572194226822496, 79.20922932028176, 12.428679660129317, 63.535415591777195, 21.948919827165607, 67.37339264309807, 45.57559414098598, 44.63491891840039, 47.810394015805514, 70.24033912915809, 71.1836651752049, 65.41797823353686, 73.0278952500597, 49.4461291253068, 7.34428555444968, 21.71431052544613, 20.834731855590583, 27.203159082271522, 67.64645880541717, 68.7308949890648, 22.3980412459082, 21.75486637985066, 44.75185195445378, 23.091904409179822, 44.84965447851783, 26.94933207335088, 25.410529255484803, 10.986413768455188, 34.01388896823288, 14.915490429296344, 29.73741601231167, 25.605075981499457, 23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084, 68.09840103900034, 60.627427771582084, 28.462717086413278, 30.03296482983193, 59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563], "episode_lengths": [19, 74, 34, 102, 22, 40, 21, 44, 32, 18, 64, 60, 41, 36, 40, 44, 117, 73, 91, 25, 48, 45, 25, 79, 56, 49, 105, 18, 92, 31, 87, 64, 59, 66, 92, 94, 83, 102, 68, 12, 30, 29, 37, 87, 92, 32, 31, 63, 32, 60, 37, 35, 16, 46, 21, 41, 35, 33, 28, 28, 66, 94, 110, 88, 79, 40, 41, 82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41895664327161264, "mean_inference_ms": 1.2267402832972525, "mean_action_processing_ms": 0.1555316634130015, "mean_env_wait_ms": 3.433899457142078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069332122802734375, "StateBufferConnector_ms": 0.0055081844329833984, "ViewRequirementAgentConnector_ms": 0.1460106372833252}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12399, "num_agent_steps_trained": 12399, "num_env_steps_sampled": 12399, "num_env_steps_trained": 12399, "num_env_steps_sampled_this_iter": 2091, "num_env_steps_trained_this_iter": 2091, "num_env_steps_sampled_throughput_per_sec": 204.2693840817684, "num_env_steps_trained_throughput_per_sec": 204.2693840817684, "timesteps_total": 12399, "num_steps_trained_this_iter": 2091, "agent_timesteps_total": 12399, "timers": {"training_iteration_time_ms": 10671.458, "sample_time_ms": 10431.367, "load_time_ms": 0.433, "load_throughput": 4769804.209, "learn_time_ms": 239.191, "learn_throughput": 8639.527, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 12399, "num_env_steps_trained": 12399, "num_agent_steps_sampled": 12399, "num_agent_steps_trained": 12399}, "done": false, "episodes_total": 266, "training_iteration": 6, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-00-34", "timestamp": 1706270434, "time_this_iter_s": 10.237496852874756, "time_total_s": 64.0392382144928, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 64.0392382144928, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 77.97142857142858, "ram_util_percent": 16.350000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.295791067648679, "cur_kl_coeff": 0.0125, "cur_lr": 0.0003, "total_loss": 7.667628899216652, "policy_loss": -0.03900055351550691, "vf_loss": 9.640672445297241, "vf_explained_var": -0.019606245681643486, "kl": 0.005132127712684564, "entropy": 0.5972739271819592, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 208.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 14540, "num_env_steps_trained": 14540, "num_agent_steps_sampled": 14540, "num_agent_steps_trained": 14540}, "sampler_results": {"episode_reward_max": 242.55197585078557, "episode_reward_min": 7.34428555444968, "episode_reward_mean": 67.83541476097894, "episode_len_mean": 90.68, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.229949779135875, 31.392230983487245, 90.84390996433284, 55.10100645198209, 68.47385434515601, 17.038508314009785, 35.186396964265526, 32.2236302560188, 17.93321391104786, 60.942452250761924, 40.14003798512716, 35.572194226822496, 79.20922932028176, 12.428679660129317, 63.535415591777195, 21.948919827165607, 67.37339264309807, 45.57559414098598, 44.63491891840039, 47.810394015805514, 70.24033912915809, 71.1836651752049, 65.41797823353686, 73.0278952500597, 49.4461291253068, 7.34428555444968, 21.71431052544613, 20.834731855590583, 27.203159082271522, 67.64645880541717, 68.7308949890648, 22.3980412459082, 21.75486637985066, 44.75185195445378, 23.091904409179822, 44.84965447851783, 26.94933207335088, 25.410529255484803, 10.986413768455188, 34.01388896823288, 14.915490429296344, 29.73741601231167, 25.605075981499457, 23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084, 68.09840103900034, 60.627427771582084, 28.462717086413278, 30.03296482983193, 59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363], "episode_lengths": [40, 44, 117, 73, 91, 25, 48, 45, 25, 79, 56, 49, 105, 18, 92, 31, 87, 64, 59, 66, 92, 94, 83, 102, 68, 12, 30, 29, 37, 87, 92, 32, 31, 63, 32, 60, 37, 35, 16, 46, 21, 41, 35, 33, 28, 28, 66, 94, 110, 88, 79, 40, 41, 82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4126024946099427, "mean_inference_ms": 1.2167657126286457, "mean_action_processing_ms": 0.15349192395799058, "mean_env_wait_ms": 3.38704801195242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00691986083984375, "StateBufferConnector_ms": 0.0054073333740234375, "ViewRequirementAgentConnector_ms": 0.14371848106384277}}, "episode_reward_max": 242.55197585078557, "episode_reward_min": 7.34428555444968, "episode_reward_mean": 67.83541476097894, "episode_len_mean": 90.68, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.229949779135875, 31.392230983487245, 90.84390996433284, 55.10100645198209, 68.47385434515601, 17.038508314009785, 35.186396964265526, 32.2236302560188, 17.93321391104786, 60.942452250761924, 40.14003798512716, 35.572194226822496, 79.20922932028176, 12.428679660129317, 63.535415591777195, 21.948919827165607, 67.37339264309807, 45.57559414098598, 44.63491891840039, 47.810394015805514, 70.24033912915809, 71.1836651752049, 65.41797823353686, 73.0278952500597, 49.4461291253068, 7.34428555444968, 21.71431052544613, 20.834731855590583, 27.203159082271522, 67.64645880541717, 68.7308949890648, 22.3980412459082, 21.75486637985066, 44.75185195445378, 23.091904409179822, 44.84965447851783, 26.94933207335088, 25.410529255484803, 10.986413768455188, 34.01388896823288, 14.915490429296344, 29.73741601231167, 25.605075981499457, 23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084, 68.09840103900034, 60.627427771582084, 28.462717086413278, 30.03296482983193, 59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363], "episode_lengths": [40, 44, 117, 73, 91, 25, 48, 45, 25, 79, 56, 49, 105, 18, 92, 31, 87, 64, 59, 66, 92, 94, 83, 102, 68, 12, 30, 29, 37, 87, 92, 32, 31, 63, 32, 60, 37, 35, 16, 46, 21, 41, 35, 33, 28, 28, 66, 94, 110, 88, 79, 40, 41, 82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4126024946099427, "mean_inference_ms": 1.2167657126286457, "mean_action_processing_ms": 0.15349192395799058, "mean_env_wait_ms": 3.38704801195242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00691986083984375, "StateBufferConnector_ms": 0.0054073333740234375, "ViewRequirementAgentConnector_ms": 0.14371848106384277}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14540, "num_agent_steps_trained": 14540, "num_env_steps_sampled": 14540, "num_env_steps_trained": 14540, "num_env_steps_sampled_this_iter": 2141, "num_env_steps_trained_this_iter": 2141, "num_env_steps_sampled_throughput_per_sec": 205.26044905978995, "num_env_steps_trained_throughput_per_sec": 205.26044905978995, "timesteps_total": 14540, "num_steps_trained_this_iter": 2141, "agent_timesteps_total": 14540, "timers": {"training_iteration_time_ms": 10637.053, "sample_time_ms": 10402.04, "load_time_ms": 0.428, "load_throughput": 4849330.483, "learn_time_ms": 234.129, "learn_throughput": 8871.77, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 14540, "num_env_steps_trained": 14540, "num_agent_steps_sampled": 14540, "num_agent_steps_trained": 14540}, "done": false, "episodes_total": 280, "training_iteration": 7, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-00-44", "timestamp": 1706270444, "time_this_iter_s": 10.43171215057373, "time_total_s": 74.47095036506653, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 74.47095036506653, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 77.20666666666666, "ram_util_percent": 16.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2717131907120347, "cur_kl_coeff": 0.0125, "cur_lr": 0.0003, "total_loss": 7.709368541836739, "policy_loss": -0.04248744806682225, "vf_loss": 9.696986585855484, "vf_explained_var": -0.016377152875065804, "kl": 0.0024023708692311584, "entropy": 0.5763083640486002, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 16623, "num_env_steps_trained": 16623, "num_agent_steps_sampled": 16623, "num_agent_steps_trained": 16623}, "sampler_results": {"episode_reward_max": 242.55197585078557, "episode_reward_min": 7.34428555444968, "episode_reward_mean": 78.32181541786903, "episode_len_mean": 104.59, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.20922932028176, 12.428679660129317, 63.535415591777195, 21.948919827165607, 67.37339264309807, 45.57559414098598, 44.63491891840039, 47.810394015805514, 70.24033912915809, 71.1836651752049, 65.41797823353686, 73.0278952500597, 49.4461291253068, 7.34428555444968, 21.71431052544613, 20.834731855590583, 27.203159082271522, 67.64645880541717, 68.7308949890648, 22.3980412459082, 21.75486637985066, 44.75185195445378, 23.091904409179822, 44.84965447851783, 26.94933207335088, 25.410529255484803, 10.986413768455188, 34.01388896823288, 14.915490429296344, 29.73741601231167, 25.605075981499457, 23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084, 68.09840103900034, 60.627427771582084, 28.462717086413278, 30.03296482983193, 59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076], "episode_lengths": [105, 18, 92, 31, 87, 64, 59, 66, 92, 94, 83, 102, 68, 12, 30, 29, 37, 87, 92, 32, 31, 63, 32, 60, 37, 35, 16, 46, 21, 41, 35, 33, 28, 28, 66, 94, 110, 88, 79, 40, 41, 82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40649032352216713, "mean_inference_ms": 1.206998230121466, "mean_action_processing_ms": 0.1515365018968268, "mean_env_wait_ms": 3.3414308329621623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006989479064941406, "StateBufferConnector_ms": 0.005422353744506836, "ViewRequirementAgentConnector_ms": 0.1440424919128418}}, "episode_reward_max": 242.55197585078557, "episode_reward_min": 7.34428555444968, "episode_reward_mean": 78.32181541786903, "episode_len_mean": 104.59, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [79.20922932028176, 12.428679660129317, 63.535415591777195, 21.948919827165607, 67.37339264309807, 45.57559414098598, 44.63491891840039, 47.810394015805514, 70.24033912915809, 71.1836651752049, 65.41797823353686, 73.0278952500597, 49.4461291253068, 7.34428555444968, 21.71431052544613, 20.834731855590583, 27.203159082271522, 67.64645880541717, 68.7308949890648, 22.3980412459082, 21.75486637985066, 44.75185195445378, 23.091904409179822, 44.84965447851783, 26.94933207335088, 25.410529255484803, 10.986413768455188, 34.01388896823288, 14.915490429296344, 29.73741601231167, 25.605075981499457, 23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084, 68.09840103900034, 60.627427771582084, 28.462717086413278, 30.03296482983193, 59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076], "episode_lengths": [105, 18, 92, 31, 87, 64, 59, 66, 92, 94, 83, 102, 68, 12, 30, 29, 37, 87, 92, 32, 31, 63, 32, 60, 37, 35, 16, 46, 21, 41, 35, 33, 28, 28, 66, 94, 110, 88, 79, 40, 41, 82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40649032352216713, "mean_inference_ms": 1.206998230121466, "mean_action_processing_ms": 0.1515365018968268, "mean_env_wait_ms": 3.3414308329621623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006989479064941406, "StateBufferConnector_ms": 0.005422353744506836, "ViewRequirementAgentConnector_ms": 0.1440424919128418}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16623, "num_agent_steps_trained": 16623, "num_env_steps_sampled": 16623, "num_env_steps_trained": 16623, "num_env_steps_sampled_this_iter": 2083, "num_env_steps_trained_this_iter": 2083, "num_env_steps_sampled_throughput_per_sec": 215.74577073493404, "num_env_steps_trained_throughput_per_sec": 215.74577073493404, "timesteps_total": 16623, "num_steps_trained_this_iter": 2083, "agent_timesteps_total": 16623, "timers": {"training_iteration_time_ms": 10514.278, "sample_time_ms": 10273.432, "load_time_ms": 0.443, "load_throughput": 4690340.76, "learn_time_ms": 239.946, "learn_throughput": 8659.754, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 16623, "num_env_steps_trained": 16623, "num_agent_steps_sampled": 16623, "num_agent_steps_trained": 16623}, "done": false, "episodes_total": 292, "training_iteration": 8, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-00-54", "timestamp": 1706270454, "time_this_iter_s": 9.656351089477539, "time_total_s": 84.12730145454407, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 84.12730145454407, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 69.49285714285715, "ram_util_percent": 16.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.281012331135571, "cur_kl_coeff": 0.00625, "cur_lr": 0.0003, "total_loss": 7.71706847846508, "policy_loss": -0.04105576523579657, "vf_loss": 9.704769372940063, "vf_explained_var": 0.002470085397362709, "kl": 0.0014383147756979724, "entropy": 0.5700104720890522, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 272.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 18736, "num_env_steps_trained": 18736, "num_agent_steps_sampled": 18736, "num_agent_steps_trained": 18736}, "sampler_results": {"episode_reward_max": 242.55197585078557, "episode_reward_min": 7.34428555444968, "episode_reward_mean": 88.25987617883595, "episode_len_mean": 118.64, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.41797823353686, 73.0278952500597, 49.4461291253068, 7.34428555444968, 21.71431052544613, 20.834731855590583, 27.203159082271522, 67.64645880541717, 68.7308949890648, 22.3980412459082, 21.75486637985066, 44.75185195445378, 23.091904409179822, 44.84965447851783, 26.94933207335088, 25.410529255484803, 10.986413768455188, 34.01388896823288, 14.915490429296344, 29.73741601231167, 25.605075981499457, 23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084, 68.09840103900034, 60.627427771582084, 28.462717086413278, 30.03296482983193, 59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818], "episode_lengths": [83, 102, 68, 12, 30, 29, 37, 87, 92, 32, 31, 63, 32, 60, 37, 35, 16, 46, 21, 41, 35, 33, 28, 28, 66, 94, 110, 88, 79, 40, 41, 82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40245945191476024, "mean_inference_ms": 1.2009881693038154, "mean_action_processing_ms": 0.1503582209997977, "mean_env_wait_ms": 3.3130696265883364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007708311080932617, "StateBufferConnector_ms": 0.005456686019897461, "ViewRequirementAgentConnector_ms": 0.14406800270080566}}, "episode_reward_max": 242.55197585078557, "episode_reward_min": 7.34428555444968, "episode_reward_mean": 88.25987617883595, "episode_len_mean": 118.64, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.41797823353686, 73.0278952500597, 49.4461291253068, 7.34428555444968, 21.71431052544613, 20.834731855590583, 27.203159082271522, 67.64645880541717, 68.7308949890648, 22.3980412459082, 21.75486637985066, 44.75185195445378, 23.091904409179822, 44.84965447851783, 26.94933207335088, 25.410529255484803, 10.986413768455188, 34.01388896823288, 14.915490429296344, 29.73741601231167, 25.605075981499457, 23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084, 68.09840103900034, 60.627427771582084, 28.462717086413278, 30.03296482983193, 59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818], "episode_lengths": [83, 102, 68, 12, 30, 29, 37, 87, 92, 32, 31, 63, 32, 60, 37, 35, 16, 46, 21, 41, 35, 33, 28, 28, 66, 94, 110, 88, 79, 40, 41, 82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40245945191476024, "mean_inference_ms": 1.2009881693038154, "mean_action_processing_ms": 0.1503582209997977, "mean_env_wait_ms": 3.3130696265883364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007708311080932617, "StateBufferConnector_ms": 0.005456686019897461, "ViewRequirementAgentConnector_ms": 0.14406800270080566}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18736, "num_agent_steps_trained": 18736, "num_env_steps_sampled": 18736, "num_env_steps_trained": 18736, "num_env_steps_sampled_this_iter": 2113, "num_env_steps_trained_this_iter": 2113, "num_env_steps_sampled_throughput_per_sec": 216.0696625475941, "num_env_steps_trained_throughput_per_sec": 216.0696625475941, "timesteps_total": 18736, "num_steps_trained_this_iter": 2113, "agent_timesteps_total": 18736, "timers": {"training_iteration_time_ms": 10432.605, "sample_time_ms": 10196.029, "load_time_ms": 0.433, "load_throughput": 4808743.1, "learn_time_ms": 235.696, "learn_throughput": 8832.483, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 18736, "num_env_steps_trained": 18736, "num_agent_steps_sampled": 18736, "num_agent_steps_trained": 18736}, "done": false, "episodes_total": 302, "training_iteration": 9, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-01-04", "timestamp": 1706270464, "time_this_iter_s": 9.780212879180908, "time_total_s": 93.90751433372498, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 93.90751433372498, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 73.40714285714286, "ram_util_percent": 16.392857142857146}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1974006089149043, "cur_kl_coeff": 0.003125, "cur_lr": 0.0003, "total_loss": 7.758605554699898, "policy_loss": -0.023178039235062897, "vf_loss": 9.734327971935272, "vf_explained_var": -0.005539657548069954, "kl": 0.0034180726352864886, "entropy": 0.5689401477575302, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 304.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 20823, "num_env_steps_trained": 20823, "num_agent_steps_sampled": 20823, "num_agent_steps_trained": 20823}, "sampler_results": {"episode_reward_max": 246.78948612050417, "episode_reward_min": 10.986413768455188, "episode_reward_mean": 100.06447450169605, "episode_len_mean": 133.48, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.75185195445378, 23.091904409179822, 44.84965447851783, 26.94933207335088, 25.410529255484803, 10.986413768455188, 34.01388896823288, 14.915490429296344, 29.73741601231167, 25.605075981499457, 23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084, 68.09840103900034, 60.627427771582084, 28.462717086413278, 30.03296482983193, 59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622], "episode_lengths": [63, 32, 60, 37, 35, 16, 46, 21, 41, 35, 33, 28, 28, 66, 94, 110, 88, 79, 40, 41, 82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39806519979626515, "mean_inference_ms": 1.1956029740553702, "mean_action_processing_ms": 0.14937243013503662, "mean_env_wait_ms": 3.28582625837492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076830387115478516, "StateBufferConnector_ms": 0.005440950393676758, "ViewRequirementAgentConnector_ms": 0.1451258659362793}}, "episode_reward_max": 246.78948612050417, "episode_reward_min": 10.986413768455188, "episode_reward_mean": 100.06447450169605, "episode_len_mean": 133.48, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.75185195445378, 23.091904409179822, 44.84965447851783, 26.94933207335088, 25.410529255484803, 10.986413768455188, 34.01388896823288, 14.915490429296344, 29.73741601231167, 25.605075981499457, 23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084, 68.09840103900034, 60.627427771582084, 28.462717086413278, 30.03296482983193, 59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622], "episode_lengths": [63, 32, 60, 37, 35, 16, 46, 21, 41, 35, 33, 28, 28, 66, 94, 110, 88, 79, 40, 41, 82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39806519979626515, "mean_inference_ms": 1.1956029740553702, "mean_action_processing_ms": 0.14937243013503662, "mean_env_wait_ms": 3.28582625837492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076830387115478516, "StateBufferConnector_ms": 0.005440950393676758, "ViewRequirementAgentConnector_ms": 0.1451258659362793}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20823, "num_agent_steps_trained": 20823, "num_env_steps_sampled": 20823, "num_env_steps_trained": 20823, "num_env_steps_sampled_this_iter": 2087, "num_env_steps_trained_this_iter": 2087, "num_env_steps_sampled_throughput_per_sec": 181.9977796863821, "num_env_steps_trained_throughput_per_sec": 181.9977796863821, "timesteps_total": 20823, "num_steps_trained_this_iter": 2087, "agent_timesteps_total": 20823, "timers": {"training_iteration_time_ms": 10536.059, "sample_time_ms": 10302.665, "load_time_ms": 0.434, "load_throughput": 4803277.358, "learn_time_ms": 232.519, "learn_throughput": 8955.415, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 20823, "num_env_steps_trained": 20823, "num_agent_steps_sampled": 20823, "num_agent_steps_trained": 20823}, "done": false, "episodes_total": 313, "training_iteration": 10, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-01-15", "timestamp": 1706270475, "time_this_iter_s": 11.468201398849487, "time_total_s": 105.37571573257446, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 105.37571573257446, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 78.775, "ram_util_percent": 15.799999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18322948383865878, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0003, "total_loss": 7.735370725393295, "policy_loss": -0.06402924545182032, "vf_loss": 9.756286263465881, "vf_explained_var": -0.13957607001066208, "kl": 0.0026372415841582897, "entropy": 0.5633244514465332, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 336.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 22987, "num_env_steps_trained": 22987, "num_agent_steps_sampled": 22987, "num_agent_steps_trained": 22987}, "sampler_results": {"episode_reward_max": 246.78948612050417, "episode_reward_min": 16.418751800910172, "episode_reward_mean": 113.40956103128052, "episode_len_mean": 151.26, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084, 68.09840103900034, 60.627427771582084, 28.462717086413278, 30.03296482983193, 59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296], "episode_lengths": [33, 28, 28, 66, 94, 110, 88, 79, 40, 41, 82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3939965199795512, "mean_inference_ms": 1.190701721546282, "mean_action_processing_ms": 0.14844462299602434, "mean_env_wait_ms": 3.2605378795712228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007607698440551758, "StateBufferConnector_ms": 0.005393266677856445, "ViewRequirementAgentConnector_ms": 0.14026665687561035}}, "episode_reward_max": 246.78948612050417, "episode_reward_min": 16.418751800910172, "episode_reward_mean": 113.40956103128052, "episode_len_mean": 151.26, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.411969698768235, 20.203795805496153, 19.53839935010628, 47.872541334401284, 69.44059248275039, 84.74626667795084, 68.09840103900034, 60.627427771582084, 28.462717086413278, 30.03296482983193, 59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296], "episode_lengths": [33, 28, 28, 66, 94, 110, 88, 79, 40, 41, 82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3939965199795512, "mean_inference_ms": 1.190701721546282, "mean_action_processing_ms": 0.14844462299602434, "mean_env_wait_ms": 3.2605378795712228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007607698440551758, "StateBufferConnector_ms": 0.005393266677856445, "ViewRequirementAgentConnector_ms": 0.14026665687561035}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22987, "num_agent_steps_trained": 22987, "num_env_steps_sampled": 22987, "num_env_steps_trained": 22987, "num_env_steps_sampled_this_iter": 2164, "num_env_steps_trained_this_iter": 2164, "num_env_steps_sampled_throughput_per_sec": 201.0802437986178, "num_env_steps_trained_throughput_per_sec": 201.0802437986178, "timesteps_total": 22987, "num_steps_trained_this_iter": 2164, "agent_timesteps_total": 22987, "timers": {"training_iteration_time_ms": 10182.928, "sample_time_ms": 9958.543, "load_time_ms": 0.423, "load_throughput": 4943421.809, "learn_time_ms": 223.553, "learn_throughput": 9363.316, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 22987, "num_env_steps_trained": 22987, "num_agent_steps_sampled": 22987, "num_agent_steps_trained": 22987}, "done": false, "episodes_total": 323, "training_iteration": 11, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-01-26", "timestamp": 1706270486, "time_this_iter_s": 10.762853622436523, "time_total_s": 116.13856935501099, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 116.13856935501099, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 76.64375000000001, "ram_util_percent": 15.643749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17457472695969045, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0003, "total_loss": 7.770119309425354, "policy_loss": -0.04570454324129969, "vf_loss": 9.776781499385834, "vf_explained_var": 0.02488883025944233, "kl": 0.001668116443869369, "entropy": 0.5602596551179886, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 368.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 25203, "num_env_steps_trained": 25203, "num_agent_steps_sampled": 25203, "num_agent_steps_trained": 25203}, "sampler_results": {"episode_reward_max": 246.78948612050417, "episode_reward_min": 16.418751800910172, "episode_reward_mean": 125.5734331439666, "episode_len_mean": 167.35, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967], "episode_lengths": [82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3903371452238279, "mean_inference_ms": 1.1864495856657837, "mean_action_processing_ms": 0.14763478597793664, "mean_env_wait_ms": 3.238617749793058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007811069488525391, "StateBufferConnector_ms": 0.005388736724853516, "ViewRequirementAgentConnector_ms": 0.1390058994293213}}, "episode_reward_max": 246.78948612050417, "episode_reward_min": 16.418751800910172, "episode_reward_mean": 125.5734331439666, "episode_len_mean": 167.35, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.4151921134148, 175.97355063038322, 53.39297175586644, 18.769884458575945, 42.595967722245675, 29.770510337490254, 122.28096079864353, 30.47255694388169, 154.04317691669095, 34.58908837695452, 49.92773828275749, 63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967], "episode_lengths": [82, 226, 71, 27, 59, 41, 156, 41, 205, 47, 68, 88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3903371452238279, "mean_inference_ms": 1.1864495856657837, "mean_action_processing_ms": 0.14763478597793664, "mean_env_wait_ms": 3.238617749793058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007811069488525391, "StateBufferConnector_ms": 0.005388736724853516, "ViewRequirementAgentConnector_ms": 0.1390058994293213}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25203, "num_agent_steps_trained": 25203, "num_env_steps_sampled": 25203, "num_env_steps_trained": 25203, "num_env_steps_sampled_this_iter": 2216, "num_env_steps_trained_this_iter": 2216, "num_env_steps_sampled_throughput_per_sec": 213.3199705804738, "num_env_steps_trained_throughput_per_sec": 213.3199705804738, "timesteps_total": 25203, "num_steps_trained_this_iter": 2216, "agent_timesteps_total": 25203, "timers": {"training_iteration_time_ms": 10223.012, "sample_time_ms": 9986.975, "load_time_ms": 0.447, "load_throughput": 4718619.961, "learn_time_ms": 235.166, "learn_throughput": 8970.273, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 25203, "num_env_steps_trained": 25203, "num_agent_steps_sampled": 25203, "num_agent_steps_trained": 25203}, "done": false, "episodes_total": 333, "training_iteration": 12, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-01-37", "timestamp": 1706270497, "time_this_iter_s": 10.389716148376465, "time_total_s": 126.52828550338745, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 126.52828550338745, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 72.51333333333334, "ram_util_percent": 15.686666666666662}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.20246799068991095, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0003, "total_loss": 7.768709242343903, "policy_loss": -0.06448023807024583, "vf_loss": 9.798411071300507, "vf_explained_var": 0.07217433862388134, "kl": 0.0024935867805076506, "entropy": 0.5540379956364632, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 400.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 27356, "num_env_steps_trained": 27356, "num_agent_steps_sampled": 27356, "num_agent_steps_trained": 27356}, "sampler_results": {"episode_reward_max": 247.4403161229089, "episode_reward_min": 16.418751800910172, "episode_reward_mean": 134.49126586628014, "episode_len_mean": 178.65, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406], "episode_lengths": [88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3877976972139466, "mean_inference_ms": 1.185623278136044, "mean_action_processing_ms": 0.1473237671230635, "mean_env_wait_ms": 3.2285499904375765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007932662963867188, "StateBufferConnector_ms": 0.005478620529174805, "ViewRequirementAgentConnector_ms": 0.1410844326019287}}, "episode_reward_max": 247.4403161229089, "episode_reward_min": 16.418751800910172, "episode_reward_mean": 134.49126586628014, "episode_len_mean": 178.65, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [63.65649553224503, 102.27695394025254, 58.15833732682671, 160.9284118467908, 18.683862607755742, 42.5527446753953, 87.31143065841897, 67.01983807575272, 107.21787208411655, 78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406], "episode_lengths": [88, 132, 79, 209, 26, 59, 129, 95, 137, 109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3877976972139466, "mean_inference_ms": 1.185623278136044, "mean_action_processing_ms": 0.1473237671230635, "mean_env_wait_ms": 3.2285499904375765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007932662963867188, "StateBufferConnector_ms": 0.005478620529174805, "ViewRequirementAgentConnector_ms": 0.1410844326019287}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27356, "num_agent_steps_trained": 27356, "num_env_steps_sampled": 27356, "num_env_steps_trained": 27356, "num_env_steps_sampled_this_iter": 2153, "num_env_steps_trained_this_iter": 2153, "num_env_steps_sampled_throughput_per_sec": 170.9323425406467, "num_env_steps_trained_throughput_per_sec": 170.9323425406467, "timesteps_total": 27356, "num_steps_trained_this_iter": 2153, "agent_timesteps_total": 27356, "timers": {"training_iteration_time_ms": 10463.816, "sample_time_ms": 10214.108, "load_time_ms": 0.478, "load_throughput": 4434971.079, "learn_time_ms": 248.787, "learn_throughput": 8518.117, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 27356, "num_env_steps_trained": 27356, "num_agent_steps_sampled": 27356, "num_agent_steps_trained": 27356}, "done": false, "episodes_total": 344, "training_iteration": 13, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-01-49", "timestamp": 1706270509, "time_this_iter_s": 12.598987102508545, "time_total_s": 139.127272605896, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 139.127272605896, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 85.98888888888888, "ram_util_percent": 15.844444444444447}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1594762650784105, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0003, "total_loss": 7.815182566642761, "policy_loss": -0.04237833194201812, "vf_loss": 9.828882396221161, "vf_explained_var": 0.015351496636867523, "kl": 0.0018559730828897614, "entropy": 0.5545189063996077, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 432.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 29525, "num_env_steps_trained": 29525, "num_agent_steps_sampled": 29525, "num_agent_steps_trained": 29525}, "sampler_results": {"episode_reward_max": 247.4403161229089, "episode_reward_min": 16.418751800910172, "episode_reward_mean": 144.29735220618863, "episode_len_mean": 190.8, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475], "episode_lengths": [109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38559856360750144, "mean_inference_ms": 1.1848660123319312, "mean_action_processing_ms": 0.1470407657123054, "mean_env_wait_ms": 3.2196893523515633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008064985275268555, "StateBufferConnector_ms": 0.005507230758666992, "ViewRequirementAgentConnector_ms": 0.14171600341796875}}, "episode_reward_max": 247.4403161229089, "episode_reward_min": 16.418751800910172, "episode_reward_mean": 144.29735220618863, "episode_len_mean": 190.8, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [78.49571698429891, 119.6553001367059, 120.02457096394375, 242.55197585078557, 57.89775330518269, 154.80482179005782, 70.70999099957754, 61.74973781059243, 94.02202105108945, 238.9623858022145, 80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475], "episode_lengths": [109, 161, 178, 301, 80, 219, 90, 90, 128, 301, 101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38559856360750144, "mean_inference_ms": 1.1848660123319312, "mean_action_processing_ms": 0.1470407657123054, "mean_env_wait_ms": 3.2196893523515633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008064985275268555, "StateBufferConnector_ms": 0.005507230758666992, "ViewRequirementAgentConnector_ms": 0.14171600341796875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29525, "num_agent_steps_trained": 29525, "num_env_steps_sampled": 29525, "num_env_steps_trained": 29525, "num_env_steps_sampled_this_iter": 2169, "num_env_steps_trained_this_iter": 2169, "num_env_steps_sampled_throughput_per_sec": 205.84000798974003, "num_env_steps_trained_throughput_per_sec": 205.84000798974003, "timesteps_total": 29525, "num_steps_trained_this_iter": 2169, "agent_timesteps_total": 29525, "timers": {"training_iteration_time_ms": 10507.014, "sample_time_ms": 10268.65, "load_time_ms": 0.456, "load_throughput": 4676556.768, "learn_time_ms": 237.485, "learn_throughput": 8971.086, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 29525, "num_env_steps_trained": 29525, "num_agent_steps_sampled": 29525, "num_agent_steps_trained": 29525}, "done": false, "episodes_total": 353, "training_iteration": 14, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-02-00", "timestamp": 1706270520, "time_this_iter_s": 10.538261413574219, "time_total_s": 149.66553401947021, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 149.66553401947021, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 75.04666666666667, "ram_util_percent": 16.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17222623946145177, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0003, "total_loss": 7.791360855102539, "policy_loss": -0.02062873775139451, "vf_loss": 9.772089838981628, "vf_explained_var": 0.029645416885614395, "kl": 0.0023041794048028422, "entropy": 0.5682434663176537, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 464.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 31615, "num_env_steps_trained": 31615, "num_agent_steps_sampled": 31615, "num_agent_steps_trained": 31615}, "sampler_results": {"episode_reward_max": 247.4403161229089, "episode_reward_min": 16.418751800910172, "episode_reward_mean": 148.141132016023, "episode_len_mean": 195.13, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753], "episode_lengths": [101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38404570145301037, "mean_inference_ms": 1.1851221753731667, "mean_action_processing_ms": 0.14692928397287128, "mean_env_wait_ms": 3.21567884222822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007973432540893555, "StateBufferConnector_ms": 0.005463123321533203, "ViewRequirementAgentConnector_ms": 0.14226460456848145}}, "episode_reward_max": 247.4403161229089, "episode_reward_min": 16.418751800910172, "episode_reward_mean": 148.141132016023, "episode_len_mean": 195.13, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [80.0259005183368, 16.418751800910172, 140.09910016179563, 51.748596610576946, 215.07568157111106, 55.77484209667145, 105.51680560507657, 152.36780949449718, 188.24499783201256, 137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753], "episode_lengths": [101, 24, 172, 70, 301, 81, 136, 186, 243, 170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38404570145301037, "mean_inference_ms": 1.1851221753731667, "mean_action_processing_ms": 0.14692928397287128, "mean_env_wait_ms": 3.21567884222822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007973432540893555, "StateBufferConnector_ms": 0.005463123321533203, "ViewRequirementAgentConnector_ms": 0.14226460456848145}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31615, "num_agent_steps_trained": 31615, "num_env_steps_sampled": 31615, "num_env_steps_trained": 31615, "num_env_steps_sampled_this_iter": 2090, "num_env_steps_trained_this_iter": 2090, "num_env_steps_sampled_throughput_per_sec": 178.5113007766827, "num_env_steps_trained_throughput_per_sec": 178.5113007766827, "timesteps_total": 31615, "num_steps_trained_this_iter": 2090, "agent_timesteps_total": 31615, "timers": {"training_iteration_time_ms": 10755.904, "sample_time_ms": 10520.538, "load_time_ms": 0.452, "load_throughput": 4714498.593, "learn_time_ms": 234.496, "learn_throughput": 9086.312, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 31615, "num_env_steps_trained": 31615, "num_agent_steps_sampled": 31615, "num_agent_steps_trained": 31615}, "done": false, "episodes_total": 363, "training_iteration": 15, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-02-12", "timestamp": 1706270532, "time_this_iter_s": 11.708996534347534, "time_total_s": 161.37453055381775, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 161.37453055381775, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 85.65294117647058, "ram_util_percent": 16.294117647058822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.22943444130942225, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0003, "total_loss": 7.841722324490547, "policy_loss": 0.011268077534623444, "vf_loss": 9.7949338555336, "vf_explained_var": 0.09782264567911625, "kl": 0.0017392654642338634, "entropy": 0.5492934100329876, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 496.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 33783, "num_env_steps_trained": 33783, "num_agent_steps_sampled": 33783, "num_agent_steps_trained": 33783}, "sampler_results": {"episode_reward_max": 247.4403161229089, "episode_reward_min": 52.771455381972174, "episode_reward_mean": 155.21544742838162, "episode_len_mean": 203.67, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216], "episode_lengths": [170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38280199512781155, "mean_inference_ms": 1.1855369908603612, "mean_action_processing_ms": 0.1468589180508654, "mean_env_wait_ms": 3.213051318964546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008042097091674805, "StateBufferConnector_ms": 0.005557060241699219, "ViewRequirementAgentConnector_ms": 0.14349985122680664}}, "episode_reward_max": 247.4403161229089, "episode_reward_min": 52.771455381972174, "episode_reward_mean": 155.21544742838162, "episode_len_mean": 203.67, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [137.98239923580164, 70.72172143052408, 112.75235662027971, 136.36474848156834, 95.5027234984219, 69.3226318477926, 113.17862445722577, 108.24864674824363, 63.29743701587252, 114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216], "episode_lengths": [170, 97, 163, 179, 118, 90, 152, 155, 83, 148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38280199512781155, "mean_inference_ms": 1.1855369908603612, "mean_action_processing_ms": 0.1468589180508654, "mean_env_wait_ms": 3.213051318964546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008042097091674805, "StateBufferConnector_ms": 0.005557060241699219, "ViewRequirementAgentConnector_ms": 0.14349985122680664}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33783, "num_agent_steps_trained": 33783, "num_env_steps_sampled": 33783, "num_env_steps_trained": 33783, "num_env_steps_sampled_this_iter": 2168, "num_env_steps_trained_this_iter": 2168, "num_env_steps_sampled_throughput_per_sec": 203.55406535917515, "num_env_steps_trained_throughput_per_sec": 203.55406535917515, "timesteps_total": 33783, "num_steps_trained_this_iter": 2168, "agent_timesteps_total": 33783, "timers": {"training_iteration_time_ms": 10797.329, "sample_time_ms": 10560.752, "load_time_ms": 0.453, "load_throughput": 4719833.539, "learn_time_ms": 235.704, "learn_throughput": 9072.381, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 33783, "num_env_steps_trained": 33783, "num_agent_steps_sampled": 33783, "num_agent_steps_trained": 33783}, "done": false, "episodes_total": 372, "training_iteration": 16, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-02-22", "timestamp": 1706270542, "time_this_iter_s": 10.651759386062622, "time_total_s": 172.02628993988037, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 172.02628993988037, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 77.91333333333334, "ram_util_percent": 16.293333333333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.14616276929154992, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0003, "total_loss": 7.824058473110199, "policy_loss": -0.004458332899957895, "vf_loss": 9.79267930984497, "vf_explained_var": 0.024857329204678535, "kl": 0.0016278451425823515, "entropy": 0.5626600217074156, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 528.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 35926, "num_env_steps_trained": 35926, "num_agent_steps_sampled": 35926, "num_agent_steps_trained": 35926}, "sampler_results": {"episode_reward_max": 247.4403161229089, "episode_reward_min": 52.771455381972174, "episode_reward_mean": 163.15201962721198, "episode_len_mean": 213.03, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813], "episode_lengths": [148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3815295859483516, "mean_inference_ms": 1.1855607926094902, "mean_action_processing_ms": 0.14675032743047922, "mean_env_wait_ms": 3.2092658227816377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007928609848022461, "StateBufferConnector_ms": 0.00552058219909668, "ViewRequirementAgentConnector_ms": 0.1427152156829834}}, "episode_reward_max": 247.4403161229089, "episode_reward_min": 52.771455381972174, "episode_reward_mean": 163.15201962721198, "episode_len_mean": 213.03, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [114.30770246975793, 168.14436087567933, 225.71753578649955, 60.033681338829524, 207.48185439737878, 215.04876318473953, 83.42650019312325, 139.13905927267112, 52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813], "episode_lengths": [148, 204, 301, 86, 261, 301, 126, 179, 68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3815295859483516, "mean_inference_ms": 1.1855607926094902, "mean_action_processing_ms": 0.14675032743047922, "mean_env_wait_ms": 3.2092658227816377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007928609848022461, "StateBufferConnector_ms": 0.00552058219909668, "ViewRequirementAgentConnector_ms": 0.1427152156829834}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35926, "num_agent_steps_trained": 35926, "num_env_steps_sampled": 35926, "num_env_steps_trained": 35926, "num_env_steps_sampled_this_iter": 2143, "num_env_steps_trained_this_iter": 2143, "num_env_steps_sampled_throughput_per_sec": 223.81779419490167, "num_env_steps_trained_throughput_per_sec": 223.81779419490167, "timesteps_total": 35926, "num_steps_trained_this_iter": 2143, "agent_timesteps_total": 35926, "timers": {"training_iteration_time_ms": 10711.739, "sample_time_ms": 10467.952, "load_time_ms": 0.473, "load_throughput": 4523646.444, "learn_time_ms": 242.887, "learn_throughput": 8804.932, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 35926, "num_env_steps_trained": 35926, "num_agent_steps_sampled": 35926, "num_agent_steps_trained": 35926}, "done": false, "episodes_total": 381, "training_iteration": 17, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-02-32", "timestamp": 1706270552, "time_this_iter_s": 9.576302528381348, "time_total_s": 181.60259246826172, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 181.60259246826172, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 67.67857142857142, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16921419801656157, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0003, "total_loss": 7.823537141084671, "policy_loss": -0.012189013184979558, "vf_loss": 9.801639467477798, "vf_explained_var": -0.005194082856178284, "kl": 0.000880975123405417, "entropy": 0.5585462991148233, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 560.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 37979, "num_env_steps_trained": 37979, "num_agent_steps_sampled": 37979, "num_agent_steps_trained": 37979}, "sampler_results": {"episode_reward_max": 254.91247887919295, "episode_reward_min": 52.771455381972174, "episode_reward_mean": 167.19935641663142, "episode_len_mean": 217.5, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255], "episode_lengths": [68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3806760811670309, "mean_inference_ms": 1.1861167467942553, "mean_action_processing_ms": 0.14674033044613882, "mean_env_wait_ms": 3.208424567985195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007953643798828125, "StateBufferConnector_ms": 0.0055789947509765625, "ViewRequirementAgentConnector_ms": 0.1435863971710205}}, "episode_reward_max": 254.91247887919295, "episode_reward_min": 52.771455381972174, "episode_reward_mean": 167.19935641663142, "episode_len_mean": 217.5, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.771455381972174, 107.64800482002403, 125.70109638461076, 120.87122825929458, 194.33268316578807, 151.00518896947443, 182.3328936703372, 199.74230123057555, 174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255], "episode_lengths": [68, 148, 178, 186, 281, 230, 216, 249, 262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3806760811670309, "mean_inference_ms": 1.1861167467942553, "mean_action_processing_ms": 0.14674033044613882, "mean_env_wait_ms": 3.208424567985195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007953643798828125, "StateBufferConnector_ms": 0.0055789947509765625, "ViewRequirementAgentConnector_ms": 0.1435863971710205}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37979, "num_agent_steps_trained": 37979, "num_env_steps_sampled": 37979, "num_env_steps_trained": 37979, "num_env_steps_sampled_this_iter": 2053, "num_env_steps_trained_this_iter": 2053, "num_env_steps_sampled_throughput_per_sec": 208.71090710709714, "num_env_steps_trained_throughput_per_sec": 208.71090710709714, "timesteps_total": 37979, "num_steps_trained_this_iter": 2053, "agent_timesteps_total": 37979, "timers": {"training_iteration_time_ms": 10729.907, "sample_time_ms": 10494.4, "load_time_ms": 0.458, "load_throughput": 4667477.267, "learn_time_ms": 234.621, "learn_throughput": 9102.346, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 37979, "num_env_steps_trained": 37979, "num_agent_steps_sampled": 37979, "num_agent_steps_trained": 37979}, "done": false, "episodes_total": 389, "training_iteration": 18, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-02-42", "timestamp": 1706270562, "time_this_iter_s": 9.838133573532104, "time_total_s": 191.44072604179382, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 191.44072604179382, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 75.77142857142857, "ram_util_percent": 16.38571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1903874147683382, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0003, "total_loss": 7.8014930337667465, "policy_loss": -0.012754073599353433, "vf_loss": 9.774839222431183, "vf_explained_var": 0.02144593559205532, "kl": 0.003780268456462288, "entropy": 0.5624270737171173, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 592.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 40031, "num_env_steps_trained": 40031, "num_agent_steps_sampled": 40031, "num_agent_steps_trained": 40031}, "sampler_results": {"episode_reward_max": 254.91247887919295, "episode_reward_min": 91.47115286138586, "episode_reward_mean": 171.35700694151407, "episode_len_mean": 222.46, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787], "episode_lengths": [262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38002643564760247, "mean_inference_ms": 1.1870204009819134, "mean_action_processing_ms": 0.14679975771245768, "mean_env_wait_ms": 3.20912541653647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007250785827636719, "StateBufferConnector_ms": 0.005517244338989258, "ViewRequirementAgentConnector_ms": 0.1445784568786621}}, "episode_reward_max": 254.91247887919295, "episode_reward_min": 91.47115286138586, "episode_reward_mean": 171.35700694151407, "episode_len_mean": 222.46, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [174.62789461807282, 99.79221265453295, 141.83129500696995, 144.52272246377262, 108.68820447987818, 246.78948612050417, 97.01976766501382, 137.58170310802944, 126.3634760722073, 115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787], "episode_lengths": [262, 123, 185, 223, 158, 301, 120, 170, 152, 172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38002643564760247, "mean_inference_ms": 1.1870204009819134, "mean_action_processing_ms": 0.14679975771245768, "mean_env_wait_ms": 3.20912541653647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007250785827636719, "StateBufferConnector_ms": 0.005517244338989258, "ViewRequirementAgentConnector_ms": 0.1445784568786621}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40031, "num_agent_steps_trained": 40031, "num_env_steps_sampled": 40031, "num_env_steps_trained": 40031, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 200.16531943787083, "num_env_steps_trained_throughput_per_sec": 200.16531943787083, "timesteps_total": 40031, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 40031, "timers": {"training_iteration_time_ms": 10777.134, "sample_time_ms": 10540.987, "load_time_ms": 0.46, "load_throughput": 4630739.511, "learn_time_ms": 235.257, "learn_throughput": 9051.812, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 40031, "num_env_steps_trained": 40031, "num_agent_steps_sampled": 40031, "num_agent_steps_trained": 40031}, "done": false, "episodes_total": 397, "training_iteration": 19, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-02-52", "timestamp": 1706270572, "time_this_iter_s": 10.252541303634644, "time_total_s": 201.69326734542847, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 201.69326734542847, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 78.50714285714285, "ram_util_percent": 16.400000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.20698375720530748, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0003, "total_loss": 7.76830318570137, "policy_loss": -0.05186069069895893, "vf_loss": 9.782323598861694, "vf_explained_var": -0.0007141940295696259, "kl": 0.0023778164145551745, "entropy": 0.5695047043263912, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 624.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 42124, "num_env_steps_trained": 42124, "num_agent_steps_sampled": 42124, "num_agent_steps_trained": 42124}, "sampler_results": {"episode_reward_max": 254.91247887919295, "episode_reward_min": 77.83489192720299, "episode_reward_mean": 174.75196805716902, "episode_len_mean": 226.45, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637], "episode_lengths": [172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794621389093986, "mean_inference_ms": 1.188610786139133, "mean_action_processing_ms": 0.14680583625006696, "mean_env_wait_ms": 3.2104639593538833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007283449172973633, "StateBufferConnector_ms": 0.0055158138275146484, "ViewRequirementAgentConnector_ms": 0.1447901725769043}}, "episode_reward_max": 254.91247887919295, "episode_reward_min": 77.83489192720299, "episode_reward_mean": 174.75196805716902, "episode_len_mean": 226.45, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [115.5975946620892, 156.1781038976667, 132.65335535658843, 220.26018120449075, 160.6436409649332, 138.08368800526287, 94.80758627612622, 240.42476559624737, 121.52191603240162, 105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637], "episode_lengths": [172, 197, 168, 301, 194, 198, 114, 281, 181, 128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794621389093986, "mean_inference_ms": 1.188610786139133, "mean_action_processing_ms": 0.14680583625006696, "mean_env_wait_ms": 3.2104639593538833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007283449172973633, "StateBufferConnector_ms": 0.0055158138275146484, "ViewRequirementAgentConnector_ms": 0.1447901725769043}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42124, "num_agent_steps_trained": 42124, "num_env_steps_sampled": 42124, "num_env_steps_trained": 42124, "num_env_steps_sampled_this_iter": 2093, "num_env_steps_trained_this_iter": 2093, "num_env_steps_sampled_throughput_per_sec": 185.22807893887577, "num_env_steps_trained_throughput_per_sec": 185.22807893887577, "timesteps_total": 42124, "num_steps_trained_this_iter": 2093, "agent_timesteps_total": 42124, "timers": {"training_iteration_time_ms": 10760.375, "sample_time_ms": 10524.744, "load_time_ms": 0.45, "load_throughput": 4735404.119, "learn_time_ms": 234.753, "learn_throughput": 9073.775, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 42124, "num_env_steps_trained": 42124, "num_agent_steps_sampled": 42124, "num_agent_steps_trained": 42124}, "done": false, "episodes_total": 406, "training_iteration": 20, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-03-03", "timestamp": 1706270583, "time_this_iter_s": 11.300545930862427, "time_total_s": 212.9938132762909, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 212.9938132762909, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 78.79411764705881, "ram_util_percent": 16.15294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.28307246044278145, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0003, "total_loss": 7.744183614850044, "policy_loss": -0.0411352229421027, "vf_loss": 9.738919764757156, "vf_explained_var": 0.005216183140873909, "kl": 0.002594093791623564, "entropy": 0.5817122980952263, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 656.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 44458, "num_env_steps_trained": 44458, "num_agent_steps_sampled": 44458, "num_agent_steps_trained": 44458}, "sampler_results": {"episode_reward_max": 254.91247887919295, "episode_reward_min": 77.83489192720299, "episode_reward_mean": 178.33108484201125, "episode_len_mean": 231.73, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538], "episode_lengths": [128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37871482632542425, "mean_inference_ms": 1.1891086477389596, "mean_action_processing_ms": 0.14660557211844746, "mean_env_wait_ms": 3.208229617143994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072917938232421875, "StateBufferConnector_ms": 0.0055425167083740234, "ViewRequirementAgentConnector_ms": 0.14475536346435547}}, "episode_reward_max": 254.91247887919295, "episode_reward_min": 77.83489192720299, "episode_reward_mean": 178.33108484201125, "episode_len_mean": 231.73, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [105.0482954042277, 149.70236104441602, 216.76974158517666, 126.12659442570418, 127.00896642392175, 216.38224884517558, 138.52925912997605, 173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538], "episode_lengths": [128, 182, 301, 156, 153, 301, 219, 262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37871482632542425, "mean_inference_ms": 1.1891086477389596, "mean_action_processing_ms": 0.14660557211844746, "mean_env_wait_ms": 3.208229617143994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072917938232421875, "StateBufferConnector_ms": 0.0055425167083740234, "ViewRequirementAgentConnector_ms": 0.14475536346435547}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44458, "num_agent_steps_trained": 44458, "num_env_steps_sampled": 44458, "num_env_steps_trained": 44458, "num_env_steps_sampled_this_iter": 2334, "num_env_steps_trained_this_iter": 2334, "num_env_steps_sampled_throughput_per_sec": 222.15026576323115, "num_env_steps_trained_throughput_per_sec": 222.15026576323115, "timesteps_total": 44458, "num_steps_trained_this_iter": 2334, "agent_timesteps_total": 44458, "timers": {"training_iteration_time_ms": 10734.826, "sample_time_ms": 10490.984, "load_time_ms": 0.469, "load_throughput": 4574384.171, "learn_time_ms": 242.928, "learn_throughput": 8838.431, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 44458, "num_env_steps_trained": 44458, "num_agent_steps_sampled": 44458, "num_agent_steps_trained": 44458}, "done": false, "episodes_total": 415, "training_iteration": 21, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-03-14", "timestamp": 1706270594, "time_this_iter_s": 10.508510112762451, "time_total_s": 223.50232338905334, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 223.50232338905334, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 69.21333333333334, "ram_util_percent": 16.026666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16201545111835003, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0003, "total_loss": 7.828029215335846, "policy_loss": -0.025392739567905664, "vf_loss": 9.82382270693779, "vf_explained_var": 0.012881740927696228, "kl": 0.0020838279893675704, "entropy": 0.5636309124529362, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 688.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 46520, "num_env_steps_trained": 46520, "num_agent_steps_sampled": 46520, "num_agent_steps_trained": 46520}, "sampler_results": {"episode_reward_max": 256.0091598290631, "episode_reward_min": 77.83489192720299, "episode_reward_mean": 183.52160593763983, "episode_len_mean": 237.95, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631], "episode_lengths": [262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780887014727143, "mean_inference_ms": 1.189359379438594, "mean_action_processing_ms": 0.146460570687464, "mean_env_wait_ms": 3.206160837504206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073168277740478516, "StateBufferConnector_ms": 0.005523681640625, "ViewRequirementAgentConnector_ms": 0.14428091049194336}}, "episode_reward_max": 256.0091598290631, "episode_reward_min": 77.83489192720299, "episode_reward_mean": 183.52160593763983, "episode_len_mean": 237.95, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [173.30606180198296, 115.58007505146904, 103.15268878635985, 105.35647949298183, 239.20115344944784, 158.06359144606625, 219.64668443543263, 173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631], "episode_lengths": [262, 141, 125, 128, 301, 197, 301, 260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780887014727143, "mean_inference_ms": 1.189359379438594, "mean_action_processing_ms": 0.146460570687464, "mean_env_wait_ms": 3.206160837504206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073168277740478516, "StateBufferConnector_ms": 0.005523681640625, "ViewRequirementAgentConnector_ms": 0.14428091049194336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46520, "num_agent_steps_trained": 46520, "num_env_steps_sampled": 46520, "num_env_steps_trained": 46520, "num_env_steps_sampled_this_iter": 2062, "num_env_steps_trained_this_iter": 2062, "num_env_steps_sampled_throughput_per_sec": 211.30092531705748, "num_env_steps_trained_throughput_per_sec": 211.30092531705748, "timesteps_total": 46520, "num_steps_trained_this_iter": 2062, "agent_timesteps_total": 46520, "timers": {"training_iteration_time_ms": 10671.87, "sample_time_ms": 10439.713, "load_time_ms": 0.441, "load_throughput": 4833755.656, "learn_time_ms": 231.286, "learn_throughput": 9216.721, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 46520, "num_env_steps_trained": 46520, "num_agent_steps_sampled": 46520, "num_agent_steps_trained": 46520}, "done": false, "episodes_total": 422, "training_iteration": 22, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-03-24", "timestamp": 1706270604, "time_this_iter_s": 9.759574890136719, "time_total_s": 233.26189827919006, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 233.26189827919006, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 73.90714285714286, "ram_util_percent": 16.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17116707481909543, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0003, "total_loss": 7.832599475979805, "policy_loss": -0.004309528972953558, "vf_loss": 9.803223818540573, "vf_explained_var": -0.008483562618494034, "kl": 0.002500849865935406, "entropy": 0.5670027583837509, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 720.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 48569, "num_env_steps_trained": 48569, "num_agent_steps_sampled": 48569, "num_agent_steps_trained": 48569}, "sampler_results": {"episode_reward_max": 262.9086397447676, "episode_reward_min": 77.83489192720299, "episode_reward_mean": 188.50543426042003, "episode_len_mean": 243.89, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165], "episode_lengths": [260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37764523097482383, "mean_inference_ms": 1.1899656817206172, "mean_action_processing_ms": 0.14637571770920638, "mean_env_wait_ms": 3.2055199266150924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070037841796875, "StateBufferConnector_ms": 0.005565643310546875, "ViewRequirementAgentConnector_ms": 0.14562392234802246}}, "episode_reward_max": 262.9086397447676, "episode_reward_min": 77.83489192720299, "episode_reward_mean": 188.50543426042003, "episode_len_mean": 243.89, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [173.52268137434345, 232.8411477209345, 145.25941243408698, 176.19837315378967, 165.99700711099155, 203.28519563176752, 140.61058330935955, 220.10652178783084, 110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165], "episode_lengths": [260, 301, 213, 249, 204, 295, 171, 301, 136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37764523097482383, "mean_inference_ms": 1.1899656817206172, "mean_action_processing_ms": 0.14637571770920638, "mean_env_wait_ms": 3.2055199266150924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070037841796875, "StateBufferConnector_ms": 0.005565643310546875, "ViewRequirementAgentConnector_ms": 0.14562392234802246}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48569, "num_agent_steps_trained": 48569, "num_env_steps_sampled": 48569, "num_env_steps_trained": 48569, "num_env_steps_sampled_this_iter": 2049, "num_env_steps_trained_this_iter": 2049, "num_env_steps_sampled_throughput_per_sec": 200.40424656618745, "num_env_steps_trained_throughput_per_sec": 200.40424656618745, "timesteps_total": 48569, "num_steps_trained_this_iter": 2049, "agent_timesteps_total": 48569, "timers": {"training_iteration_time_ms": 10434.742, "sample_time_ms": 10216.312, "load_time_ms": 0.41, "load_throughput": 5171089.78, "learn_time_ms": 217.606, "learn_throughput": 9748.354, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 48569, "num_env_steps_trained": 48569, "num_agent_steps_sampled": 48569, "num_agent_steps_trained": 48569}, "done": false, "episodes_total": 429, "training_iteration": 23, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-03-34", "timestamp": 1706270614, "time_this_iter_s": 10.225424528121948, "time_total_s": 243.487322807312, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 243.487322807312, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 78.52857142857144, "ram_util_percent": 16.04285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19120822113472968, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0003, "total_loss": 7.795586854219437, "policy_loss": -0.014607931196223944, "vf_loss": 9.770003318786621, "vf_explained_var": -0.008488761261105537, "kl": 0.0016734731866749238, "entropy": 0.5807995237410069, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 752.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 50874, "num_env_steps_trained": 50874, "num_agent_steps_sampled": 50874, "num_agent_steps_trained": 50874}, "sampler_results": {"episode_reward_max": 262.9086397447676, "episode_reward_min": 77.83489192720299, "episode_reward_mean": 191.11315795803847, "episode_len_mean": 247.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177], "episode_lengths": [136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769917106620865, "mean_inference_ms": 1.1899947912638258, "mean_action_processing_ms": 0.14619898159790684, "mean_env_wait_ms": 3.203117910903202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007151126861572266, "StateBufferConnector_ms": 0.0055694580078125, "ViewRequirementAgentConnector_ms": 0.14476728439331055}}, "episode_reward_max": 262.9086397447676, "episode_reward_min": 77.83489192720299, "episode_reward_mean": 191.11315795803847, "episode_len_mean": 247.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [110.63246625544656, 109.27063003347767, 92.95365581289369, 105.2159635076171, 247.4403161229089, 122.28817358025842, 145.21435741570406, 138.73563920416586, 229.30088733845773, 196.6225861544266, 219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177], "episode_lengths": [136, 132, 114, 128, 301, 158, 213, 172, 301, 232, 301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769917106620865, "mean_inference_ms": 1.1899947912638258, "mean_action_processing_ms": 0.14619898159790684, "mean_env_wait_ms": 3.203117910903202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007151126861572266, "StateBufferConnector_ms": 0.0055694580078125, "ViewRequirementAgentConnector_ms": 0.14476728439331055}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50874, "num_agent_steps_trained": 50874, "num_env_steps_sampled": 50874, "num_env_steps_trained": 50874, "num_env_steps_sampled_this_iter": 2305, "num_env_steps_trained_this_iter": 2305, "num_env_steps_sampled_throughput_per_sec": 205.9011382323679, "num_env_steps_trained_throughput_per_sec": 205.9011382323679, "timesteps_total": 50874, "num_steps_trained_this_iter": 2305, "agent_timesteps_total": 50874, "timers": {"training_iteration_time_ms": 10500.481, "sample_time_ms": 10282.861, "load_time_ms": 0.41, "load_throughput": 5209692.582, "learn_time_ms": 216.795, "learn_throughput": 9847.566, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 50874, "num_env_steps_trained": 50874, "num_agent_steps_sampled": 50874, "num_agent_steps_trained": 50874}, "done": false, "episodes_total": 437, "training_iteration": 24, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-03-45", "timestamp": 1706270625, "time_this_iter_s": 11.195654153823853, "time_total_s": 254.68297696113586, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 254.68297696113586, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 76.34375, "ram_util_percent": 16.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17470728466287255, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0003, "total_loss": 7.808282315731049, "policy_loss": -0.000237056432524696, "vf_loss": 9.767587751150131, "vf_explained_var": -0.11702304519712925, "kl": 0.006368566875660564, "entropy": 0.5550895910710096, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 784.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 53092, "num_env_steps_trained": 53092, "num_agent_steps_sampled": 53092, "num_agent_steps_trained": 53092}, "sampler_results": {"episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 194.09092951221803, "episode_len_mean": 250.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513], "episode_lengths": [301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3759562475726566, "mean_inference_ms": 1.1888513182767495, "mean_action_processing_ms": 0.1458398768849112, "mean_env_wait_ms": 3.196796182376561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071413516998291016, "StateBufferConnector_ms": 0.005519390106201172, "ViewRequirementAgentConnector_ms": 0.1436607837677002}}, "episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 194.09092951221803, "episode_len_mean": 250.31, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [219.37152054958074, 233.5473471382878, 91.47115286138586, 123.53313119100049, 228.88275725507526, 226.94955904602475, 232.74121915347914, 172.7385861111756, 180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513], "episode_lengths": [301, 301, 113, 147, 301, 301, 268, 202, 278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3759562475726566, "mean_inference_ms": 1.1888513182767495, "mean_action_processing_ms": 0.1458398768849112, "mean_env_wait_ms": 3.196796182376561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071413516998291016, "StateBufferConnector_ms": 0.005519390106201172, "ViewRequirementAgentConnector_ms": 0.1436607837677002}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53092, "num_agent_steps_trained": 53092, "num_env_steps_sampled": 53092, "num_env_steps_trained": 53092, "num_env_steps_sampled_this_iter": 2218, "num_env_steps_trained_this_iter": 2218, "num_env_steps_sampled_throughput_per_sec": 221.97976199617295, "num_env_steps_trained_throughput_per_sec": 221.97976199617295, "timesteps_total": 53092, "num_steps_trained_this_iter": 2218, "agent_timesteps_total": 53092, "timers": {"training_iteration_time_ms": 10328.876, "sample_time_ms": 10099.993, "load_time_ms": 0.428, "load_throughput": 5012300.635, "learn_time_ms": 228.031, "learn_throughput": 9418.466, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 53092, "num_env_steps_trained": 53092, "num_agent_steps_sampled": 53092, "num_agent_steps_trained": 53092}, "done": false, "episodes_total": 447, "training_iteration": 25, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-03-55", "timestamp": 1706270635, "time_this_iter_s": 9.993398427963257, "time_total_s": 264.6763753890991, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 264.6763753890991, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 67.96666666666667, "ram_util_percent": 16.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1783360649133101, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0003, "total_loss": 7.846161708235741, "policy_loss": 0.02137766478699632, "vf_loss": 9.787987023591995, "vf_explained_var": 0.019225168973207474, "kl": 0.0021700923764469415, "entropy": 0.5605603624135256, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 816.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 55310, "num_env_steps_trained": 55310, "num_agent_steps_sampled": 55310, "num_agent_steps_trained": 55310}, "sampler_results": {"episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 195.98743804058887, "episode_len_mean": 253.15, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767], "episode_lengths": [278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37513450576922563, "mean_inference_ms": 1.1877308931669954, "mean_action_processing_ms": 0.14555104561017582, "mean_env_wait_ms": 3.191111024232439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007193803787231445, "StateBufferConnector_ms": 0.005496025085449219, "ViewRequirementAgentConnector_ms": 0.14313006401062012}}, "episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 195.98743804058887, "episode_len_mean": 253.15, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [180.60503793275643, 211.03244195458308, 103.82771212281075, 180.72464855203194, 135.1148685424485, 147.4568599775647, 125.07195322148401, 133.93892810954753, 212.4199888988414, 214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767], "episode_lengths": [278, 301, 125, 267, 164, 175, 149, 161, 258, 301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37513450576922563, "mean_inference_ms": 1.1877308931669954, "mean_action_processing_ms": 0.14555104561017582, "mean_env_wait_ms": 3.191111024232439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007193803787231445, "StateBufferConnector_ms": 0.005496025085449219, "ViewRequirementAgentConnector_ms": 0.14313006401062012}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55310, "num_agent_steps_trained": 55310, "num_env_steps_sampled": 55310, "num_env_steps_trained": 55310, "num_env_steps_sampled_this_iter": 2218, "num_env_steps_trained_this_iter": 2218, "num_env_steps_sampled_throughput_per_sec": 213.90015951404135, "num_env_steps_trained_throughput_per_sec": 213.90015951404135, "timesteps_total": 55310, "num_steps_trained_this_iter": 2218, "agent_timesteps_total": 55310, "timers": {"training_iteration_time_ms": 10300.735, "sample_time_ms": 10072.215, "load_time_ms": 0.432, "load_throughput": 4985686.483, "learn_time_ms": 227.66, "learn_throughput": 9455.785, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 55310, "num_env_steps_trained": 55310, "num_agent_steps_sampled": 55310, "num_agent_steps_trained": 55310}, "done": false, "episodes_total": 455, "training_iteration": 26, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-04-06", "timestamp": 1706270646, "time_this_iter_s": 10.370365619659424, "time_total_s": 275.04674100875854, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 275.04674100875854, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 73.66666666666667, "ram_util_percent": 16.09333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2767019527964294, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0003, "total_loss": 7.724562615156174, "policy_loss": -0.009061472956091166, "vf_loss": 9.674366474151611, "vf_explained_var": -0.013624949380755424, "kl": 0.0011823221506655317, "entropy": 0.5869169030338526, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 848.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 57431, "num_env_steps_trained": 57431, "num_agent_steps_sampled": 57431, "num_agent_steps_trained": 57431}, "sampler_results": {"episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 196.80754754266943, "episode_len_mean": 255.58, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128], "episode_lengths": [301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3741017098934353, "mean_inference_ms": 1.1861079114832118, "mean_action_processing_ms": 0.14520904107678187, "mean_env_wait_ms": 3.1827639904124494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072498321533203125, "StateBufferConnector_ms": 0.005535602569580078, "ViewRequirementAgentConnector_ms": 0.1439964771270752}}, "episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 196.80754754266943, "episode_len_mean": 255.58, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [214.80985529209667, 206.3905428724624, 176.89621676852002, 180.93010107516628, 236.1651092713498, 154.29141615276941, 126.65691441962485, 204.1438821760216, 211.51160719449746, 190.7449231386538, 217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128], "episode_lengths": [301, 301, 213, 220, 287, 183, 156, 249, 301, 222, 301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3741017098934353, "mean_inference_ms": 1.1861079114832118, "mean_action_processing_ms": 0.14520904107678187, "mean_env_wait_ms": 3.1827639904124494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072498321533203125, "StateBufferConnector_ms": 0.005535602569580078, "ViewRequirementAgentConnector_ms": 0.1439964771270752}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57431, "num_agent_steps_trained": 57431, "num_env_steps_sampled": 57431, "num_env_steps_trained": 57431, "num_env_steps_sampled_this_iter": 2121, "num_env_steps_trained_this_iter": 2121, "num_env_steps_sampled_throughput_per_sec": 202.60505223205112, "num_env_steps_trained_throughput_per_sec": 202.60505223205112, "timesteps_total": 57431, "num_steps_trained_this_iter": 2121, "agent_timesteps_total": 57431, "timers": {"training_iteration_time_ms": 10390.125, "sample_time_ms": 10169.211, "load_time_ms": 0.415, "load_throughput": 5177573.476, "learn_time_ms": 220.068, "learn_throughput": 9771.967, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 57431, "num_env_steps_trained": 57431, "num_agent_steps_sampled": 57431, "num_agent_steps_trained": 57431}, "done": false, "episodes_total": 464, "training_iteration": 27, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-04-16", "timestamp": 1706270656, "time_this_iter_s": 10.469639778137207, "time_total_s": 285.51638078689575, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 285.51638078689575, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 77.47333333333333, "ram_util_percent": 16.07333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2932997099123895, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0003, "total_loss": 7.694347694516182, "policy_loss": -0.046589515870437026, "vf_loss": 9.683308869600296, "vf_explained_var": 0.005143437534570694, "kl": 0.004172120507025895, "entropy": 0.5709860678762197, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 880.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 59656, "num_env_steps_trained": 59656, "num_agent_steps_sampled": 59656, "num_agent_steps_trained": 59656}, "sampler_results": {"episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 193.83711008848266, "episode_len_mean": 253.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405], "episode_lengths": [301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37305851736220846, "mean_inference_ms": 1.1845446764590477, "mean_action_processing_ms": 0.1448809133296964, "mean_env_wait_ms": 3.1746840514891574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007256031036376953, "StateBufferConnector_ms": 0.005490303039550781, "ViewRequirementAgentConnector_ms": 0.1440117359161377}}, "episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 193.83711008848266, "episode_len_mean": 253.5, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [217.17139136573493, 151.86318179007995, 148.95254535557248, 190.08635696083002, 181.65380168754197, 228.10247157967913, 180.94223014617813, 229.32562749876445, 215.29931032577784, 120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405], "episode_lengths": [301, 184, 179, 222, 214, 301, 219, 301, 301, 146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37305851736220846, "mean_inference_ms": 1.1845446764590477, "mean_action_processing_ms": 0.1448809133296964, "mean_env_wait_ms": 3.1746840514891574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007256031036376953, "StateBufferConnector_ms": 0.005490303039550781, "ViewRequirementAgentConnector_ms": 0.1440117359161377}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59656, "num_agent_steps_trained": 59656, "num_env_steps_sampled": 59656, "num_env_steps_trained": 59656, "num_env_steps_sampled_this_iter": 2225, "num_env_steps_trained_this_iter": 2225, "num_env_steps_sampled_throughput_per_sec": 203.5926075517999, "num_env_steps_trained_throughput_per_sec": 203.5926075517999, "timesteps_total": 59656, "num_steps_trained_this_iter": 2225, "agent_timesteps_total": 59656, "timers": {"training_iteration_time_ms": 10499.337, "sample_time_ms": 10277.927, "load_time_ms": 0.415, "load_throughput": 5220782.533, "learn_time_ms": 220.577, "learn_throughput": 9827.408, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 59656, "num_env_steps_trained": 59656, "num_agent_steps_sampled": 59656, "num_agent_steps_trained": 59656}, "done": false, "episodes_total": 474, "training_iteration": 28, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-04-27", "timestamp": 1706270667, "time_this_iter_s": 10.929767370223999, "time_total_s": 296.44614815711975, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 296.44614815711975, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 77.44, "ram_util_percent": 16.113333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3078852735925466, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0003, "total_loss": 7.742624074220657, "policy_loss": -0.025368626695126295, "vf_loss": 9.717106699943542, "vf_explained_var": 0.07157213427126408, "kl": 0.0027128959655965453, "entropy": 0.5692718643695116, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 912.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 61722, "num_env_steps_trained": 61722, "num_agent_steps_sampled": 61722, "num_agent_steps_trained": 61722}, "sampler_results": {"episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 192.1603848813881, "episode_len_mean": 251.94, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541], "episode_lengths": [146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37243095519070396, "mean_inference_ms": 1.1838752697616892, "mean_action_processing_ms": 0.14468981878739368, "mean_env_wait_ms": 3.170407958258414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007208108901977539, "StateBufferConnector_ms": 0.00555109977722168, "ViewRequirementAgentConnector_ms": 0.14679646492004395}}, "episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 192.1603848813881, "episode_len_mean": 251.94, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [120.83856364721152, 232.60791025113417, 106.91022197859749, 254.91247887919295, 222.24743789401026, 235.89158598593255, 223.8760258347601, 210.65808851307662, 99.96658839155639, 117.8836378113023, 221.82403749424816, 209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541], "episode_lengths": [146, 276, 126, 301, 301, 301, 301, 301, 141, 142, 264, 301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37243095519070396, "mean_inference_ms": 1.1838752697616892, "mean_action_processing_ms": 0.14468981878739368, "mean_env_wait_ms": 3.170407958258414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007208108901977539, "StateBufferConnector_ms": 0.00555109977722168, "ViewRequirementAgentConnector_ms": 0.14679646492004395}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61722, "num_agent_steps_trained": 61722, "num_env_steps_sampled": 61722, "num_env_steps_trained": 61722, "num_env_steps_sampled_this_iter": 2066, "num_env_steps_trained_this_iter": 2066, "num_env_steps_sampled_throughput_per_sec": 185.53657390150642, "num_env_steps_trained_throughput_per_sec": 185.53657390150642, "timesteps_total": 61722, "num_steps_trained_this_iter": 2066, "agent_timesteps_total": 61722, "timers": {"training_iteration_time_ms": 10587.71, "sample_time_ms": 10356.735, "load_time_ms": 0.45, "load_throughput": 4821338.0, "learn_time_ms": 230.091, "learn_throughput": 9427.139, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 61722, "num_env_steps_trained": 61722, "num_agent_steps_sampled": 61722, "num_agent_steps_trained": 61722}, "done": false, "episodes_total": 483, "training_iteration": 29, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-04-38", "timestamp": 1706270678, "time_this_iter_s": 11.136533737182617, "time_total_s": 307.58268189430237, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 307.58268189430237, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 83.33749999999999, "ram_util_percent": 16.168749999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.32412785245105624, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0003, "total_loss": 7.657969117164612, "policy_loss": -0.036316725352662615, "vf_loss": 9.625014215707779, "vf_explained_var": 0.024586478248238564, "kl": 0.003954232239613123, "entropy": 0.572559742256999, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 944.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 63851, "num_env_steps_trained": 63851, "num_agent_steps_sampled": 63851, "num_agent_steps_trained": 63851}, "sampler_results": {"episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 187.30022610701997, "episode_len_mean": 247.23, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606], "episode_lengths": [301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3717066869778482, "mean_inference_ms": 1.1829333604683228, "mean_action_processing_ms": 0.14444853608050967, "mean_env_wait_ms": 3.1647583869768527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071752071380615234, "StateBufferConnector_ms": 0.005514860153198242, "ViewRequirementAgentConnector_ms": 0.14589214324951172}}, "episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 187.30022610701997, "episode_len_mean": 247.23, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [209.72736568104295, 238.56667965672673, 227.66748098762787, 174.27527592083362, 171.88999714004825, 77.83489192720299, 233.2853512920679, 198.5428743766271, 152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606], "episode_lengths": [301, 301, 301, 220, 211, 100, 301, 229, 222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3717066869778482, "mean_inference_ms": 1.1829333604683228, "mean_action_processing_ms": 0.14444853608050967, "mean_env_wait_ms": 3.1647583869768527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071752071380615234, "StateBufferConnector_ms": 0.005514860153198242, "ViewRequirementAgentConnector_ms": 0.14589214324951172}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63851, "num_agent_steps_trained": 63851, "num_env_steps_sampled": 63851, "num_env_steps_trained": 63851, "num_env_steps_sampled_this_iter": 2129, "num_env_steps_trained_this_iter": 2129, "num_env_steps_sampled_throughput_per_sec": 222.17507897580558, "num_env_steps_trained_throughput_per_sec": 222.17507897580558, "timesteps_total": 63851, "num_steps_trained_this_iter": 2129, "agent_timesteps_total": 63851, "timers": {"training_iteration_time_ms": 10416.005, "sample_time_ms": 10184.066, "load_time_ms": 0.451, "load_throughput": 4817341.175, "learn_time_ms": 231.054, "learn_throughput": 9403.427, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 63851, "num_env_steps_trained": 63851, "num_agent_steps_sampled": 63851, "num_agent_steps_trained": 63851}, "done": false, "episodes_total": 494, "training_iteration": 30, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-04-48", "timestamp": 1706270688, "time_this_iter_s": 9.583553791046143, "time_total_s": 317.1662356853485, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 317.1662356853485, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 70.92142857142858, "ram_util_percent": 16.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17802677676081657, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0003, "total_loss": 7.805812790989876, "policy_loss": -0.012432361370883882, "vf_loss": 9.77995166182518, "vf_explained_var": 0.015346640720963478, "kl": 0.0033492748751010742, "entropy": 0.5716086458414793, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 976.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 66001, "num_env_steps_trained": 66001, "num_agent_steps_sampled": 66001, "num_agent_steps_trained": 66001}, "sampler_results": {"episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 188.45684051453208, "episode_len_mean": 249.09, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773], "episode_lengths": [222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37118669015769384, "mean_inference_ms": 1.181810578596191, "mean_action_processing_ms": 0.14426919072518465, "mean_env_wait_ms": 3.160179534299465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007257938385009766, "StateBufferConnector_ms": 0.005527973175048828, "ViewRequirementAgentConnector_ms": 0.14683842658996582}}, "episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 188.45684051453208, "episode_len_mean": 249.09, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [152.384845388637, 230.4779171221421, 233.18267617625563, 144.8390444106637, 195.39104614146206, 226.4113976648672, 213.19795621582318, 203.89394854157214, 253.43830503147237, 112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773], "episode_lengths": [222, 301, 296, 213, 291, 271, 301, 301, 301, 141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37118669015769384, "mean_inference_ms": 1.181810578596191, "mean_action_processing_ms": 0.14426919072518465, "mean_env_wait_ms": 3.160179534299465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007257938385009766, "StateBufferConnector_ms": 0.005527973175048828, "ViewRequirementAgentConnector_ms": 0.14683842658996582}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66001, "num_agent_steps_trained": 66001, "num_env_steps_sampled": 66001, "num_env_steps_trained": 66001, "num_env_steps_sampled_this_iter": 2150, "num_env_steps_trained_this_iter": 2150, "num_env_steps_sampled_throughput_per_sec": 202.362209124146, "num_env_steps_trained_throughput_per_sec": 202.362209124146, "timesteps_total": 66001, "num_steps_trained_this_iter": 2150, "agent_timesteps_total": 66001, "timers": {"training_iteration_time_ms": 10427.818, "sample_time_ms": 10203.812, "load_time_ms": 0.435, "load_throughput": 4953288.624, "learn_time_ms": 223.153, "learn_throughput": 9653.896, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 66001, "num_env_steps_trained": 66001, "num_agent_steps_sampled": 66001, "num_agent_steps_trained": 66001}, "done": false, "episodes_total": 502, "training_iteration": 31, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-04-59", "timestamp": 1706270699, "time_this_iter_s": 10.625585794448853, "time_total_s": 327.79182147979736, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 327.79182147979736, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 77.49333333333333, "ram_util_percent": 16.17333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1989358018618077, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0003, "total_loss": 7.7876375168561935, "policy_loss": -0.005472387420013547, "vf_loss": 9.74854302406311, "vf_explained_var": 0.02168339677155018, "kl": 0.002850112665342408, "entropy": 0.5724488236010075, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1008.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 68188, "num_env_steps_trained": 68188, "num_agent_steps_sampled": 68188, "num_agent_steps_trained": 68188}, "sampler_results": {"episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 186.6458912744437, "episode_len_mean": 245.99, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082], "episode_lengths": [141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3707020580035725, "mean_inference_ms": 1.1805334911142047, "mean_action_processing_ms": 0.1441028654689609, "mean_env_wait_ms": 3.1557285658864203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007480621337890625, "StateBufferConnector_ms": 0.005601167678833008, "ViewRequirementAgentConnector_ms": 0.1472949981689453}}, "episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 186.6458912744437, "episode_len_mean": 245.99, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [112.65359986252705, 176.31335910317725, 151.6267362069745, 205.1561617121538, 220.53981138363213, 246.30308605149347, 210.09508086879723, 220.70571615592556, 206.95601750746565, 238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082], "episode_lengths": [141, 207, 220, 301, 301, 301, 301, 256, 301, 301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3707020580035725, "mean_inference_ms": 1.1805334911142047, "mean_action_processing_ms": 0.1441028654689609, "mean_env_wait_ms": 3.1557285658864203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007480621337890625, "StateBufferConnector_ms": 0.005601167678833008, "ViewRequirementAgentConnector_ms": 0.1472949981689453}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68188, "num_agent_steps_trained": 68188, "num_env_steps_sampled": 68188, "num_env_steps_trained": 68188, "num_env_steps_sampled_this_iter": 2187, "num_env_steps_trained_this_iter": 2187, "num_env_steps_sampled_throughput_per_sec": 202.21732018341598, "num_env_steps_trained_throughput_per_sec": 202.21732018341598, "timesteps_total": 68188, "num_steps_trained_this_iter": 2187, "agent_timesteps_total": 68188, "timers": {"training_iteration_time_ms": 10533.47, "sample_time_ms": 10307.131, "load_time_ms": 0.445, "load_throughput": 4867558.196, "learn_time_ms": 225.473, "learn_throughput": 9610.029, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 68188, "num_env_steps_trained": 68188, "num_agent_steps_sampled": 68188, "num_agent_steps_trained": 68188}, "done": false, "episodes_total": 511, "training_iteration": 32, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-05-10", "timestamp": 1706270710, "time_this_iter_s": 10.816205263137817, "time_total_s": 338.6080267429352, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 338.6080267429352, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 76.5, "ram_util_percent": 16.06875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2838262883014977, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0003, "total_loss": 7.7295574098825455, "policy_loss": -0.04079627827741206, "vf_loss": 9.719796389341354, "vf_explained_var": 0.017001263797283173, "kl": 0.002576432862031456, "entropy": 0.5483371112495661, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1040.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 70444, "num_env_steps_trained": 70444, "num_agent_steps_sampled": 70444, "num_agent_steps_trained": 70444}, "sampler_results": {"episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 185.55885176352186, "episode_len_mean": 245.26, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3703195553029458, "mean_inference_ms": 1.1794525750203044, "mean_action_processing_ms": 0.14395709833286363, "mean_env_wait_ms": 3.1520902075794437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008877277374267578, "StateBufferConnector_ms": 0.005551338195800781, "ViewRequirementAgentConnector_ms": 0.14662575721740723}}, "episode_reward_max": 262.9086397447676, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 185.55885176352186, "episode_len_mean": 245.26, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [238.0107046250793, 256.0091598290631, 251.8685094245583, 215.82230028354581, 210.33327578807618, 262.9086397447676, 232.0002971789336, 242.73293491573872, 197.02360940614165, 236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 243, 301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3703195553029458, "mean_inference_ms": 1.1794525750203044, "mean_action_processing_ms": 0.14395709833286363, "mean_env_wait_ms": 3.1520902075794437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008877277374267578, "StateBufferConnector_ms": 0.005551338195800781, "ViewRequirementAgentConnector_ms": 0.14662575721740723}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70444, "num_agent_steps_trained": 70444, "num_env_steps_sampled": 70444, "num_env_steps_trained": 70444, "num_env_steps_sampled_this_iter": 2256, "num_env_steps_trained_this_iter": 2256, "num_env_steps_sampled_throughput_per_sec": 210.5260472299127, "num_env_steps_trained_throughput_per_sec": 210.5260472299127, "timesteps_total": 70444, "num_steps_trained_this_iter": 2256, "agent_timesteps_total": 70444, "timers": {"training_iteration_time_ms": 10582.637, "sample_time_ms": 10348.557, "load_time_ms": 0.48, "load_throughput": 4552917.825, "learn_time_ms": 233.168, "learn_throughput": 9381.662, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 70444, "num_env_steps_trained": 70444, "num_agent_steps_sampled": 70444, "num_agent_steps_trained": 70444}, "done": false, "episodes_total": 520, "training_iteration": 33, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-05-20", "timestamp": 1706270720, "time_this_iter_s": 10.717499732971191, "time_total_s": 349.3255264759064, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 349.3255264759064, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 73.24, "ram_util_percent": 16.073333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.26717104110866785, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0003, "total_loss": 7.781294479966164, "policy_loss": 0.014794550748774782, "vf_loss": 9.715065747499466, "vf_explained_var": 0.04179780371487141, "kl": 0.00260083700947061, "entropy": 0.5552812498062849, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1072.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 72693, "num_env_steps_trained": 72693, "num_agent_steps_sampled": 72693, "num_agent_steps_trained": 72693}, "sampler_results": {"episode_reward_max": 254.59157807702468, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 181.60225267397848, "episode_len_mean": 241.24, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814], "episode_lengths": [301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3698798826710457, "mean_inference_ms": 1.1782515169660661, "mean_action_processing_ms": 0.14378735521139166, "mean_env_wait_ms": 3.1479554933625566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008835315704345703, "StateBufferConnector_ms": 0.005477428436279297, "ViewRequirementAgentConnector_ms": 0.14564013481140137}}, "episode_reward_max": 254.59157807702468, "episode_reward_min": 28.055377133438128, "episode_reward_mean": 181.60225267397848, "episode_len_mean": 241.24, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [236.97435712245405, 184.607259221172, 217.92400285625047, 194.698006014051, 211.02014521252153, 216.90702435071677, 232.88082287976326, 223.5816746280177, 28.055377133438128, 244.67622581284388, 231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814], "episode_lengths": [301, 214, 301, 285, 301, 301, 301, 301, 40, 296, 273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3698798826710457, "mean_inference_ms": 1.1782515169660661, "mean_action_processing_ms": 0.14378735521139166, "mean_env_wait_ms": 3.1479554933625566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008835315704345703, "StateBufferConnector_ms": 0.005477428436279297, "ViewRequirementAgentConnector_ms": 0.14564013481140137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72693, "num_agent_steps_trained": 72693, "num_env_steps_sampled": 72693, "num_env_steps_trained": 72693, "num_env_steps_sampled_this_iter": 2249, "num_env_steps_trained_this_iter": 2249, "num_env_steps_sampled_throughput_per_sec": 221.9946426583658, "num_env_steps_trained_throughput_per_sec": 221.9946426583658, "timesteps_total": 72693, "num_steps_trained_this_iter": 2249, "agent_timesteps_total": 72693, "timers": {"training_iteration_time_ms": 10476.255, "sample_time_ms": 10241.655, "load_time_ms": 0.481, "load_throughput": 4540135.882, "learn_time_ms": 233.689, "learn_throughput": 9336.786, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 72693, "num_env_steps_trained": 72693, "num_agent_steps_sampled": 72693, "num_agent_steps_trained": 72693}, "done": false, "episodes_total": 529, "training_iteration": 34, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-05-31", "timestamp": 1706270731, "time_this_iter_s": 10.13193941116333, "time_total_s": 359.4574658870697, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 359.4574658870697, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 69.18666666666668, "ram_util_percent": 16.086666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6315846792422235, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0003, "total_loss": 7.659278959035873, "policy_loss": -0.027706465960363857, "vf_loss": 9.615749031305313, "vf_explained_var": 0.11567608825862408, "kl": 0.0025069465887933504, "entropy": 0.561378913000226, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1104.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 74784, "num_env_steps_trained": 74784, "num_agent_steps_sampled": 74784, "num_agent_steps_trained": 74784}, "sampler_results": {"episode_reward_max": 254.59157807702468, "episode_reward_min": 59.2886926027418, "episode_reward_mean": 177.01842264856782, "episode_len_mean": 235.74, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724], "episode_lengths": [273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36946699893448, "mean_inference_ms": 1.1771187092022553, "mean_action_processing_ms": 0.14362675696630345, "mean_env_wait_ms": 3.144122697250858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00856924057006836, "StateBufferConnector_ms": 0.0054509639739990234, "ViewRequirementAgentConnector_ms": 0.14591336250305176}}, "episode_reward_max": 254.59157807702468, "episode_reward_min": 59.2886926027418, "episode_reward_mean": 177.01842264856782, "episode_len_mean": 235.74, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [231.46986740403412, 163.7582360761077, 95.02347283034837, 132.36108981623218, 242.85074948132032, 225.44092682984316, 236.32792507694913, 195.48796038219513, 231.30352772940742, 172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724], "episode_lengths": [273, 191, 119, 164, 298, 301, 301, 235, 301, 267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36946699893448, "mean_inference_ms": 1.1771187092022553, "mean_action_processing_ms": 0.14362675696630345, "mean_env_wait_ms": 3.144122697250858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00856924057006836, "StateBufferConnector_ms": 0.0054509639739990234, "ViewRequirementAgentConnector_ms": 0.14591336250305176}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74784, "num_agent_steps_trained": 74784, "num_env_steps_sampled": 74784, "num_env_steps_trained": 74784, "num_env_steps_sampled_this_iter": 2091, "num_env_steps_trained_this_iter": 2091, "num_env_steps_sampled_throughput_per_sec": 202.3201703917878, "num_env_steps_trained_throughput_per_sec": 202.3201703917878, "timesteps_total": 74784, "num_steps_trained_this_iter": 2091, "agent_timesteps_total": 74784, "timers": {"training_iteration_time_ms": 10510.575, "sample_time_ms": 10286.243, "load_time_ms": 0.465, "load_throughput": 4664590.739, "learn_time_ms": 223.444, "learn_throughput": 9708.032, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 74784, "num_env_steps_trained": 74784, "num_agent_steps_sampled": 74784, "num_agent_steps_trained": 74784}, "done": false, "episodes_total": 539, "training_iteration": 35, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-05-41", "timestamp": 1706270741, "time_this_iter_s": 10.336101770401001, "time_total_s": 369.7935676574707, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 369.7935676574707, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 78.42857142857143, "ram_util_percent": 16.078571428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.32131672091782093, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0003, "total_loss": 7.746024057269096, "policy_loss": -0.03759084141347557, "vf_loss": 9.736568242311478, "vf_explained_var": 0.06096645072102547, "kl": 0.003811932107490753, "entropy": 0.5639679655432701, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1136.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 76856, "num_env_steps_trained": 76856, "num_agent_steps_sampled": 76856, "num_agent_steps_trained": 76856}, "sampler_results": {"episode_reward_max": 254.59157807702468, "episode_reward_min": 59.2886926027418, "episode_reward_mean": 175.24776325234473, "episode_len_mean": 234.63, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504], "episode_lengths": [267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36920440981847363, "mean_inference_ms": 1.1764126095409209, "mean_action_processing_ms": 0.14352761195416544, "mean_env_wait_ms": 3.1418875048719084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008532047271728516, "StateBufferConnector_ms": 0.005417585372924805, "ViewRequirementAgentConnector_ms": 0.14572477340698242}}, "episode_reward_max": 254.59157807702468, "episode_reward_min": 59.2886926027418, "episode_reward_mean": 175.24776325234473, "episode_len_mean": 234.63, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [172.79716384147943, 228.97476513481206, 253.00682509281003, 227.272392522361, 228.72664564359988, 157.55716060254198, 219.2476455760767, 183.83676292597573, 92.32369926911402, 137.54462704758555, 137.58689843400637, 225.73972046873612, 170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504], "episode_lengths": [267, 301, 301, 301, 301, 188, 258, 276, 139, 201, 209, 301, 245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36920440981847363, "mean_inference_ms": 1.1764126095409209, "mean_action_processing_ms": 0.14352761195416544, "mean_env_wait_ms": 3.1418875048719084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008532047271728516, "StateBufferConnector_ms": 0.005417585372924805, "ViewRequirementAgentConnector_ms": 0.14572477340698242}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76856, "num_agent_steps_trained": 76856, "num_env_steps_sampled": 76856, "num_env_steps_trained": 76856, "num_env_steps_sampled_this_iter": 2072, "num_env_steps_trained_this_iter": 2072, "num_env_steps_sampled_throughput_per_sec": 203.02267794186545, "num_env_steps_trained_throughput_per_sec": 203.02267794186545, "timesteps_total": 76856, "num_steps_trained_this_iter": 2072, "agent_timesteps_total": 76856, "timers": {"training_iteration_time_ms": 10494.219, "sample_time_ms": 10269.847, "load_time_ms": 0.468, "load_throughput": 4602988.539, "learn_time_ms": 223.484, "learn_throughput": 9640.969, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 76856, "num_env_steps_trained": 76856, "num_agent_steps_sampled": 76856, "num_agent_steps_trained": 76856}, "done": false, "episodes_total": 548, "training_iteration": 36, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-05-51", "timestamp": 1706270751, "time_this_iter_s": 10.206793785095215, "time_total_s": 380.0003614425659, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 380.0003614425659, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 77.19333333333333, "ram_util_percent": 15.986666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4675328228622675, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0003, "total_loss": 7.653335258364677, "policy_loss": 0.01448833616450429, "vf_loss": 9.555602073669434, "vf_explained_var": 0.05364055931568146, "kl": 0.0011942518958068596, "entropy": 0.5634795129299164, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1168.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 79043, "num_env_steps_trained": 79043, "num_agent_steps_sampled": 79043, "num_agent_steps_trained": 79043}, "sampler_results": {"episode_reward_max": 254.59157807702468, "episode_reward_min": 59.2886926027418, "episode_reward_mean": 169.07201372552873, "episode_len_mean": 226.07, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695], "episode_lengths": [245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3689266361878484, "mean_inference_ms": 1.1755822062146577, "mean_action_processing_ms": 0.14340717429078112, "mean_env_wait_ms": 3.139158314775433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008461952209472656, "StateBufferConnector_ms": 0.005383491516113281, "ViewRequirementAgentConnector_ms": 0.14506149291992188}}, "episode_reward_max": 254.59157807702468, "episode_reward_min": 59.2886926027418, "episode_reward_mean": 169.07201372552873, "episode_len_mean": 226.07, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [170.57874437773884, 97.89296879303237, 220.3018265916296, 246.3981416123128, 171.579658244108, 209.59632251053984, 135.81987474247637, 166.66486177064039, 136.79483417972077, 154.00152254781355, 98.0828511686177, 159.22459522036345, 176.3359219557695, 197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695], "episode_lengths": [245, 148, 301, 301, 250, 243, 192, 209, 198, 228, 118, 227, 271, 289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3689266361878484, "mean_inference_ms": 1.1755822062146577, "mean_action_processing_ms": 0.14340717429078112, "mean_env_wait_ms": 3.139158314775433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008461952209472656, "StateBufferConnector_ms": 0.005383491516113281, "ViewRequirementAgentConnector_ms": 0.14506149291992188}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79043, "num_agent_steps_trained": 79043, "num_env_steps_sampled": 79043, "num_env_steps_trained": 79043, "num_env_steps_sampled_this_iter": 2187, "num_env_steps_trained_this_iter": 2187, "num_env_steps_sampled_throughput_per_sec": 211.80407532236708, "num_env_steps_trained_throughput_per_sec": 211.80407532236708, "timesteps_total": 79043, "num_steps_trained_this_iter": 2187, "agent_timesteps_total": 79043, "timers": {"training_iteration_time_ms": 10479.911, "sample_time_ms": 10245.738, "load_time_ms": 0.481, "load_throughput": 4492828.016, "learn_time_ms": 233.272, "learn_throughput": 9264.739, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 79043, "num_env_steps_trained": 79043, "num_agent_steps_sampled": 79043, "num_agent_steps_trained": 79043}, "done": false, "episodes_total": 560, "training_iteration": 37, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-06-02", "timestamp": 1706270762, "time_this_iter_s": 10.327136993408203, "time_total_s": 390.3274984359741, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 390.3274984359741, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 72.76, "ram_util_percent": 16.073333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.34724534675478935, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0003, "total_loss": 7.624250084161758, "policy_loss": -0.011614181043114513, "vf_loss": 9.551890790462494, "vf_explained_var": 0.0006612036377191544, "kl": 0.004115062717085113, "entropy": 0.5648316331207752, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1200.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 81386, "num_env_steps_trained": 81386, "num_agent_steps_sampled": 81386, "num_agent_steps_trained": 81386}, "sampler_results": {"episode_reward_max": 254.59157807702468, "episode_reward_min": 59.2886926027418, "episode_reward_mean": 165.05242345688185, "episode_len_mean": 220.19, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542], "episode_lengths": [289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3685470436320978, "mean_inference_ms": 1.174415063405241, "mean_action_processing_ms": 0.14323769028527714, "mean_env_wait_ms": 3.1351053533191475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008438825607299805, "StateBufferConnector_ms": 0.005384922027587891, "ViewRequirementAgentConnector_ms": 0.1440284252166748}}, "episode_reward_max": 254.59157807702468, "episode_reward_min": 59.2886926027418, "episode_reward_mean": 165.05242345688185, "episode_len_mean": 220.19, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [197.39638060243405, 242.31651109091172, 115.35821070718107, 129.31011855171508, 119.20345329009366, 158.63456962278858, 228.52719970946086, 250.9149326805689, 123.72653925842515, 207.7328610895541, 59.2886926027418, 97.45719812939328, 171.9678703054092, 113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542], "episode_lengths": [289, 301, 144, 195, 173, 219, 301, 301, 183, 249, 82, 145, 251, 135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3685470436320978, "mean_inference_ms": 1.174415063405241, "mean_action_processing_ms": 0.14323769028527714, "mean_env_wait_ms": 3.1351053533191475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008438825607299805, "StateBufferConnector_ms": 0.005384922027587891, "ViewRequirementAgentConnector_ms": 0.1440284252166748}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81386, "num_agent_steps_trained": 81386, "num_env_steps_sampled": 81386, "num_env_steps_trained": 81386, "num_env_steps_sampled_this_iter": 2343, "num_env_steps_trained_this_iter": 2343, "num_env_steps_sampled_throughput_per_sec": 223.53112658069347, "num_env_steps_trained_throughput_per_sec": 223.53112658069347, "timesteps_total": 81386, "num_steps_trained_this_iter": 2343, "agent_timesteps_total": 81386, "timers": {"training_iteration_time_ms": 10435.218, "sample_time_ms": 10199.593, "load_time_ms": 0.48, "load_throughput": 4523636.387, "learn_time_ms": 234.719, "learn_throughput": 9257.898, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 81386, "num_env_steps_trained": 81386, "num_agent_steps_sampled": 81386, "num_agent_steps_trained": 81386}, "done": false, "episodes_total": 573, "training_iteration": 38, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-06-12", "timestamp": 1706270772, "time_this_iter_s": 10.48285436630249, "time_total_s": 400.8103528022766, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 400.8103528022766, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 69.98, "ram_util_percent": 15.933333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2910500525031239, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0003, "total_loss": 7.66646882891655, "policy_loss": -0.03449456469388679, "vf_loss": 9.632971733808517, "vf_explained_var": 0.00984041579067707, "kl": 0.0016229640031289877, "entropy": 0.5414034146815538, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1232.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 83468, "num_env_steps_trained": 83468, "num_agent_steps_sampled": 83468, "num_agent_steps_trained": 83468}, "sampler_results": {"episode_reward_max": 254.59157807702468, "episode_reward_min": 69.74933213575014, "episode_reward_mean": 160.26894874171055, "episode_len_mean": 212.68, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133], "episode_lengths": [135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36808966339431876, "mean_inference_ms": 1.1731643319878826, "mean_action_processing_ms": 0.1430587389090931, "mean_env_wait_ms": 3.130427460325696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00850057601928711, "StateBufferConnector_ms": 0.005341053009033203, "ViewRequirementAgentConnector_ms": 0.1411452293395996}}, "episode_reward_max": 254.59157807702468, "episode_reward_min": 69.74933213575014, "episode_reward_mean": 160.26894874171055, "episode_len_mean": 212.68, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [113.25959555709439, 69.74933213575014, 175.09602686882806, 227.369686342712, 126.91153718909653, 229.92821418601136, 188.8907639334828, 101.68178199368606, 231.99947008908012, 140.426413209071, 219.97355481107297, 241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133], "episode_lengths": [135, 99, 248, 301, 187, 301, 234, 146, 301, 210, 301, 301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36808966339431876, "mean_inference_ms": 1.1731643319878826, "mean_action_processing_ms": 0.1430587389090931, "mean_env_wait_ms": 3.130427460325696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00850057601928711, "StateBufferConnector_ms": 0.005341053009033203, "ViewRequirementAgentConnector_ms": 0.1411452293395996}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83468, "num_agent_steps_trained": 83468, "num_env_steps_sampled": 83468, "num_env_steps_trained": 83468, "num_env_steps_sampled_this_iter": 2082, "num_env_steps_trained_this_iter": 2082, "num_env_steps_sampled_throughput_per_sec": 200.44657722632726, "num_env_steps_trained_throughput_per_sec": 200.44657722632726, "timesteps_total": 83468, "num_steps_trained_this_iter": 2082, "agent_timesteps_total": 83468, "timers": {"training_iteration_time_ms": 10360.373, "sample_time_ms": 10132.877, "load_time_ms": 0.451, "load_throughput": 4818751.838, "learn_time_ms": 226.636, "learn_throughput": 9595.142, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 83468, "num_env_steps_trained": 83468, "num_agent_steps_sampled": 83468, "num_agent_steps_trained": 83468}, "done": false, "episodes_total": 586, "training_iteration": 39, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-06-23", "timestamp": 1706270783, "time_this_iter_s": 10.388036489486694, "time_total_s": 411.1983892917633, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 411.1983892917633, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 77.27333333333334, "ram_util_percent": 16.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3343177046626806, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0003, "total_loss": 7.683075696229935, "policy_loss": 0.012748766632284969, "vf_loss": 9.594621270895004, "vf_explained_var": -0.0027939844876527786, "kl": 0.0035829723765772314, "entropy": 0.5370186530053616, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1264.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 85688, "num_env_steps_trained": 85688, "num_agent_steps_sampled": 85688, "num_agent_steps_trained": 85688}, "sampler_results": {"episode_reward_max": 254.59157807702468, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 158.52657007991039, "episode_len_mean": 210.25, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537], "episode_lengths": [301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36778604435158146, "mean_inference_ms": 1.1723934825729752, "mean_action_processing_ms": 0.14294709947758777, "mean_env_wait_ms": 3.1275277281052483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008485078811645508, "StateBufferConnector_ms": 0.0053369998931884766, "ViewRequirementAgentConnector_ms": 0.1411585807800293}}, "episode_reward_max": 254.59157807702468, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 158.52657007991039, "episode_len_mean": 210.25, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [241.06926163507813, 214.9492518052041, 128.3233955118163, 242.81128957760006, 227.8987210944773, 228.09385730679404, 126.86083393781291, 204.94817056904623, 222.01398179082247, 146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537], "episode_lengths": [301, 301, 156, 301, 279, 301, 162, 283, 275, 177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36778604435158146, "mean_inference_ms": 1.1723934825729752, "mean_action_processing_ms": 0.14294709947758777, "mean_env_wait_ms": 3.1275277281052483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008485078811645508, "StateBufferConnector_ms": 0.0053369998931884766, "ViewRequirementAgentConnector_ms": 0.1411585807800293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85688, "num_agent_steps_trained": 85688, "num_env_steps_sampled": 85688, "num_env_steps_trained": 85688, "num_env_steps_sampled_this_iter": 2220, "num_env_steps_trained_this_iter": 2220, "num_env_steps_sampled_throughput_per_sec": 200.45541493378335, "num_env_steps_trained_throughput_per_sec": 200.45541493378335, "timesteps_total": 85688, "num_steps_trained_this_iter": 2220, "agent_timesteps_total": 85688, "timers": {"training_iteration_time_ms": 10509.598, "sample_time_ms": 10283.938, "load_time_ms": 0.456, "load_throughput": 4789824.1, "learn_time_ms": 224.795, "learn_throughput": 9714.176, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 85688, "num_env_steps_trained": 85688, "num_agent_steps_sampled": 85688, "num_agent_steps_trained": 85688}, "done": false, "episodes_total": 597, "training_iteration": 40, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-06-34", "timestamp": 1706270794, "time_this_iter_s": 11.075713634490967, "time_total_s": 422.2741029262543, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 422.2741029262543, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 77.00625000000001, "ram_util_percent": 16.087500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.30329257622361183, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0003, "total_loss": 7.7038446962833405, "policy_loss": -0.026860525482334197, "vf_loss": 9.670094817876816, "vf_explained_var": -0.0019610263407230377, "kl": 0.003971718754576782, "entropy": 0.53706412948668, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1296.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 87768, "num_env_steps_trained": 87768, "num_agent_steps_sampled": 87768, "num_agent_steps_trained": 87768}, "sampler_results": {"episode_reward_max": 254.59157807702468, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 155.33915438303964, "episode_len_mean": 207.46, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945], "episode_lengths": [177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3675119477063041, "mean_inference_ms": 1.171678107788635, "mean_action_processing_ms": 0.14284448990102042, "mean_env_wait_ms": 3.124892318902362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008503198623657227, "StateBufferConnector_ms": 0.005373954772949219, "ViewRequirementAgentConnector_ms": 0.14154934883117676}}, "episode_reward_max": 254.59157807702468, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 155.33915438303964, "episode_len_mean": 207.46, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [146.52352004782, 254.59157807702468, 147.1163972882298, 210.3073319377911, 131.6665417287082, 229.28190651001566, 213.54631446535677, 197.3668989290191, 122.300765005251, 189.319194333965, 108.74472967654657, 196.6594313278791, 212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945], "episode_lengths": [177, 301, 225, 301, 162, 301, 301, 301, 153, 231, 131, 283, 301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3675119477063041, "mean_inference_ms": 1.171678107788635, "mean_action_processing_ms": 0.14284448990102042, "mean_env_wait_ms": 3.124892318902362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008503198623657227, "StateBufferConnector_ms": 0.005373954772949219, "ViewRequirementAgentConnector_ms": 0.14154934883117676}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87768, "num_agent_steps_trained": 87768, "num_env_steps_sampled": 87768, "num_env_steps_trained": 87768, "num_env_steps_sampled_this_iter": 2080, "num_env_steps_trained_this_iter": 2080, "num_env_steps_sampled_throughput_per_sec": 210.16195581915866, "num_env_steps_trained_throughput_per_sec": 210.16195581915866, "timesteps_total": 87768, "num_steps_trained_this_iter": 2080, "agent_timesteps_total": 87768, "timers": {"training_iteration_time_ms": 10436.859, "sample_time_ms": 10203.605, "load_time_ms": 0.47, "load_throughput": 4630860.521, "learn_time_ms": 232.362, "learn_throughput": 9367.708, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 87768, "num_env_steps_trained": 87768, "num_agent_steps_sampled": 87768, "num_agent_steps_trained": 87768}, "done": false, "episodes_total": 606, "training_iteration": 41, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-06-44", "timestamp": 1706270804, "time_this_iter_s": 9.898820161819458, "time_total_s": 432.17292308807373, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 432.17292308807373, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 74.36428571428573, "ram_util_percent": 16.085714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40053248312324286, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0003, "total_loss": 7.626635923981667, "policy_loss": -0.03020265302620828, "vf_loss": 9.578026860952377, "vf_explained_var": 0.0009791385382413864, "kl": 0.001264413349190363, "entropy": 0.5582993850111961, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1328.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 89842, "num_env_steps_trained": 89842, "num_agent_steps_sampled": 89842, "num_agent_steps_trained": 89842}, "sampler_results": {"episode_reward_max": 243.3762629652453, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 149.5152705711805, "episode_len_mean": 199.53, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445], "episode_lengths": [301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36711219314011934, "mean_inference_ms": 1.1706938350907123, "mean_action_processing_ms": 0.1427041640186503, "mean_env_wait_ms": 3.121007191655374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008065462112426758, "StateBufferConnector_ms": 0.00532841682434082, "ViewRequirementAgentConnector_ms": 0.14081454277038574}}, "episode_reward_max": 243.3762629652453, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 149.5152705711805, "episode_len_mean": 199.53, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [212.9657017834313, 171.46067572849893, 217.77660632593813, 127.97657090517487, 173.82332080167538, 230.61593284199208, 107.50957278245968, 209.36979701548748, 164.19687805029142, 238.3483531413688, 241.4324903771814, 117.88556372235142, 126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445], "episode_lengths": [301, 254, 261, 186, 255, 277, 130, 301, 237, 301, 301, 170, 183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36711219314011934, "mean_inference_ms": 1.1706938350907123, "mean_action_processing_ms": 0.1427041640186503, "mean_env_wait_ms": 3.121007191655374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008065462112426758, "StateBufferConnector_ms": 0.00532841682434082, "ViewRequirementAgentConnector_ms": 0.14081454277038574}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89842, "num_agent_steps_trained": 89842, "num_env_steps_sampled": 89842, "num_env_steps_trained": 89842, "num_env_steps_sampled_this_iter": 2074, "num_env_steps_trained_this_iter": 2074, "num_env_steps_sampled_throughput_per_sec": 219.04057250077943, "num_env_steps_trained_throughput_per_sec": 219.04057250077943, "timesteps_total": 89842, "num_steps_trained_this_iter": 2074, "agent_timesteps_total": 89842, "timers": {"training_iteration_time_ms": 10302.206, "sample_time_ms": 10069.312, "load_time_ms": 0.462, "load_throughput": 4691294.36, "learn_time_ms": 232.014, "learn_throughput": 9333.075, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 89842, "num_env_steps_trained": 89842, "num_agent_steps_sampled": 89842, "num_agent_steps_trained": 89842}, "done": false, "episodes_total": 618, "training_iteration": 42, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-06-53", "timestamp": 1706270813, "time_this_iter_s": 9.469604730606079, "time_total_s": 441.6425278186798, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 441.6425278186798, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 69.14615384615385, "ram_util_percent": 16.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2972677913494408, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0003, "total_loss": 7.683411315083504, "policy_loss": -0.031730593225802295, "vf_loss": 9.650631874799728, "vf_explained_var": 0.003062063828110695, "kl": 0.0013704150776995272, "entropy": 0.5363525450229645, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1360.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 92091, "num_env_steps_trained": 92091, "num_agent_steps_sampled": 92091, "num_agent_steps_trained": 92091}, "sampler_results": {"episode_reward_max": 243.3762629652453, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 144.9347845160256, "episode_len_mean": 192.28, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428], "episode_lengths": [183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3669507929236417, "mean_inference_ms": 1.1703650801741237, "mean_action_processing_ms": 0.14265134911746402, "mean_env_wait_ms": 3.119730218388156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070743560791015625, "StateBufferConnector_ms": 0.005442380905151367, "ViewRequirementAgentConnector_ms": 0.1428391933441162}}, "episode_reward_max": 243.3762629652453, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 144.9347845160256, "episode_len_mean": 192.28, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [126.22286464902227, 221.64138076905758, 133.7701790765607, 129.75309201892648, 218.72194460352668, 138.1467057755881, 98.1663236697393, 120.98101459062116, 227.6528238147724, 100.99098306246913, 164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428], "episode_lengths": [183, 269, 187, 159, 301, 199, 149, 173, 301, 154, 197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3669507929236417, "mean_inference_ms": 1.1703650801741237, "mean_action_processing_ms": 0.14265134911746402, "mean_env_wait_ms": 3.119730218388156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070743560791015625, "StateBufferConnector_ms": 0.005442380905151367, "ViewRequirementAgentConnector_ms": 0.1428391933441162}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92091, "num_agent_steps_trained": 92091, "num_env_steps_sampled": 92091, "num_env_steps_trained": 92091, "num_env_steps_sampled_this_iter": 2249, "num_env_steps_trained_this_iter": 2249, "num_env_steps_sampled_throughput_per_sec": 180.46040575188184, "num_env_steps_trained_throughput_per_sec": 180.46040575188184, "timesteps_total": 92091, "num_steps_trained_this_iter": 2249, "agent_timesteps_total": 92091, "timers": {"training_iteration_time_ms": 10476.861, "sample_time_ms": 10251.434, "load_time_ms": 0.427, "load_throughput": 5064374.09, "learn_time_ms": 224.591, "learn_throughput": 9638.427, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 92091, "num_env_steps_trained": 92091, "num_agent_steps_sampled": 92091, "num_agent_steps_trained": 92091}, "done": false, "episodes_total": 630, "training_iteration": 43, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-07-06", "timestamp": 1706270826, "time_this_iter_s": 12.463581085205078, "time_total_s": 454.1061089038849, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 454.1061089038849, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 85.6, "ram_util_percent": 16.077777777777783}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.34048013808205724, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0003, "total_loss": 7.719082668423653, "policy_loss": -0.008986116386950016, "vf_loss": 9.666850477457047, "vf_explained_var": -0.0008032247424125671, "kl": 0.003601936890297721, "entropy": 0.541170034557581, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1392.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 94256, "num_env_steps_trained": 94256, "num_agent_steps_sampled": 94256, "num_agent_steps_trained": 94256}, "sampler_results": {"episode_reward_max": 243.3762629652453, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 146.44381620474124, "episode_len_mean": 193.18, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066], "episode_lengths": [197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3668514749054373, "mean_inference_ms": 1.1701281123941132, "mean_action_processing_ms": 0.14261650082229174, "mean_env_wait_ms": 3.1188346538948037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007241725921630859, "StateBufferConnector_ms": 0.005462169647216797, "ViewRequirementAgentConnector_ms": 0.14364099502563477}}, "episode_reward_max": 243.3762629652453, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 146.44381620474124, "episode_len_mean": 193.18, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [164.5288680253252, 220.679054706494, 163.33986276836, 213.86280121897892, 230.66802867276746, 228.31307472438405, 149.71269603016032, 104.86244679518504, 92.46615761509763, 92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066], "episode_lengths": [197, 301, 243, 260, 301, 274, 185, 157, 133, 138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3668514749054373, "mean_inference_ms": 1.1701281123941132, "mean_action_processing_ms": 0.14261650082229174, "mean_env_wait_ms": 3.1188346538948037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007241725921630859, "StateBufferConnector_ms": 0.005462169647216797, "ViewRequirementAgentConnector_ms": 0.14364099502563477}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94256, "num_agent_steps_trained": 94256, "num_env_steps_sampled": 94256, "num_env_steps_trained": 94256, "num_env_steps_sampled_this_iter": 2165, "num_env_steps_trained_this_iter": 2165, "num_env_steps_sampled_throughput_per_sec": 202.6398585231551, "num_env_steps_trained_throughput_per_sec": 202.6398585231551, "timesteps_total": 94256, "num_steps_trained_this_iter": 2165, "agent_timesteps_total": 94256, "timers": {"training_iteration_time_ms": 10532.172, "sample_time_ms": 10307.407, "load_time_ms": 0.432, "load_throughput": 4997059.349, "learn_time_ms": 223.925, "learn_throughput": 9629.582, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 94256, "num_env_steps_trained": 94256, "num_agent_steps_sampled": 94256, "num_agent_steps_trained": 94256}, "done": false, "episodes_total": 640, "training_iteration": 44, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-07-16", "timestamp": 1706270836, "time_this_iter_s": 10.684952020645142, "time_total_s": 464.79106092453003, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 464.79106092453003, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 77.57333333333332, "ram_util_percent": 16.106666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3444392275996506, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0003, "total_loss": 7.7103976756334305, "policy_loss": -0.0037837502313777804, "vf_loss": 9.649406731128693, "vf_explained_var": -0.0004529878497123718, "kl": 0.0014291265727911437, "entropy": 0.5343913789838552, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1424.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 96434, "num_env_steps_trained": 96434, "num_agent_steps_sampled": 96434, "num_agent_steps_trained": 96434}, "sampler_results": {"episode_reward_max": 243.3762629652453, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 146.97690654791356, "episode_len_mean": 194.45, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402], "episode_lengths": [138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3667602145620366, "mean_inference_ms": 1.1699550845303488, "mean_action_processing_ms": 0.1425863138492374, "mean_env_wait_ms": 3.1181556483650557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007237672805786133, "StateBufferConnector_ms": 0.0054683685302734375, "ViewRequirementAgentConnector_ms": 0.14330196380615234}}, "episode_reward_max": 243.3762629652453, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 146.97690654791356, "episode_len_mean": 194.45, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [92.18718002350269, 77.9314661988343, 186.19135734171303, 85.37979502439117, 179.25862212228728, 165.83905280607433, 77.99722547622397, 230.21196722068788, 160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402], "episode_lengths": [138, 110, 268, 127, 256, 193, 114, 285, 197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3667602145620366, "mean_inference_ms": 1.1699550845303488, "mean_action_processing_ms": 0.1425863138492374, "mean_env_wait_ms": 3.1181556483650557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007237672805786133, "StateBufferConnector_ms": 0.0054683685302734375, "ViewRequirementAgentConnector_ms": 0.14330196380615234}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96434, "num_agent_steps_trained": 96434, "num_env_steps_sampled": 96434, "num_env_steps_trained": 96434, "num_env_steps_sampled_this_iter": 2178, "num_env_steps_trained_this_iter": 2178, "num_env_steps_sampled_throughput_per_sec": 201.81373811809584, "num_env_steps_trained_throughput_per_sec": 201.81373811809584, "timesteps_total": 96434, "num_steps_trained_this_iter": 2178, "agent_timesteps_total": 96434, "timers": {"training_iteration_time_ms": 10577.875, "sample_time_ms": 10353.06, "load_time_ms": 0.43, "load_throughput": 5032792.861, "learn_time_ms": 223.971, "learn_throughput": 9666.414, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 96434, "num_env_steps_trained": 96434, "num_agent_steps_sampled": 96434, "num_agent_steps_trained": 96434}, "done": false, "episodes_total": 649, "training_iteration": 45, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-07-27", "timestamp": 1706270847, "time_this_iter_s": 10.793216466903687, "time_total_s": 475.5842773914337, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 475.5842773914337, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 76.825, "ram_util_percent": 16.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.20351859112270176, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0003, "total_loss": 7.789372771978378, "policy_loss": -0.03907996043562889, "vf_loss": 9.792218387126923, "vf_explained_var": 0.0002674143761396408, "kl": 0.0028488240306761836, "entropy": 0.5321960523724556, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1456.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 98518, "num_env_steps_trained": 98518, "num_agent_steps_sampled": 98518, "num_agent_steps_trained": 98518}, "sampler_results": {"episode_reward_max": 243.59337963402479, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 152.72397573438198, "episode_len_mean": 200.38, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144], "episode_lengths": [197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36663873309795714, "mean_inference_ms": 1.1696882112815556, "mean_action_processing_ms": 0.14254372063295828, "mean_env_wait_ms": 3.1171635892228506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071868896484375, "StateBufferConnector_ms": 0.0054738521575927734, "ViewRequirementAgentConnector_ms": 0.14320707321166992}}, "episode_reward_max": 243.59337963402479, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 152.72397573438198, "episode_len_mean": 200.38, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [160.74629613994833, 91.83958287447315, 206.9906510342695, 83.40047545822584, 109.58025997834592, 117.38670442635221, 113.18233462293318, 156.33410178835493, 108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144], "episode_lengths": [197, 115, 251, 125, 159, 142, 164, 192, 153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36663873309795714, "mean_inference_ms": 1.1696882112815556, "mean_action_processing_ms": 0.14254372063295828, "mean_env_wait_ms": 3.1171635892228506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071868896484375, "StateBufferConnector_ms": 0.0054738521575927734, "ViewRequirementAgentConnector_ms": 0.14320707321166992}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98518, "num_agent_steps_trained": 98518, "num_env_steps_sampled": 98518, "num_env_steps_trained": 98518, "num_env_steps_sampled_this_iter": 2084, "num_env_steps_trained_this_iter": 2084, "num_env_steps_sampled_throughput_per_sec": 232.73028172066626, "num_env_steps_trained_throughput_per_sec": 232.73028172066626, "timesteps_total": 98518, "num_steps_trained_this_iter": 2084, "agent_timesteps_total": 98518, "timers": {"training_iteration_time_ms": 10452.756, "sample_time_ms": 10228.802, "load_time_ms": 0.426, "load_throughput": 5083478.613, "learn_time_ms": 223.116, "learn_throughput": 9708.865, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 98518, "num_env_steps_trained": 98518, "num_agent_steps_sampled": 98518, "num_agent_steps_trained": 98518}, "done": false, "episodes_total": 657, "training_iteration": 46, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-07-36", "timestamp": 1706270856, "time_this_iter_s": 8.955609321594238, "time_total_s": 484.53988671302795, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 484.53988671302795, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 64.3076923076923, "ram_util_percent": 16.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.24018483748659492, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0003, "total_loss": 7.789149969816208, "policy_loss": -0.035096279403660446, "vf_loss": 9.786823809146881, "vf_explained_var": -0.0005257092416286469, "kl": 0.003478904902479485, "entropy": 0.5212908051908016, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1488.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 100599, "num_env_steps_trained": 100599, "num_agent_steps_sampled": 100599, "num_agent_steps_trained": 100599}, "sampler_results": {"episode_reward_max": 249.009585812349, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 159.01005984411566, "episode_len_mean": 207.74, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926], "episode_lengths": [153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36655767452157406, "mean_inference_ms": 1.1695549673967292, "mean_action_processing_ms": 0.1425217307477965, "mean_env_wait_ms": 3.1166970989547225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007158517837524414, "StateBufferConnector_ms": 0.005457162857055664, "ViewRequirementAgentConnector_ms": 0.14342474937438965}}, "episode_reward_max": 249.009585812349, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 159.01005984411566, "episode_len_mean": 207.74, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [108.7053925733712, 100.90440097125703, 243.3762629652453, 170.04033148959485, 119.11942268988403, 130.59804240079976, 85.21051668175075, 203.4748508039542, 127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926], "episode_lengths": [153, 148, 301, 205, 145, 182, 126, 301, 174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36655767452157406, "mean_inference_ms": 1.1695549673967292, "mean_action_processing_ms": 0.1425217307477965, "mean_env_wait_ms": 3.1166970989547225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007158517837524414, "StateBufferConnector_ms": 0.005457162857055664, "ViewRequirementAgentConnector_ms": 0.14342474937438965}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100599, "num_agent_steps_trained": 100599, "num_env_steps_sampled": 100599, "num_env_steps_trained": 100599, "num_env_steps_sampled_this_iter": 2081, "num_env_steps_trained_this_iter": 2081, "num_env_steps_sampled_throughput_per_sec": 201.90746454268202, "num_env_steps_trained_throughput_per_sec": 201.90746454268202, "timesteps_total": 100599, "num_steps_trained_this_iter": 2081, "agent_timesteps_total": 100599, "timers": {"training_iteration_time_ms": 10450.87, "sample_time_ms": 10236.737, "load_time_ms": 0.406, "load_throughput": 5304025.403, "learn_time_ms": 213.324, "learn_throughput": 10104.804, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 100599, "num_env_steps_trained": 100599, "num_agent_steps_sampled": 100599, "num_agent_steps_trained": 100599}, "done": false, "episodes_total": 665, "training_iteration": 47, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-07-47", "timestamp": 1706270867, "time_this_iter_s": 10.307672500610352, "time_total_s": 494.8475592136383, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 494.8475592136383, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 78.35714285714286, "ram_util_percent": 16.064285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3152812561020255, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0003, "total_loss": 7.737139239907265, "policy_loss": -0.009494282101513818, "vf_loss": 9.689853698015213, "vf_explained_var": 0.0007227156311273575, "kl": 0.0019657440564380124, "entropy": 0.5249471990391612, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1520.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 102741, "num_env_steps_trained": 102741, "num_agent_steps_sampled": 102741, "num_agent_steps_trained": 102741}, "sampler_results": {"episode_reward_max": 253.51896700770263, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 163.44637813203312, "episode_len_mean": 213.55, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263], "episode_lengths": [174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.366511040570674, "mean_inference_ms": 1.1695015077899626, "mean_action_processing_ms": 0.14251060729470527, "mean_env_wait_ms": 3.116546656515661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007096529006958008, "StateBufferConnector_ms": 0.005469560623168945, "ViewRequirementAgentConnector_ms": 0.1435403823852539}}, "episode_reward_max": 253.51896700770263, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 163.44637813203312, "episode_len_mean": 213.55, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [127.01325706720553, 98.8198864163931, 168.86442755915033, 91.46271311876843, 137.66699769336023, 118.9806897517954, 125.40682372547988, 89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263], "episode_lengths": [174, 141, 208, 118, 168, 146, 156, 129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.366511040570674, "mean_inference_ms": 1.1695015077899626, "mean_action_processing_ms": 0.14251060729470527, "mean_env_wait_ms": 3.116546656515661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007096529006958008, "StateBufferConnector_ms": 0.005469560623168945, "ViewRequirementAgentConnector_ms": 0.1435403823852539}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102741, "num_agent_steps_trained": 102741, "num_env_steps_sampled": 102741, "num_env_steps_trained": 102741, "num_env_steps_sampled_this_iter": 2142, "num_env_steps_trained_this_iter": 2142, "num_env_steps_sampled_throughput_per_sec": 202.36677308556358, "num_env_steps_trained_throughput_per_sec": 202.36677308556358, "timesteps_total": 102741, "num_steps_trained_this_iter": 2142, "agent_timesteps_total": 102741, "timers": {"training_iteration_time_ms": 10461.168, "sample_time_ms": 10247.922, "load_time_ms": 0.408, "load_throughput": 5232772.21, "learn_time_ms": 212.439, "learn_throughput": 10052.283, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 102741, "num_env_steps_trained": 102741, "num_agent_steps_sampled": 102741, "num_agent_steps_trained": 102741}, "done": false, "episodes_total": 673, "training_iteration": 48, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-07-57", "timestamp": 1706270877, "time_this_iter_s": 10.585876941680908, "time_total_s": 505.4334361553192, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 505.4334361553192, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 76.39375, "ram_util_percent": 16.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1629672423005104, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0003, "total_loss": 7.812047094106674, "policy_loss": -0.0070813726633787155, "vf_loss": 9.780240625143051, "vf_explained_var": -0.0008845031261444092, "kl": 0.002579610913331207, "entropy": 0.5063974801450968, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1552.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 104791, "num_env_steps_trained": 104791, "num_agent_steps_sampled": 104791, "num_agent_steps_trained": 104791}, "sampler_results": {"episode_reward_max": 253.51896700770263, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 171.07123337907692, "episode_len_mean": 222.94, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399], "episode_lengths": [129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36644468404527997, "mean_inference_ms": 1.1693838006682464, "mean_action_processing_ms": 0.14249060546131068, "mean_env_wait_ms": 3.1161419888223496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007108449935913086, "StateBufferConnector_ms": 0.005446434020996094, "ViewRequirementAgentConnector_ms": 0.1428995132446289}}, "episode_reward_max": 253.51896700770263, "episode_reward_min": 70.4598521860196, "episode_reward_mean": 171.07123337907692, "episode_len_mean": 222.94, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89.44908750781788, 184.11615522968378, 97.70495485051863, 130.8320538615225, 141.84846700787986, 111.32155233397133, 124.5639638934883, 70.4598521860196, 117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399], "episode_lengths": [129, 226, 120, 160, 179, 157, 186, 105, 170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36644468404527997, "mean_inference_ms": 1.1693838006682464, "mean_action_processing_ms": 0.14249060546131068, "mean_env_wait_ms": 3.1161419888223496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007108449935913086, "StateBufferConnector_ms": 0.005446434020996094, "ViewRequirementAgentConnector_ms": 0.1428995132446289}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104791, "num_agent_steps_trained": 104791, "num_env_steps_sampled": 104791, "num_env_steps_trained": 104791, "num_env_steps_sampled_this_iter": 2050, "num_env_steps_trained_this_iter": 2050, "num_env_steps_sampled_throughput_per_sec": 210.56336463984476, "num_env_steps_trained_throughput_per_sec": 210.56336463984476, "timesteps_total": 104791, "num_steps_trained_this_iter": 2050, "agent_timesteps_total": 104791, "timers": {"training_iteration_time_ms": 10396.065, "sample_time_ms": 10178.257, "load_time_ms": 0.426, "load_throughput": 5010091.546, "learn_time_ms": 216.976, "learn_throughput": 9827.335, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 104791, "num_env_steps_trained": 104791, "num_agent_steps_sampled": 104791, "num_agent_steps_trained": 104791}, "done": false, "episodes_total": 680, "training_iteration": 49, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-08-07", "timestamp": 1706270887, "time_this_iter_s": 9.737361669540405, "time_total_s": 515.1707978248596, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 515.1707978248596, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 73.26428571428572, "ram_util_percent": 16.071428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.231293979100883, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0003, "total_loss": 7.768818944692612, "policy_loss": -0.051613425835967064, "vf_loss": 9.781844943761826, "vf_explained_var": -0.0001626536250114441, "kl": 0.001409713394290444, "entropy": 0.5043533239513636, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1584.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 106919, "num_env_steps_trained": 106919, "num_agent_steps_sampled": 106919, "num_agent_steps_trained": 106919}, "sampler_results": {"episode_reward_max": 253.55152064903245, "episode_reward_min": 79.57742392488315, "episode_reward_mean": 178.2980002487616, "episode_len_mean": 231.6, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356], "episode_lengths": [170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36632635059357105, "mean_inference_ms": 1.169138096274605, "mean_action_processing_ms": 0.1424533454761953, "mean_env_wait_ms": 3.1152871746287105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007416963577270508, "StateBufferConnector_ms": 0.0054569244384765625, "ViewRequirementAgentConnector_ms": 0.14522337913513184}}, "episode_reward_max": 253.55152064903245, "episode_reward_min": 79.57742392488315, "episode_reward_mean": 178.2980002487616, "episode_len_mean": 231.6, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [117.31763502099737, 145.0274223533791, 157.84653339669393, 109.3547873552469, 170.82316038231122, 103.30607348256041, 241.7239411175372, 172.81283985539838, 237.81230109223537, 151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356], "episode_lengths": [170, 175, 186, 155, 243, 151, 301, 247, 301, 217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36632635059357105, "mean_inference_ms": 1.169138096274605, "mean_action_processing_ms": 0.1424533454761953, "mean_env_wait_ms": 3.1152871746287105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007416963577270508, "StateBufferConnector_ms": 0.0054569244384765625, "ViewRequirementAgentConnector_ms": 0.14522337913513184}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106919, "num_agent_steps_trained": 106919, "num_env_steps_sampled": 106919, "num_env_steps_trained": 106919, "num_env_steps_sampled_this_iter": 2128, "num_env_steps_trained_this_iter": 2128, "num_env_steps_sampled_throughput_per_sec": 218.4729735283465, "num_env_steps_trained_throughput_per_sec": 218.4729735283465, "timesteps_total": 106919, "num_steps_trained_this_iter": 2128, "agent_timesteps_total": 106919, "timers": {"training_iteration_time_ms": 10262.62, "sample_time_ms": 10043.813, "load_time_ms": 0.432, "load_throughput": 4915232.556, "learn_time_ms": 217.959, "learn_throughput": 9740.821, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 106919, "num_env_steps_trained": 106919, "num_agent_steps_sampled": 106919, "num_agent_steps_trained": 106919}, "done": false, "episodes_total": 688, "training_iteration": 50, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-08-17", "timestamp": 1706270897, "time_this_iter_s": 9.741382122039795, "time_total_s": 524.9121799468994, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 524.9121799468994, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 70.72857142857144, "ram_util_percent": 16.007142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2797830265481025, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0003, "total_loss": 7.778717339038849, "policy_loss": -0.002010717522352934, "vf_loss": 9.73231616616249, "vf_explained_var": -0.000771012157201767, "kl": 0.004523608226552213, "entropy": 0.5124886352568865, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1616.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 109164, "num_env_steps_trained": 109164, "num_agent_steps_sampled": 109164, "num_agent_steps_trained": 109164}, "sampler_results": {"episode_reward_max": 253.55152064903245, "episode_reward_min": 79.57742392488315, "episode_reward_mean": 181.55270850448775, "episode_len_mean": 234.76, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386], "episode_lengths": [217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36617282298939413, "mean_inference_ms": 1.1688219872302432, "mean_action_processing_ms": 0.14240436634339204, "mean_env_wait_ms": 3.114178267231351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007575511932373047, "StateBufferConnector_ms": 0.005506753921508789, "ViewRequirementAgentConnector_ms": 0.14492225646972656}}, "episode_reward_max": 253.55152064903245, "episode_reward_min": 79.57742392488315, "episode_reward_mean": 181.55270850448775, "episode_len_mean": 234.76, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [151.19234325281232, 186.35492413158542, 174.96656608045333, 199.5664145243166, 217.40398631623722, 232.46213459009763, 98.33927508317213, 117.29147393228652, 140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386], "episode_lengths": [217, 262, 213, 301, 301, 301, 144, 172, 169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36617282298939413, "mean_inference_ms": 1.1688219872302432, "mean_action_processing_ms": 0.14240436634339204, "mean_env_wait_ms": 3.114178267231351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007575511932373047, "StateBufferConnector_ms": 0.005506753921508789, "ViewRequirementAgentConnector_ms": 0.14492225646972656}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109164, "num_agent_steps_trained": 109164, "num_env_steps_sampled": 109164, "num_env_steps_trained": 109164, "num_env_steps_sampled_this_iter": 2245, "num_env_steps_trained_this_iter": 2245, "num_env_steps_sampled_throughput_per_sec": 205.89714694350548, "num_env_steps_trained_throughput_per_sec": 205.89714694350548, "timesteps_total": 109164, "num_steps_trained_this_iter": 2245, "agent_timesteps_total": 109164, "timers": {"training_iteration_time_ms": 10363.258, "sample_time_ms": 10152.889, "load_time_ms": 0.421, "load_throughput": 5083630.453, "learn_time_ms": 209.543, "learn_throughput": 10210.79, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 109164, "num_env_steps_trained": 109164, "num_agent_steps_sampled": 109164, "num_agent_steps_trained": 109164}, "done": false, "episodes_total": 697, "training_iteration": 51, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-08-28", "timestamp": 1706270908, "time_this_iter_s": 10.904525756835938, "time_total_s": 535.8167057037354, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 535.8167057037354, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 77.25333333333334, "ram_util_percent": 16.179999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19396019587293267, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0003, "total_loss": 7.784357815980911, "policy_loss": -0.039560948964208364, "vf_loss": 9.786396831274033, "vf_explained_var": -0.0003027338534593582, "kl": 0.0026036976648811105, "entropy": 0.5198692912235856, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1648.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 111343, "num_env_steps_trained": 111343, "num_agent_steps_sampled": 111343, "num_agent_steps_trained": 111343}, "sampler_results": {"episode_reward_max": 253.55152064903245, "episode_reward_min": 79.57742392488315, "episode_reward_mean": 185.08928777970092, "episode_len_mean": 237.44, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449], "episode_lengths": [169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36606097187846376, "mean_inference_ms": 1.1686749113449648, "mean_action_processing_ms": 0.14237733026365487, "mean_env_wait_ms": 3.1136605498210264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007439851760864258, "StateBufferConnector_ms": 0.005482673645019531, "ViewRequirementAgentConnector_ms": 0.14531159400939941}}, "episode_reward_max": 253.55152064903245, "episode_reward_min": 79.57742392488315, "episode_reward_mean": 185.08928777970092, "episode_len_mean": 237.44, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [140.65007563061945, 111.08074491785365, 88.8293915113761, 144.03171309395023, 98.4773156727858, 141.68474359030034, 161.81640501313834, 128.04611380877657, 173.33975959387087, 105.44851216453367, 120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449], "episode_lengths": [169, 162, 133, 176, 141, 174, 200, 157, 209, 156, 180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36606097187846376, "mean_inference_ms": 1.1686749113449648, "mean_action_processing_ms": 0.14237733026365487, "mean_env_wait_ms": 3.1136605498210264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007439851760864258, "StateBufferConnector_ms": 0.005482673645019531, "ViewRequirementAgentConnector_ms": 0.14531159400939941}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111343, "num_agent_steps_trained": 111343, "num_env_steps_sampled": 111343, "num_env_steps_trained": 111343, "num_env_steps_sampled_this_iter": 2179, "num_env_steps_trained_this_iter": 2179, "num_env_steps_sampled_throughput_per_sec": 197.27418798431734, "num_env_steps_trained_throughput_per_sec": 197.27418798431734, "timesteps_total": 111343, "num_steps_trained_this_iter": 2179, "agent_timesteps_total": 111343, "timers": {"training_iteration_time_ms": 10520.956, "sample_time_ms": 10310.374, "load_time_ms": 0.425, "load_throughput": 5063544.655, "learn_time_ms": 209.75, "learn_throughput": 10250.789, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 111343, "num_env_steps_trained": 111343, "num_agent_steps_sampled": 111343, "num_agent_steps_trained": 111343}, "done": false, "episodes_total": 705, "training_iteration": 52, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-08-39", "timestamp": 1706270919, "time_this_iter_s": 11.046563148498535, "time_total_s": 546.8632688522339, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 546.8632688522339, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 77.60624999999999, "ram_util_percent": 15.962499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2426902528386563, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0003, "total_loss": 7.777411341667175, "policy_loss": -0.007866460597142577, "vf_loss": 9.738175243139267, "vf_explained_var": -0.0004043634980916977, "kl": 0.0037326795189450562, "entropy": 0.5262453742325306, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1680.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 113541, "num_env_steps_trained": 113541, "num_agent_steps_sampled": 113541, "num_agent_steps_trained": 113541}, "sampler_results": {"episode_reward_max": 253.55152064903245, "episode_reward_min": 79.57742392488315, "episode_reward_mean": 189.98388063753174, "episode_len_mean": 242.65, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347], "episode_lengths": [180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36594545341841106, "mean_inference_ms": 1.1685403629547348, "mean_action_processing_ms": 0.14234623773093164, "mean_env_wait_ms": 3.1133242400953587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007483243942260742, "StateBufferConnector_ms": 0.005545616149902344, "ViewRequirementAgentConnector_ms": 0.14632272720336914}}, "episode_reward_max": 253.55152064903245, "episode_reward_min": 79.57742392488315, "episode_reward_mean": 189.98388063753174, "episode_len_mean": 242.65, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [120.25005855547731, 160.98932479459586, 131.04214542503445, 128.32211124928008, 85.32244318329496, 140.53378504805173, 136.13735131630398, 79.57742392488315, 147.3613129704715, 188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347], "episode_lengths": [180, 195, 191, 157, 121, 165, 166, 119, 176, 225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36594545341841106, "mean_inference_ms": 1.1685403629547348, "mean_action_processing_ms": 0.14234623773093164, "mean_env_wait_ms": 3.1133242400953587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007483243942260742, "StateBufferConnector_ms": 0.005545616149902344, "ViewRequirementAgentConnector_ms": 0.14632272720336914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113541, "num_agent_steps_trained": 113541, "num_env_steps_sampled": 113541, "num_env_steps_trained": 113541, "num_env_steps_sampled_this_iter": 2198, "num_env_steps_trained_this_iter": 2198, "num_env_steps_sampled_throughput_per_sec": 210.1491848372858, "num_env_steps_trained_throughput_per_sec": 210.1491848372858, "timesteps_total": 113541, "num_steps_trained_this_iter": 2198, "agent_timesteps_total": 113541, "timers": {"training_iteration_time_ms": 10320.623, "sample_time_ms": 10101.731, "load_time_ms": 0.453, "load_throughput": 4734400.926, "learn_time_ms": 218.02, "learn_throughput": 9838.532, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 113541, "num_env_steps_trained": 113541, "num_agent_steps_sampled": 113541, "num_agent_steps_trained": 113541}, "done": false, "episodes_total": 715, "training_iteration": 53, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-08-49", "timestamp": 1706270929, "time_this_iter_s": 10.460759401321411, "time_total_s": 557.3240282535553, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 557.3240282535553, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 73.65333333333334, "ram_util_percent": 16.026666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.23050379171036184, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0003, "total_loss": 7.80915866792202, "policy_loss": -0.0017204917967319489, "vf_loss": 9.770134061574936, "vf_explained_var": -0.00032103247940540314, "kl": 0.001755443927389768, "entropy": 0.5228157956153154, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1712.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 115822, "num_env_steps_trained": 115822, "num_agent_steps_sampled": 115822, "num_agent_steps_trained": 115822}, "sampler_results": {"episode_reward_max": 253.55152064903245, "episode_reward_min": 109.97601834754823, "episode_reward_mean": 197.24959710661608, "episode_len_mean": 250.76, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506], "episode_lengths": [225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3657246126167591, "mean_inference_ms": 1.168112302091161, "mean_action_processing_ms": 0.14227741803151692, "mean_env_wait_ms": 3.111775609215316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007570505142211914, "StateBufferConnector_ms": 0.00544285774230957, "ViewRequirementAgentConnector_ms": 0.14472460746765137}}, "episode_reward_max": 253.55152064903245, "episode_reward_min": 109.97601834754823, "episode_reward_mean": 197.24959710661608, "episode_len_mean": 250.76, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [188.39570202999073, 137.49583779641532, 238.38937363660517, 206.98464344054327, 128.13467116763695, 138.65820219688428, 177.86508315107358, 142.26948434105307, 134.50401285663548, 209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506], "episode_lengths": [225, 169, 301, 262, 184, 204, 214, 170, 198, 259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3657246126167591, "mean_inference_ms": 1.168112302091161, "mean_action_processing_ms": 0.14227741803151692, "mean_env_wait_ms": 3.111775609215316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007570505142211914, "StateBufferConnector_ms": 0.00544285774230957, "ViewRequirementAgentConnector_ms": 0.14472460746765137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115822, "num_agent_steps_trained": 115822, "num_env_steps_sampled": 115822, "num_env_steps_trained": 115822, "num_env_steps_sampled_this_iter": 2281, "num_env_steps_trained_this_iter": 2281, "num_env_steps_sampled_throughput_per_sec": 226.4389740196082, "num_env_steps_trained_throughput_per_sec": 226.4389740196082, "timesteps_total": 115822, "num_steps_trained_this_iter": 2281, "agent_timesteps_total": 115822, "timers": {"training_iteration_time_ms": 10259.56, "sample_time_ms": 10039.743, "load_time_ms": 0.447, "load_throughput": 4826034.256, "learn_time_ms": 218.949, "learn_throughput": 9849.768, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 115822, "num_env_steps_trained": 115822, "num_agent_steps_sampled": 115822, "num_agent_steps_trained": 115822}, "done": false, "episodes_total": 724, "training_iteration": 54, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-08-59", "timestamp": 1706270939, "time_this_iter_s": 10.07444977760315, "time_total_s": 567.3984780311584, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 567.3984780311584, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 68.55714285714286, "ram_util_percent": 16.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.26709326077252626, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0003, "total_loss": 7.784933194518089, "policy_loss": -0.012624149210751057, "vf_loss": 9.753544300794601, "vf_explained_var": -0.0007779281586408615, "kl": 0.005100533227270887, "entropy": 0.5278039909899235, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1744.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 118003, "num_env_steps_trained": 118003, "num_agent_steps_sampled": 118003, "num_agent_steps_trained": 118003}, "sampler_results": {"episode_reward_max": 253.55152064903245, "episode_reward_min": 109.97601834754823, "episode_reward_mean": 199.82828543810137, "episode_len_mean": 253.3, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084], "episode_lengths": [259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3654725024145993, "mean_inference_ms": 1.167600462512216, "mean_action_processing_ms": 0.14219666084176244, "mean_env_wait_ms": 3.109882936149091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074901580810546875, "StateBufferConnector_ms": 0.005454301834106445, "ViewRequirementAgentConnector_ms": 0.14494991302490234}}, "episode_reward_max": 253.55152064903245, "episode_reward_min": 109.97601834754823, "episode_reward_mean": 199.82828543810137, "episode_len_mean": 253.3, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [209.3433599735473, 120.20643260798482, 215.27374252610718, 159.80456235062695, 195.12636178564458, 129.21260168293352, 183.34483962624066, 220.27746122077244, 227.75018693859758, 212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084], "episode_lengths": [259, 179, 265, 196, 273, 182, 229, 301, 282, 301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3654725024145993, "mean_inference_ms": 1.167600462512216, "mean_action_processing_ms": 0.14219666084176244, "mean_env_wait_ms": 3.109882936149091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074901580810546875, "StateBufferConnector_ms": 0.005454301834106445, "ViewRequirementAgentConnector_ms": 0.14494991302490234}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118003, "num_agent_steps_trained": 118003, "num_env_steps_sampled": 118003, "num_env_steps_trained": 118003, "num_env_steps_sampled_this_iter": 2181, "num_env_steps_trained_this_iter": 2181, "num_env_steps_sampled_throughput_per_sec": 204.3429571353618, "num_env_steps_trained_throughput_per_sec": 204.3429571353618, "timesteps_total": 118003, "num_steps_trained_this_iter": 2181, "agent_timesteps_total": 118003, "timers": {"training_iteration_time_ms": 10247.669, "sample_time_ms": 10028.019, "load_time_ms": 0.443, "load_throughput": 4874296.497, "learn_time_ms": 218.79, "learn_throughput": 9858.333, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 118003, "num_env_steps_trained": 118003, "num_agent_steps_sampled": 118003, "num_agent_steps_trained": 118003}, "done": false, "episodes_total": 733, "training_iteration": 55, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-09-10", "timestamp": 1706270950, "time_this_iter_s": 10.674436092376709, "time_total_s": 578.0729141235352, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 578.0729141235352, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 76.38749999999999, "ram_util_percent": 16.09375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.192971603712067, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0003, "total_loss": 7.7960503697395325, "policy_loss": -0.01869593033916317, "vf_loss": 9.77513012290001, "vf_explained_var": 4.829280078411102e-05, "kl": 0.001252908400999786, "entropy": 0.5357931405305862, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1776.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 120158, "num_env_steps_trained": 120158, "num_agent_steps_sampled": 120158, "num_agent_steps_trained": 120158}, "sampler_results": {"episode_reward_max": 253.55152064903245, "episode_reward_min": 109.97601834754823, "episode_reward_mean": 200.99502821464762, "episode_len_mean": 253.19, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107], "episode_lengths": [301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36521911464790036, "mean_inference_ms": 1.1670945666678054, "mean_action_processing_ms": 0.14211779884622824, "mean_env_wait_ms": 3.1079800083769134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007475376129150391, "StateBufferConnector_ms": 0.0054547786712646484, "ViewRequirementAgentConnector_ms": 0.14457345008850098}}, "episode_reward_max": 253.55152064903245, "episode_reward_min": 109.97601834754823, "episode_reward_mean": 200.99502821464762, "episode_len_mean": 253.19, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [212.42585045385522, 237.56745587824483, 178.04917090894924, 109.97601834754823, 124.68373841638423, 177.67587038602943, 133.33627232360402, 219.47426014381392, 197.90297853611244, 208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107], "episode_lengths": [301, 301, 257, 168, 188, 216, 164, 263, 231, 301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36521911464790036, "mean_inference_ms": 1.1670945666678054, "mean_action_processing_ms": 0.14211779884622824, "mean_env_wait_ms": 3.1079800083769134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007475376129150391, "StateBufferConnector_ms": 0.0054547786712646484, "ViewRequirementAgentConnector_ms": 0.14457345008850098}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120158, "num_agent_steps_trained": 120158, "num_env_steps_sampled": 120158, "num_env_steps_trained": 120158, "num_env_steps_sampled_this_iter": 2155, "num_env_steps_trained_this_iter": 2155, "num_env_steps_sampled_throughput_per_sec": 203.61490683957393, "num_env_steps_trained_throughput_per_sec": 203.61490683957393, "timesteps_total": 120158, "num_steps_trained_this_iter": 2155, "agent_timesteps_total": 120158, "timers": {"training_iteration_time_ms": 10410.582, "sample_time_ms": 10190.623, "load_time_ms": 0.44, "load_throughput": 4914703.193, "learn_time_ms": 219.1, "learn_throughput": 9876.78, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 120158, "num_env_steps_trained": 120158, "num_agent_steps_sampled": 120158, "num_agent_steps_trained": 120158}, "done": false, "episodes_total": 742, "training_iteration": 56, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-09-21", "timestamp": 1706270961, "time_this_iter_s": 10.584716558456421, "time_total_s": 588.6576306819916, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 588.6576306819916, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 77.50666666666666, "ram_util_percent": 16.053333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2223926445003599, "cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 0.0003, "total_loss": 7.793959766626358, "policy_loss": -0.009172059770207852, "vf_loss": 9.760528177022934, "vf_explained_var": 0.00046342238783836365, "kl": 0.003133863680545801, "entropy": 0.529065465554595, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1808.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 122349, "num_env_steps_trained": 122349, "num_agent_steps_sampled": 122349, "num_agent_steps_trained": 122349}, "sampler_results": {"episode_reward_max": 253.55152064903245, "episode_reward_min": 124.25112496196517, "episode_reward_mean": 203.04143014048623, "episode_len_mean": 254.21, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442], "episode_lengths": [301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36500821843470327, "mean_inference_ms": 1.1666587441624687, "mean_action_processing_ms": 0.1420452986498009, "mean_env_wait_ms": 3.1070900185348362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007433414459228516, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.14479851722717285}}, "episode_reward_max": 253.55152064903245, "episode_reward_min": 124.25112496196517, "episode_reward_mean": 203.04143014048623, "episode_len_mean": 254.21, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [208.5038455647658, 243.59337963402479, 228.0496259723356, 171.13954998357656, 160.78086921649552, 240.25907580943144, 211.96036286754187, 215.91952833336595, 217.68827731930736, 215.04592801588734, 221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442], "episode_lengths": [301, 301, 280, 207, 200, 301, 249, 267, 301, 257, 301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36500821843470327, "mean_inference_ms": 1.1666587441624687, "mean_action_processing_ms": 0.1420452986498009, "mean_env_wait_ms": 3.1070900185348362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007433414459228516, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.14479851722717285}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122349, "num_agent_steps_trained": 122349, "num_env_steps_sampled": 122349, "num_env_steps_trained": 122349, "num_env_steps_sampled_this_iter": 2191, "num_env_steps_trained_this_iter": 2191, "num_env_steps_sampled_throughput_per_sec": 182.10086325175865, "num_env_steps_trained_throughput_per_sec": 182.10086325175865, "timesteps_total": 122349, "num_steps_trained_this_iter": 2191, "agent_timesteps_total": 122349, "timers": {"training_iteration_time_ms": 10583.091, "sample_time_ms": 10356.373, "load_time_ms": 0.46, "load_throughput": 4726006.942, "learn_time_ms": 225.83, "learn_throughput": 9631.136, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 122349, "num_env_steps_trained": 122349, "num_agent_steps_sampled": 122349, "num_agent_steps_trained": 122349}, "done": false, "episodes_total": 751, "training_iteration": 57, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-09-33", "timestamp": 1706270973, "time_this_iter_s": 12.033409357070923, "time_total_s": 600.6910400390625, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 600.6910400390625, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 78.45294117647059, "ram_util_percent": 16.011764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.22270299261435866, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0003, "total_loss": 7.7821991592645645, "policy_loss": -0.004485342069528997, "vf_loss": 9.7399662733078, "vf_explained_var": -3.723613917827606e-05, "kl": 0.0009189120626250935, "entropy": 0.5288415718823671, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1840.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 124537, "num_env_steps_trained": 124537, "num_agent_steps_sampled": 124537, "num_agent_steps_trained": 124537}, "sampler_results": {"episode_reward_max": 253.55152064903245, "episode_reward_min": 124.25112496196517, "episode_reward_mean": 200.0259008900037, "episode_len_mean": 249.45, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539], "episode_lengths": [301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36480785005959165, "mean_inference_ms": 1.1662551435347688, "mean_action_processing_ms": 0.14197879378206008, "mean_env_wait_ms": 3.106344635000777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007406949996948242, "StateBufferConnector_ms": 0.005441904067993164, "ViewRequirementAgentConnector_ms": 0.14434361457824707}}, "episode_reward_max": 253.55152064903245, "episode_reward_min": 124.25112496196517, "episode_reward_mean": 200.0259008900037, "episode_len_mean": 249.45, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [221.89472272676446, 249.009585812349, 157.18398634382393, 179.36642587722926, 164.7656586619006, 231.89104160611518, 201.55326490057126, 208.28786314495287, 212.28721221361477, 179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539], "episode_lengths": [301, 301, 192, 213, 198, 301, 292, 301, 301, 259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36480785005959165, "mean_inference_ms": 1.1662551435347688, "mean_action_processing_ms": 0.14197879378206008, "mean_env_wait_ms": 3.106344635000777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007406949996948242, "StateBufferConnector_ms": 0.005441904067993164, "ViewRequirementAgentConnector_ms": 0.14434361457824707}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124537, "num_agent_steps_trained": 124537, "num_env_steps_sampled": 124537, "num_env_steps_trained": 124537, "num_env_steps_sampled_this_iter": 2188, "num_env_steps_trained_this_iter": 2188, "num_env_steps_sampled_throughput_per_sec": 216.94244726051195, "num_env_steps_trained_throughput_per_sec": 216.94244726051195, "timesteps_total": 124537, "num_steps_trained_this_iter": 2188, "agent_timesteps_total": 124537, "timers": {"training_iteration_time_ms": 10533.179, "sample_time_ms": 10293.73, "load_time_ms": 0.487, "load_throughput": 4473650.599, "learn_time_ms": 238.521, "learn_throughput": 9137.983, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 124537, "num_env_steps_trained": 124537, "num_agent_steps_sampled": 124537, "num_agent_steps_trained": 124537}, "done": false, "episodes_total": 761, "training_iteration": 58, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-09-43", "timestamp": 1706270983, "time_this_iter_s": 10.087280035018921, "time_total_s": 610.7783200740814, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 610.7783200740814, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 72.79333333333334, "ram_util_percent": 16.106666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2386579185258597, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0003, "total_loss": 7.766025170683861, "policy_loss": -0.020404352366313105, "vf_loss": 9.739562571048737, "vf_explained_var": -0.0002549700438976288, "kl": 0.002504156175580974, "entropy": 0.5220552310347557, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1872.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 126594, "num_env_steps_trained": 126594, "num_agent_steps_sampled": 126594, "num_agent_steps_trained": 126594}, "sampler_results": {"episode_reward_max": 253.55152064903245, "episode_reward_min": 124.25112496196517, "episode_reward_mean": 198.71208006377776, "episode_len_mean": 246.02, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045], "episode_lengths": [259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3646575181913759, "mean_inference_ms": 1.1659990468422654, "mean_action_processing_ms": 0.141932444233486, "mean_env_wait_ms": 3.1059220560787866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074388980865478516, "StateBufferConnector_ms": 0.0055179595947265625, "ViewRequirementAgentConnector_ms": 0.14593791961669922}}, "episode_reward_max": 253.55152064903245, "episode_reward_min": 124.25112496196517, "episode_reward_mean": 198.71208006377776, "episode_len_mean": 246.02, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [179.76278707779412, 152.99425475495283, 253.51896700770263, 230.1778429420672, 242.17542985875264, 251.67393754649012, 225.5238269767489, 233.1640919433227, 229.17699384940602, 218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045], "episode_lengths": [259, 189, 301, 301, 301, 295, 301, 284, 301, 267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3646575181913759, "mean_inference_ms": 1.1659990468422654, "mean_action_processing_ms": 0.141932444233486, "mean_env_wait_ms": 3.1059220560787866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074388980865478516, "StateBufferConnector_ms": 0.0055179595947265625, "ViewRequirementAgentConnector_ms": 0.14593791961669922}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126594, "num_agent_steps_trained": 126594, "num_env_steps_sampled": 126594, "num_env_steps_trained": 126594, "num_env_steps_sampled_this_iter": 2057, "num_env_steps_trained_this_iter": 2057, "num_env_steps_sampled_throughput_per_sec": 191.2509991945794, "num_env_steps_trained_throughput_per_sec": 191.2509991945794, "timesteps_total": 126594, "num_steps_trained_this_iter": 2057, "agent_timesteps_total": 126594, "timers": {"training_iteration_time_ms": 10635.15, "sample_time_ms": 10402.233, "load_time_ms": 0.461, "load_throughput": 4725527.6, "learn_time_ms": 232.026, "learn_throughput": 9396.79, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 126594, "num_env_steps_trained": 126594, "num_agent_steps_sampled": 126594, "num_agent_steps_trained": 126594}, "done": false, "episodes_total": 770, "training_iteration": 59, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-09-54", "timestamp": 1706270994, "time_this_iter_s": 10.75683331489563, "time_total_s": 621.535153388977, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 621.535153388977, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 78.59333333333335, "ram_util_percent": 16.040000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16828205378260463, "cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0003, "total_loss": 7.798013657331467, "policy_loss": -0.010144448257051408, "vf_loss": 9.766932100057602, "vf_explained_var": -0.0002680160105228424, "kl": 0.002537115259824377, "entropy": 0.538778118789196, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1904.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 128788, "num_env_steps_trained": 128788, "num_agent_steps_sampled": 128788, "num_agent_steps_trained": 128788}, "sampler_results": {"episode_reward_max": 253.55152064903245, "episode_reward_min": 124.25112496196517, "episode_reward_mean": 196.6300656440066, "episode_len_mean": 242.64, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996], "episode_lengths": [267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36453143839399005, "mean_inference_ms": 1.165796815605401, "mean_action_processing_ms": 0.14189331847171346, "mean_env_wait_ms": 3.1056765965223576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007395267486572266, "StateBufferConnector_ms": 0.005529880523681641, "ViewRequirementAgentConnector_ms": 0.14723801612854004}}, "episode_reward_max": 253.55152064903245, "episode_reward_min": 124.25112496196517, "episode_reward_mean": 196.6300656440066, "episode_len_mean": 242.64, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [218.8081969197399, 144.61720205417666, 234.6993834642706, 188.94622760932123, 253.55152064903245, 188.4238531230797, 236.3340018077192, 218.18932478809128, 208.21126034368356, 156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996], "episode_lengths": [267, 171, 301, 225, 300, 228, 301, 301, 301, 188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36453143839399005, "mean_inference_ms": 1.165796815605401, "mean_action_processing_ms": 0.14189331847171346, "mean_env_wait_ms": 3.1056765965223576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007395267486572266, "StateBufferConnector_ms": 0.005529880523681641, "ViewRequirementAgentConnector_ms": 0.14723801612854004}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128788, "num_agent_steps_trained": 128788, "num_env_steps_sampled": 128788, "num_env_steps_trained": 128788, "num_env_steps_sampled_this_iter": 2194, "num_env_steps_trained_this_iter": 2194, "num_env_steps_sampled_throughput_per_sec": 202.2763534198877, "num_env_steps_trained_throughput_per_sec": 202.2763534198877, "timesteps_total": 128788, "num_steps_trained_this_iter": 2194, "agent_timesteps_total": 128788, "timers": {"training_iteration_time_ms": 10745.771, "sample_time_ms": 10510.896, "load_time_ms": 0.455, "load_throughput": 4806394.581, "learn_time_ms": 233.987, "learn_throughput": 9346.229, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 128788, "num_env_steps_trained": 128788, "num_agent_steps_sampled": 128788, "num_agent_steps_trained": 128788}, "done": false, "episodes_total": 779, "training_iteration": 60, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-10-05", "timestamp": 1706271005, "time_this_iter_s": 10.847647428512573, "time_total_s": 632.3828008174896, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 632.3828008174896, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 76.58125000000001, "ram_util_percent": 16.01875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.22126363799907267, "cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0003, "total_loss": 7.78900820016861, "policy_loss": -0.020115643768804148, "vf_loss": 9.768200993537903, "vf_explained_var": -0.0003977809101343155, "kl": 0.0013507411141615577, "entropy": 0.5437034144997597, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1936.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 130943, "num_env_steps_trained": 130943, "num_agent_steps_sampled": 130943, "num_agent_steps_trained": 130943}, "sampler_results": {"episode_reward_max": 253.17453990096286, "episode_reward_min": 124.06078633967799, "episode_reward_mean": 195.72703013606454, "episode_len_mean": 240.24, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286], "episode_lengths": [188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36444790512110337, "mean_inference_ms": 1.1657338936800494, "mean_action_processing_ms": 0.1418726616481708, "mean_env_wait_ms": 3.1059311536849434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007063150405883789, "StateBufferConnector_ms": 0.005486011505126953, "ViewRequirementAgentConnector_ms": 0.14519500732421875}}, "episode_reward_max": 253.17453990096286, "episode_reward_min": 124.06078633967799, "episode_reward_mean": 195.72703013606454, "episode_len_mean": 240.24, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [156.04098848337807, 170.7909501316256, 173.328465163521, 183.21169197956402, 215.3387954176141, 202.72761416739385, 206.93917845891508, 229.49361867293024, 243.62421715403386, 237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286], "episode_lengths": [188, 204, 206, 215, 301, 247, 301, 282, 301, 286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36444790512110337, "mean_inference_ms": 1.1657338936800494, "mean_action_processing_ms": 0.1418726616481708, "mean_env_wait_ms": 3.1059311536849434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007063150405883789, "StateBufferConnector_ms": 0.005486011505126953, "ViewRequirementAgentConnector_ms": 0.14519500732421875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130943, "num_agent_steps_trained": 130943, "num_env_steps_sampled": 130943, "num_env_steps_trained": 130943, "num_env_steps_sampled_this_iter": 2155, "num_env_steps_trained_this_iter": 2155, "num_env_steps_sampled_throughput_per_sec": 202.33933501826974, "num_env_steps_trained_throughput_per_sec": 202.33933501826974, "timesteps_total": 130943, "num_steps_trained_this_iter": 2155, "agent_timesteps_total": 130943, "timers": {"training_iteration_time_ms": 10720.463, "sample_time_ms": 10486.041, "load_time_ms": 0.452, "load_throughput": 4820207.209, "learn_time_ms": 233.542, "learn_throughput": 9325.527, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 130943, "num_env_steps_trained": 130943, "num_agent_steps_sampled": 130943, "num_agent_steps_trained": 130943}, "done": false, "episodes_total": 788, "training_iteration": 61, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-10-16", "timestamp": 1706271016, "time_this_iter_s": 10.651438474655151, "time_total_s": 643.0342392921448, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 643.0342392921448, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 77.39333333333333, "ram_util_percent": 16.059999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1668345183134079, "cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 0.0003, "total_loss": 7.766698703169823, "policy_loss": -0.03401401831069961, "vf_loss": 9.757897943258286, "vf_explained_var": -0.00016336143016815186, "kl": 0.0027790858098071178, "entropy": 0.5605830922722816, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 1968.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 133025, "num_env_steps_trained": 133025, "num_agent_steps_sampled": 133025, "num_agent_steps_trained": 133025}, "sampler_results": {"episode_reward_max": 253.17453990096286, "episode_reward_min": 106.56244482248171, "episode_reward_mean": 195.19591268331814, "episode_len_mean": 238.61, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782], "episode_lengths": [286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.364338954071774, "mean_inference_ms": 1.1655223689807708, "mean_action_processing_ms": 0.14183557315699566, "mean_env_wait_ms": 3.1056432372201868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069026947021484375, "StateBufferConnector_ms": 0.005382061004638672, "ViewRequirementAgentConnector_ms": 0.1438753604888916}}, "episode_reward_max": 253.17453990096286, "episode_reward_min": 106.56244482248171, "episode_reward_mean": 195.19591268331814, "episode_len_mean": 238.61, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [237.01886835870684, 172.9088143960441, 222.68651114045463, 211.10991107657787, 244.1190268269146, 194.04222253066493, 227.92451218985252, 221.42517891306449, 155.389587530568, 240.10193315448777, 129.11817107877394, 153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782], "episode_lengths": [286, 205, 301, 254, 301, 230, 301, 301, 186, 301, 153, 182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.364338954071774, "mean_inference_ms": 1.1655223689807708, "mean_action_processing_ms": 0.14183557315699566, "mean_env_wait_ms": 3.1056432372201868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069026947021484375, "StateBufferConnector_ms": 0.005382061004638672, "ViewRequirementAgentConnector_ms": 0.1438753604888916}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 133025, "num_agent_steps_trained": 133025, "num_env_steps_sampled": 133025, "num_env_steps_trained": 133025, "num_env_steps_sampled_this_iter": 2082, "num_env_steps_trained_this_iter": 2082, "num_env_steps_sampled_throughput_per_sec": 233.51029746839657, "num_env_steps_trained_throughput_per_sec": 233.51029746839657, "timesteps_total": 133025, "num_steps_trained_this_iter": 2082, "agent_timesteps_total": 133025, "timers": {"training_iteration_time_ms": 10507.518, "sample_time_ms": 10275.238, "load_time_ms": 0.459, "load_throughput": 4727395.089, "learn_time_ms": 231.394, "learn_throughput": 9370.169, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 133025, "num_env_steps_trained": 133025, "num_agent_steps_sampled": 133025, "num_agent_steps_trained": 133025}, "done": false, "episodes_total": 797, "training_iteration": 62, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-10-25", "timestamp": 1706271025, "time_this_iter_s": 8.917531251907349, "time_total_s": 651.9517705440521, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 651.9517705440521, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 64.4923076923077, "ram_util_percent": 16.03076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1828766092658043, "cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 0.0003, "total_loss": 7.756670489907265, "policy_loss": 0.0018606634112074971, "vf_loss": 9.700506389141083, "vf_explained_var": 0.00018519163131713867, "kl": 0.0021518617111605104, "entropy": 0.5595132727175951, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2000.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 135346, "num_env_steps_trained": 135346, "num_agent_steps_sampled": 135346, "num_agent_steps_trained": 135346}, "sampler_results": {"episode_reward_max": 253.17453990096286, "episode_reward_min": 102.42332477594509, "episode_reward_mean": 191.701609220943, "episode_len_mean": 233.63, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996], "episode_lengths": [182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36422635746626425, "mean_inference_ms": 1.1652097239765034, "mean_action_processing_ms": 0.1417876904873296, "mean_env_wait_ms": 3.105063526075895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007055759429931641, "StateBufferConnector_ms": 0.00540614128112793, "ViewRequirementAgentConnector_ms": 0.1438891887664795}}, "episode_reward_max": 253.17453990096286, "episode_reward_min": 102.42332477594509, "episode_reward_mean": 191.701609220943, "episode_len_mean": 233.63, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [153.47139745441805, 124.25112496196517, 187.16711772306974, 162.3609765904625, 222.93620820610084, 238.92379732010377, 169.1437467603347, 232.6656772953935, 214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996], "episode_lengths": [182, 150, 228, 195, 301, 301, 201, 281, 262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36422635746626425, "mean_inference_ms": 1.1652097239765034, "mean_action_processing_ms": 0.1417876904873296, "mean_env_wait_ms": 3.105063526075895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007055759429931641, "StateBufferConnector_ms": 0.00540614128112793, "ViewRequirementAgentConnector_ms": 0.1438891887664795}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135346, "num_agent_steps_trained": 135346, "num_env_steps_sampled": 135346, "num_env_steps_trained": 135346, "num_env_steps_sampled_this_iter": 2321, "num_env_steps_trained_this_iter": 2321, "num_env_steps_sampled_throughput_per_sec": 204.87962594857783, "num_env_steps_trained_throughput_per_sec": 204.87962594857783, "timesteps_total": 135346, "num_steps_trained_this_iter": 2321, "agent_timesteps_total": 135346, "timers": {"training_iteration_time_ms": 10594.455, "sample_time_ms": 10370.775, "load_time_ms": 0.43, "load_throughput": 5075575.71, "learn_time_ms": 222.836, "learn_throughput": 9785.223, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 135346, "num_env_steps_trained": 135346, "num_agent_steps_sampled": 135346, "num_agent_steps_trained": 135346}, "done": false, "episodes_total": 808, "training_iteration": 63, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-10-36", "timestamp": 1706271036, "time_this_iter_s": 11.329663276672363, "time_total_s": 663.2814338207245, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 663.2814338207245, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 76.79375, "ram_util_percent": 16.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19804734853096306, "cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 0.0003, "total_loss": 7.788118064403534, "policy_loss": -0.035395052400417626, "vf_loss": 9.78631603717804, "vf_explained_var": -0.00040199048817157745, "kl": 0.0029372807246375032, "entropy": 0.5539778545498848, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2032.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 137490, "num_env_steps_trained": 137490, "num_agent_steps_sampled": 137490, "num_agent_steps_trained": 137490}, "sampler_results": {"episode_reward_max": 253.17453990096286, "episode_reward_min": 102.42332477594509, "episode_reward_mean": 194.2734290612971, "episode_len_mean": 236.68, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526], "episode_lengths": [262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36417046119934, "mean_inference_ms": 1.1650397732409532, "mean_action_processing_ms": 0.1417629684822772, "mean_env_wait_ms": 3.104892888371913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00903773307800293, "StateBufferConnector_ms": 0.005353212356567383, "ViewRequirementAgentConnector_ms": 0.14300107955932617}}, "episode_reward_max": 253.17453990096286, "episode_reward_min": 102.42332477594509, "episode_reward_mean": 194.2734290612971, "episode_len_mean": 236.68, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [214.13707969752772, 236.08929433802228, 158.76753720722272, 172.2658451583227, 241.2250232620484, 140.28330737586862, 246.82529123291377, 213.848547808506, 231.24938620711328, 156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526], "episode_lengths": [262, 301, 193, 211, 301, 169, 300, 263, 301, 190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36417046119934, "mean_inference_ms": 1.1650397732409532, "mean_action_processing_ms": 0.1417629684822772, "mean_env_wait_ms": 3.104892888371913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00903773307800293, "StateBufferConnector_ms": 0.005353212356567383, "ViewRequirementAgentConnector_ms": 0.14300107955932617}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137490, "num_agent_steps_trained": 137490, "num_env_steps_sampled": 137490, "num_env_steps_trained": 137490, "num_env_steps_sampled_this_iter": 2144, "num_env_steps_trained_this_iter": 2144, "num_env_steps_sampled_throughput_per_sec": 202.76579486155342, "num_env_steps_trained_throughput_per_sec": 202.76579486155342, "timesteps_total": 137490, "num_steps_trained_this_iter": 2144, "agent_timesteps_total": 137490, "timers": {"training_iteration_time_ms": 10644.496, "sample_time_ms": 10421.065, "load_time_ms": 0.439, "load_throughput": 4937638.763, "learn_time_ms": 222.577, "learn_throughput": 9735.079, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 137490, "num_env_steps_trained": 137490, "num_agent_steps_sampled": 137490, "num_agent_steps_trained": 137490}, "done": false, "episodes_total": 816, "training_iteration": 64, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-10-46", "timestamp": 1706271046, "time_this_iter_s": 10.574823141098022, "time_total_s": 673.8562569618225, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 673.8562569618225, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 77.52, "ram_util_percent": 16.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.24737944500520825, "cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 0.0003, "total_loss": 7.784978926181793, "policy_loss": -0.0035804111103061587, "vf_loss": 9.742723107337952, "vf_explained_var": -0.0003406442701816559, "kl": 0.0019134084959236894, "entropy": 0.5619134064763784, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2064.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 139739, "num_env_steps_trained": 139739, "num_agent_steps_sampled": 139739, "num_agent_steps_trained": 139739}, "sampler_results": {"episode_reward_max": 253.17453990096286, "episode_reward_min": 102.42332477594509, "episode_reward_mean": 194.28651271961434, "episode_len_mean": 236.16, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055], "episode_lengths": [190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3641663110510116, "mean_inference_ms": 1.1650036827720274, "mean_action_processing_ms": 0.1417543314192803, "mean_env_wait_ms": 3.1052677060197005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008899688720703125, "StateBufferConnector_ms": 0.005448341369628906, "ViewRequirementAgentConnector_ms": 0.14347434043884277}}, "episode_reward_max": 253.17453990096286, "episode_reward_min": 102.42332477594509, "episode_reward_mean": 194.28651271961434, "episode_len_mean": 236.16, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [156.95263636401123, 227.33600271288418, 219.84767087756987, 194.71507208094914, 180.20173194366225, 215.62353356569474, 173.0455579753989, 151.594252038084, 200.10443902227018, 242.88257356689866, 225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055], "episode_lengths": [190, 274, 269, 237, 219, 301, 210, 180, 243, 299, 275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3641663110510116, "mean_inference_ms": 1.1650036827720274, "mean_action_processing_ms": 0.1417543314192803, "mean_env_wait_ms": 3.1052677060197005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008899688720703125, "StateBufferConnector_ms": 0.005448341369628906, "ViewRequirementAgentConnector_ms": 0.14347434043884277}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139739, "num_agent_steps_trained": 139739, "num_env_steps_sampled": 139739, "num_env_steps_trained": 139739, "num_env_steps_sampled_this_iter": 2249, "num_env_steps_trained_this_iter": 2249, "num_env_steps_sampled_throughput_per_sec": 202.88063493083564, "num_env_steps_trained_throughput_per_sec": 202.88063493083564, "timesteps_total": 139739, "num_steps_trained_this_iter": 2249, "agent_timesteps_total": 139739, "timers": {"training_iteration_time_ms": 10685.707, "sample_time_ms": 10462.526, "load_time_ms": 0.443, "load_throughput": 4905164.734, "learn_time_ms": 222.32, "learn_throughput": 9776.903, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 139739, "num_env_steps_trained": 139739, "num_agent_steps_sampled": 139739, "num_agent_steps_trained": 139739}, "done": false, "episodes_total": 825, "training_iteration": 65, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-10-58", "timestamp": 1706271058, "time_this_iter_s": 11.086429595947266, "time_total_s": 684.9426865577698, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 684.9426865577698, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 76.5875, "ram_util_percent": 16.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.27110679005272686, "cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 0.0003, "total_loss": 7.7586371302604675, "policy_loss": 0.008179725497029722, "vf_loss": 9.694804549217224, "vf_explained_var": -0.0006245188415050507, "kl": 0.0028957179581914905, "entropy": 0.5386237800121307, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2096.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 142016, "num_env_steps_trained": 142016, "num_agent_steps_sampled": 142016, "num_agent_steps_trained": 142016}, "sampler_results": {"episode_reward_max": 253.17453990096286, "episode_reward_min": 102.42332477594509, "episode_reward_mean": 193.01229345025655, "episode_len_mean": 234.71, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992], "episode_lengths": [275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36413305798444284, "mean_inference_ms": 1.1648497979265522, "mean_action_processing_ms": 0.1417308588521851, "mean_env_wait_ms": 3.105217909745128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008927345275878906, "StateBufferConnector_ms": 0.005453824996948242, "ViewRequirementAgentConnector_ms": 0.14320158958435059}}, "episode_reward_max": 253.17453990096286, "episode_reward_min": 102.42332477594509, "episode_reward_mean": 193.01229345025655, "episode_len_mean": 234.71, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [225.53347716332547, 191.00981830847635, 215.64111266283393, 148.77570287817545, 160.14436568434485, 199.2040925020749, 193.71824457868107, 221.39165271568493, 244.1529681922607, 158.45827532898616, 157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992], "episode_lengths": [275, 230, 261, 179, 192, 242, 234, 264, 301, 189, 189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36413305798444284, "mean_inference_ms": 1.1648497979265522, "mean_action_processing_ms": 0.1417308588521851, "mean_env_wait_ms": 3.105217909745128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008927345275878906, "StateBufferConnector_ms": 0.005453824996948242, "ViewRequirementAgentConnector_ms": 0.14320158958435059}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142016, "num_agent_steps_trained": 142016, "num_env_steps_sampled": 142016, "num_env_steps_trained": 142016, "num_env_steps_sampled_this_iter": 2277, "num_env_steps_trained_this_iter": 2277, "num_env_steps_sampled_throughput_per_sec": 219.24676788003688, "num_env_steps_trained_throughput_per_sec": 219.24676788003688, "timesteps_total": 142016, "num_steps_trained_this_iter": 2277, "agent_timesteps_total": 142016, "timers": {"training_iteration_time_ms": 10665.892, "sample_time_ms": 10431.007, "load_time_ms": 0.466, "load_throughput": 4685633.079, "learn_time_ms": 233.985, "learn_throughput": 9341.61, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 142016, "num_env_steps_trained": 142016, "num_agent_steps_sampled": 142016, "num_agent_steps_trained": 142016}, "done": false, "episodes_total": 835, "training_iteration": 66, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-11-08", "timestamp": 1706271068, "time_this_iter_s": 10.387098789215088, "time_total_s": 695.3297853469849, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 695.3297853469849, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 68.54, "ram_util_percent": 16.179999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2955943578854203, "cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 0.0003, "total_loss": 7.698609784245491, "policy_loss": -0.029221937402326148, "vf_loss": 9.666376650333405, "vf_explained_var": 0.001402122899889946, "kl": 0.0011382778817363715, "entropy": 0.5269593670964241, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2128.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 144106, "num_env_steps_trained": 144106, "num_agent_steps_sampled": 144106, "num_agent_steps_trained": 144106}, "sampler_results": {"episode_reward_max": 253.17453990096286, "episode_reward_min": 71.45066168227285, "episode_reward_mean": 190.09467215309832, "episode_len_mean": 231.94, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808], "episode_lengths": [189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3640728072186156, "mean_inference_ms": 1.1646561279995953, "mean_action_processing_ms": 0.14170499300371053, "mean_env_wait_ms": 3.1047510127619966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009018659591674805, "StateBufferConnector_ms": 0.005440473556518555, "ViewRequirementAgentConnector_ms": 0.14326071739196777}}, "episode_reward_max": 253.17453990096286, "episode_reward_min": 71.45066168227285, "episode_reward_mean": 190.09467215309832, "episode_len_mean": 231.94, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [157.4265517401925, 198.3574436722966, 227.62765522402105, 185.1346719570413, 152.22174731056404, 250.96084183735442, 158.48645232993135, 187.31932781176226, 169.23324560327345, 154.8324712451716, 131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808], "episode_lengths": [189, 239, 301, 226, 181, 301, 189, 232, 203, 190, 157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3640728072186156, "mean_inference_ms": 1.1646561279995953, "mean_action_processing_ms": 0.14170499300371053, "mean_env_wait_ms": 3.1047510127619966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009018659591674805, "StateBufferConnector_ms": 0.005440473556518555, "ViewRequirementAgentConnector_ms": 0.14326071739196777}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144106, "num_agent_steps_trained": 144106, "num_env_steps_sampled": 144106, "num_env_steps_trained": 144106, "num_env_steps_sampled_this_iter": 2090, "num_env_steps_trained_this_iter": 2090, "num_env_steps_sampled_throughput_per_sec": 208.72725097724054, "num_env_steps_trained_throughput_per_sec": 208.72725097724054, "timesteps_total": 144106, "num_steps_trained_this_iter": 2090, "agent_timesteps_total": 144106, "timers": {"training_iteration_time_ms": 10464.02, "sample_time_ms": 10235.598, "load_time_ms": 0.451, "load_throughput": 4826033.747, "learn_time_ms": 227.546, "learn_throughput": 9561.565, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 144106, "num_env_steps_trained": 144106, "num_agent_steps_sampled": 144106, "num_agent_steps_trained": 144106}, "done": false, "episodes_total": 845, "training_iteration": 67, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-11-18", "timestamp": 1706271078, "time_this_iter_s": 10.014098882675171, "time_total_s": 705.34388422966, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 705.34388422966, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 74.87142857142858, "ram_util_percent": 16.092857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.29964046366512775, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0003, "total_loss": 7.741808354854584, "policy_loss": 0.005906757898628712, "vf_loss": 9.676653802394867, "vf_explained_var": -9.201839566230774e-05, "kl": 0.0019704577899553044, "entropy": 0.5421224851161242, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2160.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 146425, "num_env_steps_trained": 146425, "num_agent_steps_sampled": 146425, "num_agent_steps_trained": 146425}, "sampler_results": {"episode_reward_max": 253.17453990096286, "episode_reward_min": 71.45066168227285, "episode_reward_mean": 190.05988246813064, "episode_len_mean": 232.62, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494], "episode_lengths": [157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3639976420632908, "mean_inference_ms": 1.1644945723352473, "mean_action_processing_ms": 0.14168720833734774, "mean_env_wait_ms": 3.103797528221417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00900888442993164, "StateBufferConnector_ms": 0.00538945198059082, "ViewRequirementAgentConnector_ms": 0.14257240295410156}}, "episode_reward_max": 253.17453990096286, "episode_reward_min": 71.45066168227285, "episode_reward_mean": 190.05988246813064, "episode_len_mean": 232.62, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [131.35378207453684, 230.4668482332932, 188.5131954957953, 199.86915761916765, 159.05627423556643, 232.25676301998539, 155.3764013665859, 143.62041971615884, 238.70106351578482, 246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494], "episode_lengths": [157, 278, 227, 243, 194, 275, 188, 173, 301, 301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3639976420632908, "mean_inference_ms": 1.1644945723352473, "mean_action_processing_ms": 0.14168720833734774, "mean_env_wait_ms": 3.103797528221417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00900888442993164, "StateBufferConnector_ms": 0.00538945198059082, "ViewRequirementAgentConnector_ms": 0.14257240295410156}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146425, "num_agent_steps_trained": 146425, "num_env_steps_sampled": 146425, "num_env_steps_trained": 146425, "num_env_steps_sampled_this_iter": 2319, "num_env_steps_trained_this_iter": 2319, "num_env_steps_sampled_throughput_per_sec": 204.27674780682037, "num_env_steps_trained_throughput_per_sec": 204.27674780682037, "timesteps_total": 146425, "num_steps_trained_this_iter": 2319, "agent_timesteps_total": 146425, "timers": {"training_iteration_time_ms": 10590.683, "sample_time_ms": 10373.817, "load_time_ms": 0.422, "load_throughput": 5185840.024, "learn_time_ms": 216.028, "learn_throughput": 10132.031, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 146425, "num_env_steps_trained": 146425, "num_agent_steps_sampled": 146425, "num_agent_steps_trained": 146425}, "done": false, "episodes_total": 855, "training_iteration": 68, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-11-30", "timestamp": 1706271090, "time_this_iter_s": 11.353425025939941, "time_total_s": 716.6973092556, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 716.6973092556, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 76.6125, "ram_util_percent": 16.11875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.21950706280767918, "cur_kl_coeff": 2.168404344971009e-20, "cur_lr": 0.0003, "total_loss": 7.73931211233139, "policy_loss": -0.03486108596553095, "vf_loss": 9.724563479423523, "vf_explained_var": 0.00013059750199317932, "kl": 0.0024245428844663075, "entropy": 0.5477637816220522, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2192.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 148504, "num_env_steps_trained": 148504, "num_agent_steps_sampled": 148504, "num_agent_steps_trained": 148504}, "sampler_results": {"episode_reward_max": 255.32380653331367, "episode_reward_min": 71.45066168227285, "episode_reward_mean": 190.2851850499167, "episode_len_mean": 233.05, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237], "episode_lengths": [301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36396475677221113, "mean_inference_ms": 1.164473597276839, "mean_action_processing_ms": 0.14168749922939206, "mean_env_wait_ms": 3.10339956975929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009270191192626953, "StateBufferConnector_ms": 0.005456686019897461, "ViewRequirementAgentConnector_ms": 0.14286518096923828}}, "episode_reward_max": 255.32380653331367, "episode_reward_min": 71.45066168227285, "episode_reward_mean": 190.2851850499167, "episode_len_mean": 233.05, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [246.02745813812595, 239.2593581031881, 171.92334532823676, 198.0021331115388, 134.87354314088478, 167.07395624422045, 204.3228746397814, 149.236603181803, 147.48508607813906, 206.86770910041048, 218.06997119664143, 185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237], "episode_lengths": [301, 290, 203, 239, 162, 200, 245, 178, 177, 255, 272, 226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36396475677221113, "mean_inference_ms": 1.164473597276839, "mean_action_processing_ms": 0.14168749922939206, "mean_env_wait_ms": 3.10339956975929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009270191192626953, "StateBufferConnector_ms": 0.005456686019897461, "ViewRequirementAgentConnector_ms": 0.14286518096923828}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148504, "num_agent_steps_trained": 148504, "num_env_steps_sampled": 148504, "num_env_steps_trained": 148504, "num_env_steps_sampled_this_iter": 2079, "num_env_steps_trained_this_iter": 2079, "num_env_steps_sampled_throughput_per_sec": 190.22883190121456, "num_env_steps_trained_throughput_per_sec": 190.22883190121456, "timesteps_total": 148504, "num_steps_trained_this_iter": 2079, "agent_timesteps_total": 148504, "timers": {"training_iteration_time_ms": 10608.027, "sample_time_ms": 10391.594, "load_time_ms": 0.429, "load_throughput": 5101998.703, "learn_time_ms": 215.584, "learn_throughput": 10163.107, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 148504, "num_env_steps_trained": 148504, "num_agent_steps_sampled": 148504, "num_agent_steps_trained": 148504}, "done": false, "episodes_total": 864, "training_iteration": 69, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-11-41", "timestamp": 1706271101, "time_this_iter_s": 10.930048704147339, "time_total_s": 727.6273579597473, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 727.6273579597473, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 77.95, "ram_util_percent": 16.15625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2673019082285464, "cur_kl_coeff": 1.0842021724855045e-20, "cur_lr": 0.0003, "total_loss": 7.702652469277382, "policy_loss": -0.019302180968225002, "vf_loss": 9.659410893917084, "vf_explained_var": -0.0001664143055677414, "kl": 0.003126801969720816, "entropy": 0.5574157629162073, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2224.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 150632, "num_env_steps_trained": 150632, "num_agent_steps_sampled": 150632, "num_agent_steps_trained": 150632}, "sampler_results": {"episode_reward_max": 255.32380653331367, "episode_reward_min": 71.45066168227285, "episode_reward_mean": 186.96127233691107, "episode_len_mean": 229.11, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656], "episode_lengths": [226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3638590237552454, "mean_inference_ms": 1.1642465595840645, "mean_action_processing_ms": 0.14166042454580552, "mean_env_wait_ms": 3.1022466926037264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009344816207885742, "StateBufferConnector_ms": 0.0054166316986083984, "ViewRequirementAgentConnector_ms": 0.1419069766998291}}, "episode_reward_max": 255.32380653331367, "episode_reward_min": 71.45066168227285, "episode_reward_mean": 186.96127233691107, "episode_len_mean": 229.11, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [185.62320875135194, 236.21814081081237, 243.9433157589, 198.19978046227996, 164.48070923196246, 170.4597586763278, 229.08977620591193, 214.40539758674888, 188.5233643245479, 207.08058627954054, 253.17453990096286, 124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656], "episode_lengths": [226, 301, 301, 239, 194, 202, 274, 255, 226, 253, 301, 149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3638590237552454, "mean_inference_ms": 1.1642465595840645, "mean_action_processing_ms": 0.14166042454580552, "mean_env_wait_ms": 3.1022466926037264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009344816207885742, "StateBufferConnector_ms": 0.0054166316986083984, "ViewRequirementAgentConnector_ms": 0.1419069766998291}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150632, "num_agent_steps_trained": 150632, "num_env_steps_sampled": 150632, "num_env_steps_trained": 150632, "num_env_steps_sampled_this_iter": 2128, "num_env_steps_trained_this_iter": 2128, "num_env_steps_sampled_throughput_per_sec": 218.23664889431353, "num_env_steps_trained_throughput_per_sec": 218.23664889431353, "timesteps_total": 150632, "num_steps_trained_this_iter": 2128, "agent_timesteps_total": 150632, "timers": {"training_iteration_time_ms": 10498.461, "sample_time_ms": 10276.351, "load_time_ms": 0.447, "load_throughput": 4892160.219, "learn_time_ms": 221.246, "learn_throughput": 9873.155, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 150632, "num_env_steps_trained": 150632, "num_agent_steps_sampled": 150632, "num_agent_steps_trained": 150632}, "done": false, "episodes_total": 875, "training_iteration": 70, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-11-50", "timestamp": 1706271110, "time_this_iter_s": 9.752408981323242, "time_total_s": 737.3797669410706, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 737.3797669410706, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 68.80714285714286, "ram_util_percent": 16.09285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.36570310313254595, "cur_kl_coeff": 5.4210108624275225e-21, "cur_lr": 0.0003, "total_loss": 7.678627327084541, "policy_loss": 0.0002412309404462576, "vf_loss": 9.60454472899437, "vf_explained_var": -0.0003813132643699646, "kl": 0.0013899839013807175, "entropy": 0.5249615460634232, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2256.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 152951, "num_env_steps_trained": 152951, "num_agent_steps_sampled": 152951, "num_agent_steps_trained": 152951}, "sampler_results": {"episode_reward_max": 255.32380653331367, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 182.41981399404463, "episode_len_mean": 224.58, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344], "episode_lengths": [149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3637821912109969, "mean_inference_ms": 1.16415964530772, "mean_action_processing_ms": 0.14165375316688383, "mean_env_wait_ms": 3.101586170607336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009370803833007812, "StateBufferConnector_ms": 0.005468845367431641, "ViewRequirementAgentConnector_ms": 0.14238190650939941}}, "episode_reward_max": 255.32380653331367, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 182.41981399404463, "episode_len_mean": 224.58, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [124.06078633967799, 250.2025014192286, 250.71238439938028, 184.3405318925373, 210.11645607331533, 142.60558309538405, 175.46248010908562, 239.4229424889305, 188.3377035662571, 106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344], "episode_lengths": [149, 301, 301, 219, 249, 171, 214, 301, 223, 131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3637821912109969, "mean_inference_ms": 1.16415964530772, "mean_action_processing_ms": 0.14165375316688383, "mean_env_wait_ms": 3.101586170607336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009370803833007812, "StateBufferConnector_ms": 0.005468845367431641, "ViewRequirementAgentConnector_ms": 0.14238190650939941}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152951, "num_agent_steps_trained": 152951, "num_env_steps_sampled": 152951, "num_env_steps_trained": 152951, "num_env_steps_sampled_this_iter": 2319, "num_env_steps_trained_this_iter": 2319, "num_env_steps_sampled_throughput_per_sec": 186.18855045208852, "num_env_steps_trained_throughput_per_sec": 186.18855045208852, "timesteps_total": 152951, "num_steps_trained_this_iter": 2319, "agent_timesteps_total": 152951, "timers": {"training_iteration_time_ms": 10678.929, "sample_time_ms": 10450.607, "load_time_ms": 0.465, "load_throughput": 4729148.134, "learn_time_ms": 227.422, "learn_throughput": 9677.179, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 152951, "num_env_steps_trained": 152951, "num_agent_steps_sampled": 152951, "num_agent_steps_trained": 152951}, "done": false, "episodes_total": 886, "training_iteration": 71, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-12-03", "timestamp": 1706271123, "time_this_iter_s": 12.456814289093018, "time_total_s": 749.8365812301636, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 749.8365812301636, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 83.53333333333333, "ram_util_percent": 16.11111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3181327199563384, "cur_kl_coeff": 2.7105054312137612e-21, "cur_lr": 0.0003, "total_loss": 7.723084717988968, "policy_loss": -0.007295073824934661, "vf_loss": 9.6696637570858, "vf_explained_var": -0.00021991319954395294, "kl": 0.002584172468292111, "entropy": 0.5351190753281116, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2288.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 155260, "num_env_steps_trained": 155260, "num_agent_steps_sampled": 155260, "num_agent_steps_trained": 155260}, "sampler_results": {"episode_reward_max": 255.32380653331367, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 182.93351279288348, "episode_len_mean": 226.39, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381], "episode_lengths": [131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3637632379193313, "mean_inference_ms": 1.1642404157198223, "mean_action_processing_ms": 0.14166931797103915, "mean_env_wait_ms": 3.101601986360088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009396791458129883, "StateBufferConnector_ms": 0.005509138107299805, "ViewRequirementAgentConnector_ms": 0.1437520980834961}}, "episode_reward_max": 255.32380653331367, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 182.93351279288348, "episode_len_mean": 226.39, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [106.56244482248171, 230.82324790696782, 181.67393269083396, 136.88731440966936, 226.54780027283022, 150.35307744713205, 173.77870529217998, 102.42332477594509, 188.74755737015437, 168.78807005296036, 192.8203439274215, 146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381], "episode_lengths": [131, 273, 216, 170, 274, 183, 212, 124, 221, 207, 236, 177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3637632379193313, "mean_inference_ms": 1.1642404157198223, "mean_action_processing_ms": 0.14166931797103915, "mean_env_wait_ms": 3.101601986360088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009396791458129883, "StateBufferConnector_ms": 0.005509138107299805, "ViewRequirementAgentConnector_ms": 0.1437520980834961}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155260, "num_agent_steps_trained": 155260, "num_env_steps_sampled": 155260, "num_env_steps_trained": 155260, "num_env_steps_sampled_this_iter": 2309, "num_env_steps_trained_this_iter": 2309, "num_env_steps_sampled_throughput_per_sec": 200.6830794992078, "num_env_steps_trained_throughput_per_sec": 200.6830794992078, "timesteps_total": 155260, "num_steps_trained_this_iter": 2309, "agent_timesteps_total": 155260, "timers": {"training_iteration_time_ms": 10937.89, "sample_time_ms": 10707.674, "load_time_ms": 0.463, "load_throughput": 4798330.389, "learn_time_ms": 229.316, "learn_throughput": 9696.242, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 155260, "num_env_steps_trained": 155260, "num_agent_steps_sampled": 155260, "num_agent_steps_trained": 155260}, "done": false, "episodes_total": 895, "training_iteration": 72, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-12-14", "timestamp": 1706271134, "time_this_iter_s": 11.506973266601562, "time_total_s": 761.3435544967651, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 761.3435544967651, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 77.35, "ram_util_percent": 16.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.41193035850301385, "cur_kl_coeff": 1.3552527156068806e-21, "cur_lr": 0.0003, "total_loss": 7.6687902957201, "policy_loss": 0.0002727257087826729, "vf_loss": 9.592353612184525, "vf_explained_var": 0.0029450971633195877, "kl": 0.002193271499075236, "entropy": 0.5365315023809671, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2320.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 157460, "num_env_steps_trained": 157460, "num_agent_steps_sampled": 157460, "num_agent_steps_trained": 157460}, "sampler_results": {"episode_reward_max": 255.32380653331367, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 181.85458041143468, "episode_len_mean": 225.92, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836], "episode_lengths": [177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3637552706145896, "mean_inference_ms": 1.1644124116399768, "mean_action_processing_ms": 0.14169745422945096, "mean_env_wait_ms": 3.1018349057469017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009148836135864258, "StateBufferConnector_ms": 0.0054781436920166016, "ViewRequirementAgentConnector_ms": 0.14348435401916504}}, "episode_reward_max": 255.32380653331367, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 181.85458041143468, "episode_len_mean": 225.92, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [146.3274766476394, 238.06678807182996, 247.51302634827354, 232.38868293945634, 238.54981643639468, 223.62613484676112, 246.31444816827187, 126.47953428636849, 204.99175746187493, 228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836], "episode_lengths": [177, 301, 301, 271, 301, 274, 301, 152, 243, 301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3637552706145896, "mean_inference_ms": 1.1644124116399768, "mean_action_processing_ms": 0.14169745422945096, "mean_env_wait_ms": 3.1018349057469017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009148836135864258, "StateBufferConnector_ms": 0.0054781436920166016, "ViewRequirementAgentConnector_ms": 0.14348435401916504}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157460, "num_agent_steps_trained": 157460, "num_env_steps_sampled": 157460, "num_env_steps_trained": 157460, "num_env_steps_sampled_this_iter": 2200, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 202.34070004351847, "num_env_steps_trained_throughput_per_sec": 202.34070004351847, "timesteps_total": 157460, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 157460, "timers": {"training_iteration_time_ms": 10892.305, "sample_time_ms": 10661.551, "load_time_ms": 0.466, "load_throughput": 4747547.661, "learn_time_ms": 229.85, "learn_throughput": 9621.052, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 157460, "num_env_steps_trained": 157460, "num_agent_steps_sampled": 157460, "num_agent_steps_trained": 157460}, "done": false, "episodes_total": 906, "training_iteration": 73, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-12-25", "timestamp": 1706271145, "time_this_iter_s": 10.873829126358032, "time_total_s": 772.2173836231232, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 772.2173836231232, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 77.05, "ram_util_percent": 16.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3622707645408809, "cur_kl_coeff": 6.776263578034403e-22, "cur_lr": 0.0003, "total_loss": 7.701164469122887, "policy_loss": -0.009851371672993992, "vf_loss": 9.645288437604904, "vf_explained_var": 0.003252299502491951, "kl": 0.0007752238793606019, "entropy": 0.5214800108224154, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2352.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 159639, "num_env_steps_trained": 159639, "num_agent_steps_sampled": 159639, "num_agent_steps_trained": 159639}, "sampler_results": {"episode_reward_max": 255.32380653331367, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 179.81440731079002, "episode_len_mean": 224.5, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903], "episode_lengths": [301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3637413119359486, "mean_inference_ms": 1.1645715169734872, "mean_action_processing_ms": 0.14172004408740813, "mean_env_wait_ms": 3.1020347700801825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007250547409057617, "StateBufferConnector_ms": 0.005553007125854492, "ViewRequirementAgentConnector_ms": 0.14447927474975586}}, "episode_reward_max": 255.32380653331367, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 179.81440731079002, "episode_len_mean": 224.5, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [228.2386298598526, 239.5897050715021, 138.11755413031108, 156.86702441121494, 147.9638918764147, 241.67654644664714, 237.2732157520858, 242.8419576543002, 202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903], "episode_lengths": [301, 301, 166, 185, 179, 301, 280, 301, 235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3637413119359486, "mean_inference_ms": 1.1645715169734872, "mean_action_processing_ms": 0.14172004408740813, "mean_env_wait_ms": 3.1020347700801825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007250547409057617, "StateBufferConnector_ms": 0.005553007125854492, "ViewRequirementAgentConnector_ms": 0.14447927474975586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159639, "num_agent_steps_trained": 159639, "num_env_steps_sampled": 159639, "num_env_steps_trained": 159639, "num_env_steps_sampled_this_iter": 2179, "num_env_steps_trained_this_iter": 2179, "num_env_steps_sampled_throughput_per_sec": 201.89154142202523, "num_env_steps_trained_throughput_per_sec": 201.89154142202523, "timesteps_total": 159639, "num_steps_trained_this_iter": 2179, "agent_timesteps_total": 159639, "timers": {"training_iteration_time_ms": 10914.221, "sample_time_ms": 10681.867, "load_time_ms": 0.461, "load_throughput": 4799526.725, "learn_time_ms": 231.453, "learn_throughput": 9569.553, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 159639, "num_env_steps_trained": 159639, "num_agent_steps_sampled": 159639, "num_agent_steps_trained": 159639}, "done": false, "episodes_total": 915, "training_iteration": 74, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-12-36", "timestamp": 1706271156, "time_this_iter_s": 10.794103145599365, "time_total_s": 783.0114867687225, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 783.0114867687225, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 77.26666666666667, "ram_util_percent": 16.166666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4053500157315284, "cur_kl_coeff": 3.3881317890172015e-22, "cur_lr": 0.0003, "total_loss": 7.672853380441666, "policy_loss": -0.028768458170816302, "vf_loss": 9.633482784032822, "vf_explained_var": 0.0002155900001525879, "kl": 0.000989877755817034, "entropy": 0.5164451040327549, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2384.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 161703, "num_env_steps_trained": 161703, "num_agent_steps_sampled": 161703, "num_agent_steps_trained": 161703}, "sampler_results": {"episode_reward_max": 258.4370202994363, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 179.6035042743123, "episode_len_mean": 225.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581], "episode_lengths": [235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36370016886287365, "mean_inference_ms": 1.164595112008934, "mean_action_processing_ms": 0.1417262286867263, "mean_env_wait_ms": 3.1018024462124454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007147073745727539, "StateBufferConnector_ms": 0.00552058219909668, "ViewRequirementAgentConnector_ms": 0.14405250549316406}}, "episode_reward_max": 258.4370202994363, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 179.6035042743123, "episode_len_mean": 225.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [202.50689034009108, 249.1628924367055, 239.95487792586118, 136.7674027678273, 235.63618094922532, 233.20547975393313, 237.73726971370115, 102.74253361358895, 126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581], "episode_lengths": [235, 301, 301, 165, 301, 301, 301, 129, 148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36370016886287365, "mean_inference_ms": 1.164595112008934, "mean_action_processing_ms": 0.1417262286867263, "mean_env_wait_ms": 3.1018024462124454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007147073745727539, "StateBufferConnector_ms": 0.00552058219909668, "ViewRequirementAgentConnector_ms": 0.14405250549316406}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161703, "num_agent_steps_trained": 161703, "num_env_steps_sampled": 161703, "num_env_steps_trained": 161703, "num_env_steps_sampled_this_iter": 2064, "num_env_steps_trained_this_iter": 2064, "num_env_steps_sampled_throughput_per_sec": 225.25688851466245, "num_env_steps_trained_throughput_per_sec": 225.25688851466245, "timesteps_total": 161703, "num_steps_trained_this_iter": 2064, "agent_timesteps_total": 161703, "timers": {"training_iteration_time_ms": 10721.973, "sample_time_ms": 10481.016, "load_time_ms": 0.49, "load_throughput": 4479199.351, "learn_time_ms": 240.022, "learn_throughput": 9150.837, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 161703, "num_env_steps_trained": 161703, "num_agent_steps_sampled": 161703, "num_agent_steps_trained": 161703}, "done": false, "episodes_total": 923, "training_iteration": 75, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-12-45", "timestamp": 1706271165, "time_this_iter_s": 9.164422035217285, "time_total_s": 792.1759088039398, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 792.1759088039398, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 67.69285714285715, "ram_util_percent": 16.09285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3393731382675469, "cur_kl_coeff": 1.6940658945086008e-22, "cur_lr": 0.0003, "total_loss": 7.704625442624092, "policy_loss": -0.038362698134733364, "vf_loss": 9.685143291950226, "vf_explained_var": 0.0004356708377599716, "kl": 0.0018156938888816698, "entropy": 0.51265524700284, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2416.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 163791, "num_env_steps_trained": 163791, "num_agent_steps_sampled": 163791, "num_agent_steps_trained": 163791}, "sampler_results": {"episode_reward_max": 258.4370202994363, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 179.66254509169653, "episode_len_mean": 225.54, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046], "episode_lengths": [148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36366769684781375, "mean_inference_ms": 1.164662647556363, "mean_action_processing_ms": 0.14173775985677717, "mean_env_wait_ms": 3.101771449825323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071108341217041016, "StateBufferConnector_ms": 0.005556344985961914, "ViewRequirementAgentConnector_ms": 0.1444082260131836}}, "episode_reward_max": 258.4370202994363, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 179.66254509169653, "episode_len_mean": 225.54, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [126.4148144777448, 144.3421634371725, 129.33442739324695, 248.74639317933992, 173.664537362259, 232.47756084261331, 236.90198636646718, 142.98563751708284, 71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046], "episode_lengths": [148, 175, 155, 301, 222, 301, 301, 170, 89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36366769684781375, "mean_inference_ms": 1.164662647556363, "mean_action_processing_ms": 0.14173775985677717, "mean_env_wait_ms": 3.101771449825323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071108341217041016, "StateBufferConnector_ms": 0.005556344985961914, "ViewRequirementAgentConnector_ms": 0.1444082260131836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163791, "num_agent_steps_trained": 163791, "num_env_steps_sampled": 163791, "num_env_steps_trained": 163791, "num_env_steps_sampled_this_iter": 2088, "num_env_steps_trained_this_iter": 2088, "num_env_steps_sampled_throughput_per_sec": 208.48367852368617, "num_env_steps_trained_throughput_per_sec": 208.48367852368617, "timesteps_total": 163791, "num_steps_trained_this_iter": 2088, "agent_timesteps_total": 163791, "timers": {"training_iteration_time_ms": 10684.935, "sample_time_ms": 10455.783, "load_time_ms": 0.466, "load_throughput": 4671899.821, "learn_time_ms": 228.257, "learn_throughput": 9539.694, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 163791, "num_env_steps_trained": 163791, "num_agent_steps_sampled": 163791, "num_agent_steps_trained": 163791}, "done": false, "episodes_total": 931, "training_iteration": 76, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-12-55", "timestamp": 1706271175, "time_this_iter_s": 10.016196012496948, "time_total_s": 802.1921048164368, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 802.1921048164368, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 75.64285714285714, "ram_util_percent": 16.09285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3311337404884398, "cur_kl_coeff": 8.470329472543004e-23, "cur_lr": 0.0003, "total_loss": 7.70825520157814, "policy_loss": -0.03899115911917761, "vf_loss": 9.690397709608078, "vf_explained_var": 0.00040449388325214386, "kl": 0.0020805630769944114, "entropy": 0.5071707526221871, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2448.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 165925, "num_env_steps_trained": 165925, "num_agent_steps_sampled": 165925, "num_agent_steps_trained": 165925}, "sampler_results": {"episode_reward_max": 258.4370202994363, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 182.16950080107864, "episode_len_mean": 229.15, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975], "episode_lengths": [89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3636526554827034, "mean_inference_ms": 1.1647718670806333, "mean_action_processing_ms": 0.14175371470860484, "mean_env_wait_ms": 3.1019154942597025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007218837738037109, "StateBufferConnector_ms": 0.005558013916015625, "ViewRequirementAgentConnector_ms": 0.14469599723815918}}, "episode_reward_max": 258.4370202994363, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 182.16950080107864, "episode_len_mean": 229.15, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [71.45066168227285, 124.42425532016398, 232.9928402624204, 241.35863920056744, 89.62565121485609, 120.38581053031808, 241.8527959553973, 172.62281790104456, 151.36424634515495, 137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975], "episode_lengths": [89, 151, 301, 301, 110, 144, 301, 199, 178, 165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3636526554827034, "mean_inference_ms": 1.1647718670806333, "mean_action_processing_ms": 0.14175371470860484, "mean_env_wait_ms": 3.1019154942597025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007218837738037109, "StateBufferConnector_ms": 0.005558013916015625, "ViewRequirementAgentConnector_ms": 0.14469599723815918}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165925, "num_agent_steps_trained": 165925, "num_env_steps_sampled": 165925, "num_env_steps_trained": 165925, "num_env_steps_sampled_this_iter": 2134, "num_env_steps_trained_this_iter": 2134, "num_env_steps_sampled_throughput_per_sec": 201.89749529573248, "num_env_steps_trained_throughput_per_sec": 201.89749529573248, "timesteps_total": 165925, "num_steps_trained_this_iter": 2134, "agent_timesteps_total": 165925, "timers": {"training_iteration_time_ms": 10740.598, "sample_time_ms": 10510.293, "load_time_ms": 0.463, "load_throughput": 4712679.282, "learn_time_ms": 229.404, "learn_throughput": 9511.176, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 165925, "num_env_steps_trained": 165925, "num_agent_steps_sampled": 165925, "num_agent_steps_trained": 165925}, "done": false, "episodes_total": 939, "training_iteration": 77, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-13-06", "timestamp": 1706271186, "time_this_iter_s": 10.571417331695557, "time_total_s": 812.7635221481323, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 812.7635221481323, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 77.68, "ram_util_percent": 16.159999999999993}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.31498103332705796, "cur_kl_coeff": 4.235164736271502e-23, "cur_lr": 0.0003, "total_loss": 7.729573085904121, "policy_loss": -0.008652315707877278, "vf_loss": 9.679379105567932, "vf_explained_var": 4.554726183414459e-05, "kl": 0.0013189687539747232, "entropy": 0.5277881324291229, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2480.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 168265, "num_env_steps_trained": 168265, "num_agent_steps_sampled": 168265, "num_agent_steps_trained": 168265}, "sampler_results": {"episode_reward_max": 258.4370202994363, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 186.81515921584375, "episode_len_mean": 234.81, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837], "episode_lengths": [165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36365394303720977, "mean_inference_ms": 1.1648771559165363, "mean_action_processing_ms": 0.14177021909727677, "mean_env_wait_ms": 3.1020646299330092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007206916809082031, "StateBufferConnector_ms": 0.005579710006713867, "ViewRequirementAgentConnector_ms": 0.14482688903808594}}, "episode_reward_max": 258.4370202994363, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 186.81515921584375, "episode_len_mean": 234.81, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [137.92761785687455, 98.53039747456046, 223.70682693653188, 223.24151398021542, 225.85661551756672, 125.05594268850584, 237.96266557899494, 111.12049698064607, 120.07831372292762, 239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837], "episode_lengths": [165, 119, 301, 301, 301, 153, 301, 133, 145, 301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36365394303720977, "mean_inference_ms": 1.1648771559165363, "mean_action_processing_ms": 0.14177021909727677, "mean_env_wait_ms": 3.1020646299330092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007206916809082031, "StateBufferConnector_ms": 0.005579710006713867, "ViewRequirementAgentConnector_ms": 0.14482688903808594}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168265, "num_agent_steps_trained": 168265, "num_env_steps_sampled": 168265, "num_env_steps_trained": 168265, "num_env_steps_sampled_this_iter": 2340, "num_env_steps_trained_this_iter": 2340, "num_env_steps_sampled_throughput_per_sec": 207.38236551902023, "num_env_steps_trained_throughput_per_sec": 207.38236551902023, "timesteps_total": 168265, "num_steps_trained_this_iter": 2340, "agent_timesteps_total": 168265, "timers": {"training_iteration_time_ms": 10733.724, "sample_time_ms": 10505.162, "load_time_ms": 0.467, "load_throughput": 4678426.934, "learn_time_ms": 227.662, "learn_throughput": 9593.156, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 168265, "num_env_steps_trained": 168265, "num_agent_steps_sampled": 168265, "num_agent_steps_trained": 168265}, "done": false, "episodes_total": 948, "training_iteration": 78, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-13-17", "timestamp": 1706271197, "time_this_iter_s": 11.284602880477905, "time_total_s": 824.0481250286102, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 824.0481250286102, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 76.3, "ram_util_percent": 16.06875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.39417163748294115, "cur_kl_coeff": 2.117582368135751e-23, "cur_lr": 0.0003, "total_loss": 7.698862314224243, "policy_loss": -0.013839226681739092, "vf_loss": 9.647246450185776, "vf_explained_var": -2.819858491420746e-05, "kl": 0.0023020815640848527, "entropy": 0.5095701683312654, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2512.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 170434, "num_env_steps_trained": 170434, "num_agent_steps_sampled": 170434, "num_agent_steps_trained": 170434}, "sampler_results": {"episode_reward_max": 258.4370202994363, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 189.27018869790336, "episode_len_mean": 237.31, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827], "episode_lengths": [301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3636237532798097, "mean_inference_ms": 1.1648405345065904, "mean_action_processing_ms": 0.14176713960465936, "mean_env_wait_ms": 3.101743682145259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007152080535888672, "StateBufferConnector_ms": 0.005540132522583008, "ViewRequirementAgentConnector_ms": 0.14480018615722656}}, "episode_reward_max": 258.4370202994363, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 189.27018869790336, "episode_len_mean": 237.31, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [239.5135696987379, 255.32380653331367, 115.94858687982176, 240.99740064361703, 242.32104533343744, 130.8013663696335, 245.63957729334237, 233.75373140089587, 119.61497431709793, 235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827], "episode_lengths": [301, 301, 138, 301, 301, 158, 301, 301, 140, 301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3636237532798097, "mean_inference_ms": 1.1648405345065904, "mean_action_processing_ms": 0.14176713960465936, "mean_env_wait_ms": 3.101743682145259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007152080535888672, "StateBufferConnector_ms": 0.005540132522583008, "ViewRequirementAgentConnector_ms": 0.14480018615722656}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 170434, "num_agent_steps_trained": 170434, "num_env_steps_sampled": 170434, "num_env_steps_trained": 170434, "num_env_steps_sampled_this_iter": 2169, "num_env_steps_trained_this_iter": 2169, "num_env_steps_sampled_throughput_per_sec": 225.3434207537298, "num_env_steps_trained_throughput_per_sec": 225.3434207537298, "timesteps_total": 170434, "num_steps_trained_this_iter": 2169, "agent_timesteps_total": 170434, "timers": {"training_iteration_time_ms": 10603.36, "sample_time_ms": 10367.369, "load_time_ms": 0.494, "load_throughput": 4442457.702, "learn_time_ms": 235.056, "learn_throughput": 9329.699, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 170434, "num_env_steps_trained": 170434, "num_agent_steps_sampled": 170434, "num_agent_steps_trained": 170434}, "done": false, "episodes_total": 957, "training_iteration": 79, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-13-27", "timestamp": 1706271207, "time_this_iter_s": 9.626821517944336, "time_total_s": 833.6749465465546, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 833.6749465465546, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 66.35000000000001, "ram_util_percent": 16.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.33745302353054285, "cur_kl_coeff": 1.0587911840678755e-23, "cur_lr": 0.0003, "total_loss": 7.736296579241753, "policy_loss": -0.0078562360140495, "vf_loss": 9.686417400836945, "vf_explained_var": 3.88268381357193e-05, "kl": 0.0031696299967762798, "entropy": 0.4981086626648903, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2544.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 172636, "num_env_steps_trained": 172636, "num_agent_steps_sampled": 172636, "num_agent_steps_trained": 172636}, "sampler_results": {"episode_reward_max": 258.4370202994363, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 189.24817204494684, "episode_len_mean": 236.91, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832], "episode_lengths": [301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3635613608279054, "mean_inference_ms": 1.1647182523318766, "mean_action_processing_ms": 0.14175267307654776, "mean_env_wait_ms": 3.1011678390906354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006999015808105469, "StateBufferConnector_ms": 0.005479335784912109, "ViewRequirementAgentConnector_ms": 0.1444087028503418}}, "episode_reward_max": 258.4370202994363, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 189.24817204494684, "episode_len_mean": 236.91, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [235.67009878506383, 134.05279824673335, 111.64768486269969, 111.86943419998866, 177.89183483650842, 149.12603512480064, 238.62308133357115, 108.18924081577968, 130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832], "episode_lengths": [301, 159, 135, 133, 204, 175, 301, 128, 151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3635613608279054, "mean_inference_ms": 1.1647182523318766, "mean_action_processing_ms": 0.14175267307654776, "mean_env_wait_ms": 3.1011678390906354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006999015808105469, "StateBufferConnector_ms": 0.005479335784912109, "ViewRequirementAgentConnector_ms": 0.1444087028503418}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172636, "num_agent_steps_trained": 172636, "num_env_steps_sampled": 172636, "num_env_steps_trained": 172636, "num_env_steps_sampled_this_iter": 2202, "num_env_steps_trained_this_iter": 2202, "num_env_steps_sampled_throughput_per_sec": 209.4327891095808, "num_env_steps_trained_throughput_per_sec": 209.4327891095808, "timesteps_total": 172636, "num_steps_trained_this_iter": 2202, "agent_timesteps_total": 172636, "timers": {"training_iteration_time_ms": 10679.684, "sample_time_ms": 10451.293, "load_time_ms": 0.482, "load_throughput": 4564365.243, "learn_time_ms": 227.475, "learn_throughput": 9673.152, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 172636, "num_env_steps_trained": 172636, "num_agent_steps_sampled": 172636, "num_agent_steps_trained": 172636}, "done": false, "episodes_total": 966, "training_iteration": 80, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-13-38", "timestamp": 1706271218, "time_this_iter_s": 10.515080690383911, "time_total_s": 844.1900272369385, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 844.1900272369385, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 76.16666666666667, "ram_util_percent": 16.046666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.35248372750356793, "cur_kl_coeff": 5.2939559203393774e-24, "cur_lr": 0.0003, "total_loss": 7.75726506114006, "policy_loss": -0.02611750445794314, "vf_loss": 9.73559394478798, "vf_explained_var": -1.4621764421463013e-06, "kl": 0.00302729406652702, "entropy": 0.5092572309076786, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2576.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 174862, "num_env_steps_trained": 174862, "num_agent_steps_sampled": 174862, "num_agent_steps_trained": 174862}, "sampler_results": {"episode_reward_max": 258.4370202994363, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 194.98449327382258, "episode_len_mean": 243.81, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148], "episode_lengths": [151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36351674162674963, "mean_inference_ms": 1.1646650076279565, "mean_action_processing_ms": 0.1417466251637098, "mean_env_wait_ms": 3.1008977146947068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069217681884765625, "StateBufferConnector_ms": 0.0055005550384521484, "ViewRequirementAgentConnector_ms": 0.14485549926757812}}, "episode_reward_max": 258.4370202994363, "episode_reward_min": 50.07772048182711, "episode_reward_mean": 194.98449327382258, "episode_len_mean": 243.81, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [130.3118530392656, 50.07772048182711, 233.5761733623702, 176.00016011029967, 76.76991992570363, 231.46810343739, 229.009417449811, 94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148], "episode_lengths": [151, 65, 301, 200, 99, 301, 301, 119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36351674162674963, "mean_inference_ms": 1.1646650076279565, "mean_action_processing_ms": 0.1417466251637098, "mean_env_wait_ms": 3.1008977146947068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069217681884765625, "StateBufferConnector_ms": 0.0055005550384521484, "ViewRequirementAgentConnector_ms": 0.14485549926757812}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174862, "num_agent_steps_trained": 174862, "num_env_steps_sampled": 174862, "num_env_steps_trained": 174862, "num_env_steps_sampled_this_iter": 2226, "num_env_steps_trained_this_iter": 2226, "num_env_steps_sampled_throughput_per_sec": 204.2887100154394, "num_env_steps_trained_throughput_per_sec": 204.2887100154394, "timesteps_total": 174862, "num_steps_trained_this_iter": 2226, "agent_timesteps_total": 174862, "timers": {"training_iteration_time_ms": 10523.807, "sample_time_ms": 10299.859, "load_time_ms": 0.461, "load_throughput": 4753110.677, "learn_time_ms": 223.068, "learn_throughput": 9822.551, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 174862, "num_env_steps_trained": 174862, "num_agent_steps_sampled": 174862, "num_agent_steps_trained": 174862}, "done": false, "episodes_total": 974, "training_iteration": 81, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-13-49", "timestamp": 1706271229, "time_this_iter_s": 10.897521257400513, "time_total_s": 855.087548494339, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 855.087548494339, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 76.53125, "ram_util_percent": 16.00625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.315530855441466, "cur_kl_coeff": 2.6469779601696887e-24, "cur_lr": 0.0003, "total_loss": 7.7575265765190125, "policy_loss": -0.006560753128724173, "vf_loss": 9.711223095655441, "vf_explained_var": -6.845220923423767e-05, "kl": 0.003944342478387004, "entropy": 0.48911869525909424, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2608.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 176911, "num_env_steps_trained": 176911, "num_agent_steps_sampled": 176911, "num_agent_steps_trained": 176911}, "sampler_results": {"episode_reward_max": 258.4370202994363, "episode_reward_min": 67.46359676863268, "episode_reward_mean": 200.47798692091624, "episode_len_mean": 250.12, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066], "episode_lengths": [119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36346183286989214, "mean_inference_ms": 1.1645418865936903, "mean_action_processing_ms": 0.14173085896263704, "mean_env_wait_ms": 3.1004203934746863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00704503059387207, "StateBufferConnector_ms": 0.005487918853759766, "ViewRequirementAgentConnector_ms": 0.14468765258789062}}, "episode_reward_max": 258.4370202994363, "episode_reward_min": 67.46359676863268, "episode_reward_mean": 200.47798692091624, "episode_len_mean": 250.12, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [94.64523463116201, 95.24289507206072, 184.11579635132858, 237.24595002131886, 228.9013728594344, 226.8925218334371, 226.1509001329286, 227.9629189223719, 192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066], "episode_lengths": [119, 117, 214, 301, 301, 301, 301, 301, 221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36346183286989214, "mean_inference_ms": 1.1645418865936903, "mean_action_processing_ms": 0.14173085896263704, "mean_env_wait_ms": 3.1004203934746863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00704503059387207, "StateBufferConnector_ms": 0.005487918853759766, "ViewRequirementAgentConnector_ms": 0.14468765258789062}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176911, "num_agent_steps_trained": 176911, "num_env_steps_sampled": 176911, "num_env_steps_trained": 176911, "num_env_steps_sampled_this_iter": 2049, "num_env_steps_trained_this_iter": 2049, "num_env_steps_sampled_throughput_per_sec": 200.41986553180757, "num_env_steps_trained_throughput_per_sec": 200.41986553180757, "timesteps_total": 176911, "num_steps_trained_this_iter": 2049, "agent_timesteps_total": 176911, "timers": {"training_iteration_time_ms": 10395.59, "sample_time_ms": 10171.064, "load_time_ms": 0.465, "load_throughput": 4654342.469, "learn_time_ms": 223.64, "learn_throughput": 9681.174, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 176911, "num_env_steps_trained": 176911, "num_agent_steps_sampled": 176911, "num_agent_steps_trained": 176911}, "done": false, "episodes_total": 981, "training_iteration": 82, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-13-59", "timestamp": 1706271239, "time_this_iter_s": 10.224969387054443, "time_total_s": 865.3125178813934, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 865.3125178813934, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 78.48571428571428, "ram_util_percent": 16.02857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.334476871881634, "cur_kl_coeff": 1.3234889800848444e-24, "cur_lr": 0.0003, "total_loss": 7.749051600694656, "policy_loss": -0.0015979809686541557, "vf_loss": 9.694432854652405, "vf_explained_var": -1.1106953024864197e-05, "kl": 0.002054496491467883, "entropy": 0.4896713299676776, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2640.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 179174, "num_env_steps_trained": 179174, "num_agent_steps_sampled": 179174, "num_agent_steps_trained": 179174}, "sampler_results": {"episode_reward_max": 259.54034594496, "episode_reward_min": 67.46359676863268, "episode_reward_mean": 203.81374612756892, "episode_len_mean": 253.2, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103], "episode_lengths": [221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3633720888587739, "mean_inference_ms": 1.1643203716662172, "mean_action_processing_ms": 0.1417016854208381, "mean_env_wait_ms": 3.0995716622644154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007032632827758789, "StateBufferConnector_ms": 0.005438327789306641, "ViewRequirementAgentConnector_ms": 0.14380931854248047}}, "episode_reward_max": 259.54034594496, "episode_reward_min": 67.46359676863268, "episode_reward_mean": 203.81374612756892, "episode_len_mean": 253.2, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [192.12263765179006, 234.64886704860717, 122.3018832068093, 238.84347636397402, 115.70977359932421, 231.9982705084381, 67.46359676863268, 178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103], "episode_lengths": [221, 301, 145, 301, 137, 301, 87, 209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3633720888587739, "mean_inference_ms": 1.1643203716662172, "mean_action_processing_ms": 0.1417016854208381, "mean_env_wait_ms": 3.0995716622644154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007032632827758789, "StateBufferConnector_ms": 0.005438327789306641, "ViewRequirementAgentConnector_ms": 0.14380931854248047}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179174, "num_agent_steps_trained": 179174, "num_env_steps_sampled": 179174, "num_env_steps_trained": 179174, "num_env_steps_sampled_this_iter": 2263, "num_env_steps_trained_this_iter": 2263, "num_env_steps_sampled_throughput_per_sec": 216.21717432784973, "num_env_steps_trained_throughput_per_sec": 216.21717432784973, "timesteps_total": 179174, "num_steps_trained_this_iter": 2263, "agent_timesteps_total": 179174, "timers": {"training_iteration_time_ms": 10354.946, "sample_time_ms": 10120.626, "load_time_ms": 0.484, "load_throughput": 4489555.213, "learn_time_ms": 233.408, "learn_throughput": 9303.041, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 179174, "num_env_steps_trained": 179174, "num_agent_steps_sampled": 179174, "num_agent_steps_trained": 179174}, "done": false, "episodes_total": 989, "training_iteration": 83, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-14-09", "timestamp": 1706271249, "time_this_iter_s": 10.467907428741455, "time_total_s": 875.7804253101349, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 875.7804253101349, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 67.8, "ram_util_percent": 16.086666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.29765663109719753, "cur_kl_coeff": 6.617444900424222e-25, "cur_lr": 0.0003, "total_loss": 7.725141301751137, "policy_loss": -0.040045680856565014, "vf_loss": 9.712608486413956, "vf_explained_var": -6.722845137119293e-05, "kl": 0.0027025668011908827, "entropy": 0.4899822734296322, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2672.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 181281, "num_env_steps_trained": 181281, "num_agent_steps_sampled": 181281, "num_agent_steps_trained": 181281}, "sampler_results": {"episode_reward_max": 259.54034594496, "episode_reward_min": 78.57003903284573, "episode_reward_mean": 208.5594642944776, "episode_len_mean": 259.34, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719], "episode_lengths": [209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3632843629013378, "mean_inference_ms": 1.1640889100006662, "mean_action_processing_ms": 0.14166885719525113, "mean_env_wait_ms": 3.098683422225414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007013559341430664, "StateBufferConnector_ms": 0.0054738521575927734, "ViewRequirementAgentConnector_ms": 0.14427471160888672}}, "episode_reward_max": 259.54034594496, "episode_reward_min": 78.57003903284573, "episode_reward_mean": 208.5594642944776, "episode_len_mean": 259.34, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [178.33479222510474, 227.71547430230595, 222.04221581373093, 123.95773621987449, 117.54114537143698, 130.3581353211546, 231.15426350605472, 78.57003903284573, 189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719], "episode_lengths": [209, 301, 297, 145, 142, 153, 301, 99, 250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3632843629013378, "mean_inference_ms": 1.1640889100006662, "mean_action_processing_ms": 0.14166885719525113, "mean_env_wait_ms": 3.098683422225414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007013559341430664, "StateBufferConnector_ms": 0.0054738521575927734, "ViewRequirementAgentConnector_ms": 0.14427471160888672}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 181281, "num_agent_steps_trained": 181281, "num_env_steps_sampled": 181281, "num_env_steps_trained": 181281, "num_env_steps_sampled_this_iter": 2107, "num_env_steps_trained_this_iter": 2107, "num_env_steps_sampled_throughput_per_sec": 212.16543894190278, "num_env_steps_trained_throughput_per_sec": 212.16543894190278, "timesteps_total": 181281, "num_steps_trained_this_iter": 2107, "agent_timesteps_total": 181281, "timers": {"training_iteration_time_ms": 10268.747, "sample_time_ms": 10037.147, "load_time_ms": 0.481, "load_throughput": 4497727.042, "learn_time_ms": 230.689, "learn_throughput": 9381.454, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 181281, "num_env_steps_trained": 181281, "num_agent_steps_sampled": 181281, "num_agent_steps_trained": 181281}, "done": false, "episodes_total": 996, "training_iteration": 84, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-14-19", "timestamp": 1706271259, "time_this_iter_s": 9.931957960128784, "time_total_s": 885.7123832702637, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 885.7123832702637, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 74.46666666666667, "ram_util_percent": 16.179999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38270343746989965, "cur_kl_coeff": 3.308722450212111e-25, "cur_lr": 0.0003, "total_loss": 7.733234107494354, "policy_loss": -0.0004525394178926945, "vf_loss": 9.67338165640831, "vf_explained_var": -3.413856029510498e-05, "kl": 0.0007441233732624064, "entropy": 0.5018561836332083, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2704.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 183628, "num_env_steps_trained": 183628, "num_agent_steps_sampled": 183628, "num_agent_steps_trained": 183628}, "sampler_results": {"episode_reward_max": 259.54034594496, "episode_reward_min": 84.2109140621908, "episode_reward_mean": 214.50924420743172, "episode_len_mean": 266.34, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749], "episode_lengths": [250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36321169846943663, "mean_inference_ms": 1.163886038478053, "mean_action_processing_ms": 0.1416394496650367, "mean_env_wait_ms": 3.0979481451795823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007060527801513672, "StateBufferConnector_ms": 0.005502223968505859, "ViewRequirementAgentConnector_ms": 0.14481449127197266}}, "episode_reward_max": 259.54034594496, "episode_reward_min": 84.2109140621908, "episode_reward_mean": 214.50924420743172, "episode_len_mean": 266.34, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [189.16551348443735, 185.20966877811836, 146.18318503939784, 224.9583558038068, 230.07575214074126, 232.5597148003882, 96.87990764214238, 228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749], "episode_lengths": [250, 216, 169, 301, 301, 301, 119, 301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36321169846943663, "mean_inference_ms": 1.163886038478053, "mean_action_processing_ms": 0.1416394496650367, "mean_env_wait_ms": 3.0979481451795823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007060527801513672, "StateBufferConnector_ms": 0.005502223968505859, "ViewRequirementAgentConnector_ms": 0.14481449127197266}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 183628, "num_agent_steps_trained": 183628, "num_env_steps_sampled": 183628, "num_env_steps_trained": 183628, "num_env_steps_sampled_this_iter": 2347, "num_env_steps_trained_this_iter": 2347, "num_env_steps_sampled_throughput_per_sec": 187.5510419652116, "num_env_steps_trained_throughput_per_sec": 187.5510419652116, "timesteps_total": 183628, "num_steps_trained_this_iter": 2347, "agent_timesteps_total": 183628, "timers": {"training_iteration_time_ms": 10603.852, "sample_time_ms": 10369.285, "load_time_ms": 0.474, "load_throughput": 4623202.212, "learn_time_ms": 233.661, "learn_throughput": 9383.257, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 183628, "num_env_steps_trained": 183628, "num_agent_steps_sampled": 183628, "num_agent_steps_trained": 183628}, "done": false, "episodes_total": 1004, "training_iteration": 85, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-14-32", "timestamp": 1706271272, "time_this_iter_s": 12.515529155731201, "time_total_s": 898.2279124259949, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 898.2279124259949, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 83.29444444444444, "ram_util_percent": 16.12222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.486587880179286, "cur_kl_coeff": 1.6543612251060554e-25, "cur_lr": 0.0003, "total_loss": 7.676798477768898, "policy_loss": -0.04038298176601529, "vf_loss": 9.652702331542969, "vf_explained_var": -0.00013895705342292786, "kl": 0.0019818834485647585, "entropy": 0.4980214787647128, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2736.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 185709, "num_env_steps_trained": 185709, "num_agent_steps_sampled": 185709, "num_agent_steps_trained": 185709}, "sampler_results": {"episode_reward_max": 259.54034594496, "episode_reward_min": 84.2109140621908, "episode_reward_mean": 217.92244875175777, "episode_len_mean": 270.58, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638], "episode_lengths": [301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3631539629275688, "mean_inference_ms": 1.1637360139826425, "mean_action_processing_ms": 0.1416178166868357, "mean_env_wait_ms": 3.0974417553037017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007084846496582031, "StateBufferConnector_ms": 0.0054891109466552734, "ViewRequirementAgentConnector_ms": 0.14516830444335938}}, "episode_reward_max": 259.54034594496, "episode_reward_min": 84.2109140621908, "episode_reward_mean": 217.92244875175777, "episode_len_mean": 270.58, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [228.94523964426065, 230.7740448705945, 129.82262526433624, 180.04152993672903, 231.4635335178229, 221.13855924853374, 133.29211409575188, 221.3894643897214, 258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638], "episode_lengths": [301, 301, 171, 215, 301, 301, 159, 301, 289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3631539629275688, "mean_inference_ms": 1.1637360139826425, "mean_action_processing_ms": 0.1416178166868357, "mean_env_wait_ms": 3.0974417553037017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007084846496582031, "StateBufferConnector_ms": 0.0054891109466552734, "ViewRequirementAgentConnector_ms": 0.14516830444335938}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185709, "num_agent_steps_trained": 185709, "num_env_steps_sampled": 185709, "num_env_steps_trained": 185709, "num_env_steps_sampled_this_iter": 2081, "num_env_steps_trained_this_iter": 2081, "num_env_steps_sampled_throughput_per_sec": 194.1366179968352, "num_env_steps_trained_throughput_per_sec": 194.1366179968352, "timesteps_total": 185709, "num_steps_trained_this_iter": 2081, "agent_timesteps_total": 185709, "timers": {"training_iteration_time_ms": 10674.261, "sample_time_ms": 10439.479, "load_time_ms": 0.477, "load_throughput": 4599757.584, "learn_time_ms": 233.869, "learn_throughput": 9371.896, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 185709, "num_env_steps_trained": 185709, "num_agent_steps_sampled": 185709, "num_agent_steps_trained": 185709}, "done": false, "episodes_total": 1011, "training_iteration": 86, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-14-43", "timestamp": 1706271283, "time_this_iter_s": 10.720296144485474, "time_total_s": 908.9482085704803, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 908.9482085704803, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 82.02666666666666, "ram_util_percent": 16.193333333333328}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38667355477809906, "cur_kl_coeff": 8.271806125530277e-26, "cur_lr": 0.0003, "total_loss": 7.682900488376617, "policy_loss": -0.03962675482034683, "vf_loss": 9.659487426280975, "vf_explained_var": 9.113363921642303e-05, "kl": 0.0010436911478053784, "entropy": 0.5062754331156611, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2768.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 187809, "num_env_steps_trained": 187809, "num_agent_steps_sampled": 187809, "num_agent_steps_trained": 187809}, "sampler_results": {"episode_reward_max": 259.54034594496, "episode_reward_min": 84.2109140621908, "episode_reward_mean": 219.0768884568926, "episode_len_mean": 271.08, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497], "episode_lengths": [289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36310824181577944, "mean_inference_ms": 1.1635935328782023, "mean_action_processing_ms": 0.1415971732007185, "mean_env_wait_ms": 3.0969798519686735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007139682769775391, "StateBufferConnector_ms": 0.005423069000244141, "ViewRequirementAgentConnector_ms": 0.1448071002960205}}, "episode_reward_max": 259.54034594496, "episode_reward_min": 84.2109140621908, "episode_reward_mean": 219.0768884568926, "episode_len_mean": 271.08, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [258.4370202994363, 231.44640958283864, 91.29039199980083, 223.02072842065581, 224.1395360688798, 228.20627406636825, 143.09744652338438, 185.70003144033006, 172.18684847132423, 227.81745935152102, 226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497], "episode_lengths": [289, 301, 111, 301, 301, 301, 166, 216, 201, 301, 301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36310824181577944, "mean_inference_ms": 1.1635935328782023, "mean_action_processing_ms": 0.1415971732007185, "mean_env_wait_ms": 3.0969798519686735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007139682769775391, "StateBufferConnector_ms": 0.005423069000244141, "ViewRequirementAgentConnector_ms": 0.1448071002960205}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187809, "num_agent_steps_trained": 187809, "num_env_steps_sampled": 187809, "num_env_steps_trained": 187809, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 205.34155205737676, "num_env_steps_trained_throughput_per_sec": 205.34155205737676, "timesteps_total": 187809, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 187809, "timers": {"training_iteration_time_ms": 10639.976, "sample_time_ms": 10393.496, "load_time_ms": 0.51, "load_throughput": 4287162.482, "learn_time_ms": 245.52, "learn_throughput": 8913.324, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 187809, "num_env_steps_trained": 187809, "num_agent_steps_sampled": 187809, "num_agent_steps_trained": 187809}, "done": false, "episodes_total": 1019, "training_iteration": 87, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-14-53", "timestamp": 1706271293, "time_this_iter_s": 10.228634119033813, "time_total_s": 919.1768426895142, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 919.1768426895142, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 75.80666666666667, "ram_util_percent": 16.17333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37679678248241544, "cur_kl_coeff": 4.1359030627651386e-26, "cur_lr": 0.0003, "total_loss": 7.680205821990967, "policy_loss": -0.011101325391791761, "vf_loss": 9.620866656303406, "vf_explained_var": -2.9001384973526e-06, "kl": 0.0022168968628977007, "entropy": 0.5386244971305132, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2800.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 189989, "num_env_steps_trained": 189989, "num_agent_steps_sampled": 189989, "num_agent_steps_trained": 189989}, "sampler_results": {"episode_reward_max": 259.54034594496, "episode_reward_min": 84.2109140621908, "episode_reward_mean": 217.74204514903101, "episode_len_mean": 268.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875], "episode_lengths": [301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.363062944478248, "mean_inference_ms": 1.1634460917107565, "mean_action_processing_ms": 0.14157604305888835, "mean_env_wait_ms": 3.0964265207840858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007128000259399414, "StateBufferConnector_ms": 0.005423784255981445, "ViewRequirementAgentConnector_ms": 0.14447474479675293}}, "episode_reward_max": 259.54034594496, "episode_reward_min": 84.2109140621908, "episode_reward_mean": 217.74204514903101, "episode_len_mean": 268.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [226.31257953771754, 236.15743377983046, 232.6240016376089, 181.66754460327215, 135.75781928367286, 231.15658441161395, 230.65367616410472, 217.03385830454366, 227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875], "episode_lengths": [301, 301, 301, 212, 162, 301, 301, 255, 301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.363062944478248, "mean_inference_ms": 1.1634460917107565, "mean_action_processing_ms": 0.14157604305888835, "mean_env_wait_ms": 3.0964265207840858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007128000259399414, "StateBufferConnector_ms": 0.005423784255981445, "ViewRequirementAgentConnector_ms": 0.14447474479675293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 189989, "num_agent_steps_trained": 189989, "num_env_steps_sampled": 189989, "num_env_steps_trained": 189989, "num_env_steps_sampled_this_iter": 2180, "num_env_steps_trained_this_iter": 2180, "num_env_steps_sampled_throughput_per_sec": 216.71695192373394, "num_env_steps_trained_throughput_per_sec": 216.71695192373394, "timesteps_total": 189989, "num_steps_trained_this_iter": 2180, "agent_timesteps_total": 189989, "timers": {"training_iteration_time_ms": 10517.545, "sample_time_ms": 10268.914, "load_time_ms": 0.506, "load_throughput": 4291496.802, "learn_time_ms": 247.669, "learn_throughput": 8771.381, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 189989, "num_env_steps_trained": 189989, "num_agent_steps_sampled": 189989, "num_agent_steps_trained": 189989}, "done": false, "episodes_total": 1029, "training_iteration": 88, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-15-03", "timestamp": 1706271303, "time_this_iter_s": 10.060590267181396, "time_total_s": 929.2374329566956, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 929.2374329566956, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 67.57857142857144, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4276613537222147, "cur_kl_coeff": 2.0679515313825693e-26, "cur_lr": 0.0003, "total_loss": 7.66473762691021, "policy_loss": -0.039850732529885136, "vf_loss": 9.637234658002853, "vf_explained_var": -4.1330233216285706e-05, "kl": 0.0019002607368168375, "entropy": 0.5199180468916893, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2832.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 192107, "num_env_steps_trained": 192107, "num_agent_steps_sampled": 192107, "num_agent_steps_trained": 192107}, "sampler_results": {"episode_reward_max": 259.54034594496, "episode_reward_min": 84.2109140621908, "episode_reward_mean": 217.81642140860615, "episode_len_mean": 267.84, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115], "episode_lengths": [301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3630391756547603, "mean_inference_ms": 1.163375355769343, "mean_action_processing_ms": 0.14156739502589702, "mean_env_wait_ms": 3.096093234327425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006952762603759766, "StateBufferConnector_ms": 0.005357503890991211, "ViewRequirementAgentConnector_ms": 0.14422106742858887}}, "episode_reward_max": 259.54034594496, "episode_reward_min": 84.2109140621908, "episode_reward_mean": 217.81642140860615, "episode_len_mean": 267.84, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [227.7443269599309, 228.92528014938975, 235.0887507636158, 234.70310240289115, 232.47941757089052, 194.72836381016378, 191.63221412651862, 179.65016644215333, 179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115], "episode_lengths": [301, 301, 262, 301, 301, 228, 223, 211, 212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3630391756547603, "mean_inference_ms": 1.163375355769343, "mean_action_processing_ms": 0.14156739502589702, "mean_env_wait_ms": 3.096093234327425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006952762603759766, "StateBufferConnector_ms": 0.005357503890991211, "ViewRequirementAgentConnector_ms": 0.14422106742858887}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192107, "num_agent_steps_trained": 192107, "num_env_steps_sampled": 192107, "num_env_steps_trained": 192107, "num_env_steps_sampled_this_iter": 2118, "num_env_steps_trained_this_iter": 2118, "num_env_steps_sampled_throughput_per_sec": 195.95885160878183, "num_env_steps_trained_throughput_per_sec": 195.95885160878183, "timesteps_total": 192107, "num_steps_trained_this_iter": 2118, "agent_timesteps_total": 192107, "timers": {"training_iteration_time_ms": 10635.854, "sample_time_ms": 10392.067, "load_time_ms": 0.477, "load_throughput": 4541070.566, "learn_time_ms": 242.858, "learn_throughput": 8924.159, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 192107, "num_env_steps_trained": 192107, "num_agent_steps_sampled": 192107, "num_agent_steps_trained": 192107}, "done": false, "episodes_total": 1037, "training_iteration": 89, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-15-14", "timestamp": 1706271314, "time_this_iter_s": 10.809553623199463, "time_total_s": 940.046986579895, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 940.046986579895, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 77.35, "ram_util_percent": 16.1375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5865078922361135, "cur_kl_coeff": 1.0339757656912847e-26, "cur_lr": 0.0003, "total_loss": 7.634187400341034, "policy_loss": -0.01676950469845906, "vf_loss": 9.570071190595627, "vf_explained_var": -0.00011619925498962402, "kl": 0.002388989466719782, "entropy": 0.5100206453353167, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2864.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 194278, "num_env_steps_trained": 194278, "num_agent_steps_sampled": 194278, "num_agent_steps_trained": 194278}, "sampler_results": {"episode_reward_max": 259.54034594496, "episode_reward_min": 84.2109140621908, "episode_reward_mean": 217.68026588852604, "episode_len_mean": 268.27, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166], "episode_lengths": [212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.363024698403691, "mean_inference_ms": 1.1633333959298913, "mean_action_processing_ms": 0.14156261398794331, "mean_env_wait_ms": 3.0958136906251257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007030963897705078, "StateBufferConnector_ms": 0.00536036491394043, "ViewRequirementAgentConnector_ms": 0.14457488059997559}}, "episode_reward_max": 259.54034594496, "episode_reward_min": 84.2109140621908, "episode_reward_mean": 217.68026588852604, "episode_len_mean": 268.27, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [179.63826488647476, 229.18790146111485, 233.5353784248837, 186.09696149473228, 84.2109140621908, 173.61171343014954, 235.26600622378947, 202.37789548794058, 231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166], "episode_lengths": [212, 301, 301, 221, 104, 203, 301, 236, 301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.363024698403691, "mean_inference_ms": 1.1633333959298913, "mean_action_processing_ms": 0.14156261398794331, "mean_env_wait_ms": 3.0958136906251257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007030963897705078, "StateBufferConnector_ms": 0.00536036491394043, "ViewRequirementAgentConnector_ms": 0.14457488059997559}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 194278, "num_agent_steps_trained": 194278, "num_env_steps_sampled": 194278, "num_env_steps_trained": 194278, "num_env_steps_sampled_this_iter": 2171, "num_env_steps_trained_this_iter": 2171, "num_env_steps_sampled_throughput_per_sec": 201.6588633864296, "num_env_steps_trained_throughput_per_sec": 201.6588633864296, "timesteps_total": 194278, "num_steps_trained_this_iter": 2171, "agent_timesteps_total": 194278, "timers": {"training_iteration_time_ms": 10661.011, "sample_time_ms": 10415.556, "load_time_ms": 0.469, "load_throughput": 4616913.034, "learn_time_ms": 244.528, "learn_throughput": 8850.505, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 194278, "num_env_steps_trained": 194278, "num_agent_steps_sampled": 194278, "num_agent_steps_trained": 194278}, "done": false, "episodes_total": 1045, "training_iteration": 90, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-15-25", "timestamp": 1706271325, "time_this_iter_s": 10.766782283782959, "time_total_s": 950.813768863678, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 950.813768863678, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 77.77333333333333, "ram_util_percent": 16.139999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5136381732299924, "cur_kl_coeff": 5.169878828456423e-27, "cur_lr": 0.0003, "total_loss": 7.649020627140999, "policy_loss": -0.03754265820316505, "vf_loss": 9.614752978086472, "vf_explained_var": 3.89833003282547e-05, "kl": 0.002097366130390615, "entropy": 0.5239083226770163, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2896.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 196409, "num_env_steps_trained": 196409, "num_agent_steps_sampled": 196409, "num_agent_steps_trained": 196409}, "sampler_results": {"episode_reward_max": 259.54034594496, "episode_reward_min": 150.5494054105166, "episode_reward_mean": 219.79281702074022, "episode_len_mean": 270.79, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568], "episode_lengths": [301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3630284892347113, "mean_inference_ms": 1.163354952425924, "mean_action_processing_ms": 0.1415669251806756, "mean_env_wait_ms": 3.095758064177884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006932258605957031, "StateBufferConnector_ms": 0.0053558349609375, "ViewRequirementAgentConnector_ms": 0.1447155475616455}}, "episode_reward_max": 259.54034594496, "episode_reward_min": 150.5494054105166, "episode_reward_mean": 219.79281702074022, "episode_len_mean": 270.79, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [231.84144272639801, 232.07603242105992, 230.8331800921719, 172.66919300434827, 181.53317306782458, 208.20225285397555, 159.71825389617098, 230.71584381528996, 233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568], "episode_lengths": [301, 301, 301, 201, 213, 243, 186, 301, 301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3630284892347113, "mean_inference_ms": 1.163354952425924, "mean_action_processing_ms": 0.1415669251806756, "mean_env_wait_ms": 3.095758064177884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006932258605957031, "StateBufferConnector_ms": 0.0053558349609375, "ViewRequirementAgentConnector_ms": 0.1447155475616455}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196409, "num_agent_steps_trained": 196409, "num_env_steps_sampled": 196409, "num_env_steps_trained": 196409, "num_env_steps_sampled_this_iter": 2131, "num_env_steps_trained_this_iter": 2131, "num_env_steps_sampled_throughput_per_sec": 202.59055322568713, "num_env_steps_trained_throughput_per_sec": 202.59055322568713, "timesteps_total": 196409, "num_steps_trained_this_iter": 2131, "agent_timesteps_total": 196409, "timers": {"training_iteration_time_ms": 10623.252, "sample_time_ms": 10366.312, "load_time_ms": 0.498, "load_throughput": 4327666.92, "learn_time_ms": 255.974, "learn_throughput": 8417.663, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 196409, "num_env_steps_trained": 196409, "num_agent_steps_sampled": 196409, "num_agent_steps_trained": 196409}, "done": false, "episodes_total": 1053, "training_iteration": 91, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-15-35", "timestamp": 1706271335, "time_this_iter_s": 10.520537376403809, "time_total_s": 961.3343062400818, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 961.3343062400818, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 76.03999999999999, "ram_util_percent": 15.966666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48974172584712505, "cur_kl_coeff": 2.5849394142282116e-27, "cur_lr": 0.0003, "total_loss": 7.670484974980354, "policy_loss": -0.022041521151550114, "vf_loss": 9.622194230556488, "vf_explained_var": -9.294599294662476e-07, "kl": 0.0017769961530973433, "entropy": 0.5228866096585989, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2928.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 198686, "num_env_steps_trained": 198686, "num_agent_steps_sampled": 198686, "num_agent_steps_trained": 198686}, "sampler_results": {"episode_reward_max": 265.480787635143, "episode_reward_min": 150.5494054105166, "episode_reward_mean": 222.09741614405266, "episode_len_mean": 273.09, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045], "episode_lengths": [301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36301987152916565, "mean_inference_ms": 1.163323598123377, "mean_action_processing_ms": 0.14156472550763924, "mean_env_wait_ms": 3.0954970583308237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006878852844238281, "StateBufferConnector_ms": 0.005362272262573242, "ViewRequirementAgentConnector_ms": 0.14371490478515625}}, "episode_reward_max": 265.480787635143, "episode_reward_min": 150.5494054105166, "episode_reward_mean": 222.09741614405266, "episode_len_mean": 273.09, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [233.7634944794803, 196.32282911688065, 179.00609720001898, 216.57393166580277, 215.87651707880832, 201.93673143729467, 249.03948551518795, 191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045], "episode_lengths": [301, 234, 212, 259, 253, 242, 301, 224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36301987152916565, "mean_inference_ms": 1.163323598123377, "mean_action_processing_ms": 0.14156472550763924, "mean_env_wait_ms": 3.0954970583308237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006878852844238281, "StateBufferConnector_ms": 0.005362272262573242, "ViewRequirementAgentConnector_ms": 0.14371490478515625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198686, "num_agent_steps_trained": 198686, "num_env_steps_sampled": 198686, "num_env_steps_trained": 198686, "num_env_steps_sampled_this_iter": 2277, "num_env_steps_trained_this_iter": 2277, "num_env_steps_sampled_throughput_per_sec": 231.10977369782407, "num_env_steps_trained_throughput_per_sec": 231.10977369782407, "timesteps_total": 198686, "num_steps_trained_this_iter": 2277, "agent_timesteps_total": 198686, "timers": {"training_iteration_time_ms": 10586.146, "sample_time_ms": 10328.298, "load_time_ms": 0.494, "load_throughput": 4407227.216, "learn_time_ms": 256.887, "learn_throughput": 8476.504, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 198686, "num_env_steps_trained": 198686, "num_agent_steps_sampled": 198686, "num_agent_steps_trained": 198686}, "done": false, "episodes_total": 1061, "training_iteration": 92, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-15-45", "timestamp": 1706271345, "time_this_iter_s": 9.85362982749939, "time_total_s": 971.1879360675812, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 971.1879360675812, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 66.86428571428571, "ram_util_percent": 16.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9327429011464119, "cur_kl_coeff": 1.2924697071141058e-27, "cur_lr": 0.0003, "total_loss": 7.579957351088524, "policy_loss": -0.04184637917205691, "vf_loss": 9.533808708190918, "vf_explained_var": -7.130950689315796e-05, "kl": 0.0018623534603292267, "entropy": 0.5243071876466274, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2960.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 200779, "num_env_steps_trained": 200779, "num_agent_steps_sampled": 200779, "num_agent_steps_trained": 200779}, "sampler_results": {"episode_reward_max": 265.480787635143, "episode_reward_min": 150.5494054105166, "episode_reward_mean": 223.68852134429187, "episode_len_mean": 276.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057], "episode_lengths": [224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36302526543353364, "mean_inference_ms": 1.1633138709903543, "mean_action_processing_ms": 0.14156559477861472, "mean_env_wait_ms": 3.0953385099494732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007046937942504883, "StateBufferConnector_ms": 0.005422830581665039, "ViewRequirementAgentConnector_ms": 0.14515018463134766}}, "episode_reward_max": 265.480787635143, "episode_reward_min": 150.5494054105166, "episode_reward_mean": 223.68852134429187, "episode_len_mean": 276.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [191.58887980199594, 215.78832387709053, 249.1453943987074, 247.2623526766908, 250.40523341284276, 235.53592997291148, 255.08061947041006, 243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057], "episode_lengths": [224, 260, 296, 301, 301, 301, 301, 301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36302526543353364, "mean_inference_ms": 1.1633138709903543, "mean_action_processing_ms": 0.14156559477861472, "mean_env_wait_ms": 3.0953385099494732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007046937942504883, "StateBufferConnector_ms": 0.005422830581665039, "ViewRequirementAgentConnector_ms": 0.14515018463134766}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200779, "num_agent_steps_trained": 200779, "num_env_steps_sampled": 200779, "num_env_steps_trained": 200779, "num_env_steps_sampled_this_iter": 2093, "num_env_steps_trained_this_iter": 2093, "num_env_steps_sampled_throughput_per_sec": 201.6232998076091, "num_env_steps_trained_throughput_per_sec": 201.6232998076091, "timesteps_total": 200779, "num_steps_trained_this_iter": 2093, "agent_timesteps_total": 200779, "timers": {"training_iteration_time_ms": 10577.588, "sample_time_ms": 10330.451, "load_time_ms": 0.478, "load_throughput": 4515544.046, "learn_time_ms": 246.199, "learn_throughput": 8775.434, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 200779, "num_env_steps_trained": 200779, "num_agent_steps_sampled": 200779, "num_agent_steps_trained": 200779}, "done": false, "episodes_total": 1068, "training_iteration": 93, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-15-56", "timestamp": 1706271356, "time_this_iter_s": 10.381882429122925, "time_total_s": 981.5698184967041, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 981.5698184967041, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 77.94000000000001, "ram_util_percent": 16.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8904986940324306, "cur_kl_coeff": 6.462348535570529e-28, "cur_lr": 0.0003, "total_loss": 7.590946972370148, "policy_loss": -0.042578617394610774, "vf_loss": 9.548455834388733, "vf_explained_var": -2.909824252128601e-05, "kl": 0.0017183781501447313, "entropy": 0.5239156950265169, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 2992.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 202886, "num_env_steps_trained": 202886, "num_agent_steps_sampled": 202886, "num_agent_steps_trained": 202886}, "sampler_results": {"episode_reward_max": 266.6815002206353, "episode_reward_min": 150.5494054105166, "episode_reward_mean": 224.12083570608513, "episode_len_mean": 277.23, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057, 266.6815002206353, 229.97292193591497, 265.0400508921451, 231.73269256012796, 231.9835389310668, 229.56524656075106, 233.0622186893349], "episode_lengths": [301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36303913526357917, "mean_inference_ms": 1.163315766957514, "mean_action_processing_ms": 0.1415678531608549, "mean_env_wait_ms": 3.0952256518586045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007073879241943359, "StateBufferConnector_ms": 0.005446910858154297, "ViewRequirementAgentConnector_ms": 0.14516401290893555}}, "episode_reward_max": 266.6815002206353, "episode_reward_min": 150.5494054105166, "episode_reward_mean": 224.12083570608513, "episode_len_mean": 277.23, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [243.69006056880383, 240.61735409968537, 218.01727114281377, 236.1864523050434, 241.05983724047545, 241.91111768880066, 235.09941744238944, 259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057, 266.6815002206353, 229.97292193591497, 265.0400508921451, 231.73269256012796, 231.9835389310668, 229.56524656075106, 233.0622186893349], "episode_lengths": [301, 301, 262, 301, 301, 282, 301, 301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301, 301, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36303913526357917, "mean_inference_ms": 1.163315766957514, "mean_action_processing_ms": 0.1415678531608549, "mean_env_wait_ms": 3.0952256518586045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007073879241943359, "StateBufferConnector_ms": 0.005446910858154297, "ViewRequirementAgentConnector_ms": 0.14516401290893555}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202886, "num_agent_steps_trained": 202886, "num_env_steps_sampled": 202886, "num_env_steps_trained": 202886, "num_env_steps_sampled_this_iter": 2107, "num_env_steps_trained_this_iter": 2107, "num_env_steps_sampled_throughput_per_sec": 199.83240630759946, "num_env_steps_trained_throughput_per_sec": 199.83240630759946, "timesteps_total": 202886, "num_steps_trained_this_iter": 2107, "agent_timesteps_total": 202886, "timers": {"training_iteration_time_ms": 10638.879, "sample_time_ms": 10389.856, "load_time_ms": 0.486, "load_throughput": 4449034.658, "learn_time_ms": 248.076, "learn_throughput": 8709.03, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 202886, "num_env_steps_trained": 202886, "num_agent_steps_sampled": 202886, "num_agent_steps_trained": 202886}, "done": false, "episodes_total": 1075, "training_iteration": 94, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-16-06", "timestamp": 1706271366, "time_this_iter_s": 10.544911861419678, "time_total_s": 992.1147303581238, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 992.1147303581238, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 77.39999999999999, "ram_util_percent": 16.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.758226867765188, "cur_kl_coeff": 3.2311742677852645e-28, "cur_lr": 0.0003, "total_loss": 7.281126037240028, "policy_loss": -0.04368309077108279, "vf_loss": 9.162494450807571, "vf_explained_var": 5.095638334751129e-05, "kl": 0.0021708339521526957, "entropy": 0.5186429107561707, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 3024.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 204984, "num_env_steps_trained": 204984, "num_agent_steps_sampled": 204984, "num_agent_steps_trained": 204984}, "sampler_results": {"episode_reward_max": 267.7608590321694, "episode_reward_min": 150.5494054105166, "episode_reward_mean": 224.24936363599863, "episode_len_mean": 277.72, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057, 266.6815002206353, 229.97292193591497, 265.0400508921451, 231.73269256012796, 231.9835389310668, 229.56524656075106, 233.0622186893349, 228.49474768789983, 226.8136636741622, 257.5294557907132, 267.7608590321694, 231.85398354289342, 230.10414403727125, 226.87744971425798], "episode_lengths": [301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 292, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3630494651384879, "mean_inference_ms": 1.163289111238824, "mean_action_processing_ms": 0.14156699863063527, "mean_env_wait_ms": 3.0949948899026754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006842613220214844, "StateBufferConnector_ms": 0.00542140007019043, "ViewRequirementAgentConnector_ms": 0.144927978515625}}, "episode_reward_max": 267.7608590321694, "episode_reward_min": 150.5494054105166, "episode_reward_mean": 224.24936363599863, "episode_len_mean": 277.72, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [259.54034594496, 235.4790728666037, 185.84079430752263, 232.51932698230144, 239.7205507917279, 239.41564664682218, 227.11835550698103, 238.34052167444597, 239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057, 266.6815002206353, 229.97292193591497, 265.0400508921451, 231.73269256012796, 231.9835389310668, 229.56524656075106, 233.0622186893349, 228.49474768789983, 226.8136636741622, 257.5294557907132, 267.7608590321694, 231.85398354289342, 230.10414403727125, 226.87744971425798], "episode_lengths": [301, 274, 216, 301, 301, 301, 268, 301, 301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 292, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3630494651384879, "mean_inference_ms": 1.163289111238824, "mean_action_processing_ms": 0.14156699863063527, "mean_env_wait_ms": 3.0949948899026754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006842613220214844, "StateBufferConnector_ms": 0.00542140007019043, "ViewRequirementAgentConnector_ms": 0.144927978515625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204984, "num_agent_steps_trained": 204984, "num_env_steps_sampled": 204984, "num_env_steps_trained": 204984, "num_env_steps_sampled_this_iter": 2098, "num_env_steps_trained_this_iter": 2098, "num_env_steps_sampled_throughput_per_sec": 209.93011320168475, "num_env_steps_trained_throughput_per_sec": 209.93011320168475, "timesteps_total": 204984, "num_steps_trained_this_iter": 2098, "agent_timesteps_total": 204984, "timers": {"training_iteration_time_ms": 10386.868, "sample_time_ms": 10138.236, "load_time_ms": 0.488, "load_throughput": 4376486.843, "learn_time_ms": 247.685, "learn_throughput": 8622.239, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 204984, "num_env_steps_trained": 204984, "num_agent_steps_sampled": 204984, "num_agent_steps_trained": 204984}, "done": false, "episodes_total": 1082, "training_iteration": 95, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-16-16", "timestamp": 1706271376, "time_this_iter_s": 9.995254516601562, "time_total_s": 1002.1099848747253, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 1002.1099848747253, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 74.62666666666665, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.424643455073237, "cur_kl_coeff": 1.6155871338926323e-28, "cur_lr": 0.0003, "total_loss": 6.815575025975704, "policy_loss": -0.013095333823002875, "vf_loss": 8.54209379851818, "vf_explained_var": 2.2251158952713013e-05, "kl": 0.001966388770776064, "entropy": 0.5004535159096122, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 3056.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 207169, "num_env_steps_trained": 207169, "num_agent_steps_sampled": 207169, "num_agent_steps_trained": 207169}, "sampler_results": {"episode_reward_max": 267.7608590321694, "episode_reward_min": 59.801488597361896, "episode_reward_mean": 223.03132300412727, "episode_len_mean": 276.94, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057, 266.6815002206353, 229.97292193591497, 265.0400508921451, 231.73269256012796, 231.9835389310668, 229.56524656075106, 233.0622186893349, 228.49474768789983, 226.8136636741622, 257.5294557907132, 267.7608590321694, 231.85398354289342, 230.10414403727125, 226.87744971425798, 228.06876475120237, 231.53327190376265, 264.22642054498516, 232.21665250010196, 59.801488597361896, 230.5380540470047, 228.68410321625134, 261.1017959735534], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 292, 301, 301, 301, 301, 301, 301, 301, 301, 78, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36305643597880627, "mean_inference_ms": 1.163245018319402, "mean_action_processing_ms": 0.14156460933784987, "mean_env_wait_ms": 3.094679964717153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068225860595703125, "StateBufferConnector_ms": 0.005383729934692383, "ViewRequirementAgentConnector_ms": 0.14417576789855957}}, "episode_reward_max": 267.7608590321694, "episode_reward_min": 59.801488597361896, "episode_reward_mean": 223.03132300412727, "episode_len_mean": 276.94, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [239.02811182901036, 232.91131438694163, 237.83460595839543, 257.22992187171883, 231.90918560856184, 240.40666050936719, 227.51833914367094, 235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057, 266.6815002206353, 229.97292193591497, 265.0400508921451, 231.73269256012796, 231.9835389310668, 229.56524656075106, 233.0622186893349, 228.49474768789983, 226.8136636741622, 257.5294557907132, 267.7608590321694, 231.85398354289342, 230.10414403727125, 226.87744971425798, 228.06876475120237, 231.53327190376265, 264.22642054498516, 232.21665250010196, 59.801488597361896, 230.5380540470047, 228.68410321625134, 261.1017959735534], "episode_lengths": [301, 301, 301, 301, 301, 301, 301, 301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 292, 301, 301, 301, 301, 301, 301, 301, 301, 78, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36305643597880627, "mean_inference_ms": 1.163245018319402, "mean_action_processing_ms": 0.14156460933784987, "mean_env_wait_ms": 3.094679964717153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068225860595703125, "StateBufferConnector_ms": 0.005383729934692383, "ViewRequirementAgentConnector_ms": 0.14417576789855957}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 207169, "num_agent_steps_trained": 207169, "num_env_steps_sampled": 207169, "num_env_steps_trained": 207169, "num_env_steps_sampled_this_iter": 2185, "num_env_steps_trained_this_iter": 2185, "num_env_steps_sampled_throughput_per_sec": 223.96692254553855, "num_env_steps_trained_throughput_per_sec": 223.96692254553855, "timesteps_total": 207169, "num_steps_trained_this_iter": 2185, "agent_timesteps_total": 207169, "timers": {"training_iteration_time_ms": 10290.533, "sample_time_ms": 10041.505, "load_time_ms": 0.486, "load_throughput": 4414623.76, "learn_time_ms": 248.086, "learn_throughput": 8650.23, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 207169, "num_env_steps_trained": 207169, "num_agent_steps_sampled": 207169, "num_agent_steps_trained": 207169}, "done": false, "episodes_total": 1090, "training_iteration": 96, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-16-26", "timestamp": 1706271386, "time_this_iter_s": 9.756920337677002, "time_total_s": 1011.8669052124023, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 1011.8669052124023, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 67.85714285714286, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.363055618945509, "cur_kl_coeff": 8.077935669463161e-29, "cur_lr": 0.0003, "total_loss": 7.126059025526047, "policy_loss": -0.038908785209059715, "vf_loss": 8.962710559368134, "vf_explained_var": 1.0691583156585693e-06, "kl": 0.00222822400070935, "entropy": 0.5200721342116594, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 3088.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 209268, "num_env_steps_trained": 209268, "num_agent_steps_sampled": 209268, "num_agent_steps_trained": 209268}, "sampler_results": {"episode_reward_max": 267.7608590321694, "episode_reward_min": 59.801488597361896, "episode_reward_mean": 224.05921201645415, "episode_len_mean": 276.86, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057, 266.6815002206353, 229.97292193591497, 265.0400508921451, 231.73269256012796, 231.9835389310668, 229.56524656075106, 233.0622186893349, 228.49474768789983, 226.8136636741622, 257.5294557907132, 267.7608590321694, 231.85398354289342, 230.10414403727125, 226.87744971425798, 228.06876475120237, 231.53327190376265, 264.22642054498516, 232.21665250010196, 59.801488597361896, 230.5380540470047, 228.68410321625134, 261.1017959735534, 255.9198642441225, 264.0539010002119, 225.81519527236713, 267.236595743661, 229.10940857473597, 261.55245150881296, 265.9396241964437], "episode_lengths": [301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 292, 301, 301, 301, 301, 301, 301, 301, 301, 78, 301, 301, 301, 293, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3630647867710081, "mean_inference_ms": 1.163226098859929, "mean_action_processing_ms": 0.14156672833113368, "mean_env_wait_ms": 3.0944791225740405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067980289459228516, "StateBufferConnector_ms": 0.005387544631958008, "ViewRequirementAgentConnector_ms": 0.14467334747314453}}, "episode_reward_max": 267.7608590321694, "episode_reward_min": 59.801488597361896, "episode_reward_mean": 224.05921201645415, "episode_len_mean": 276.86, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [235.73541552449876, 257.90458303923987, 236.20430775314523, 210.74795908984925, 237.20646369761894, 255.85030694405316, 243.48441789584749, 236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057, 266.6815002206353, 229.97292193591497, 265.0400508921451, 231.73269256012796, 231.9835389310668, 229.56524656075106, 233.0622186893349, 228.49474768789983, 226.8136636741622, 257.5294557907132, 267.7608590321694, 231.85398354289342, 230.10414403727125, 226.87744971425798, 228.06876475120237, 231.53327190376265, 264.22642054498516, 232.21665250010196, 59.801488597361896, 230.5380540470047, 228.68410321625134, 261.1017959735534, 255.9198642441225, 264.0539010002119, 225.81519527236713, 267.236595743661, 229.10940857473597, 261.55245150881296, 265.9396241964437], "episode_lengths": [301, 294, 301, 247, 301, 301, 301, 301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 292, 301, 301, 301, 301, 301, 301, 301, 301, 78, 301, 301, 301, 293, 301, 301, 301, 301, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3630647867710081, "mean_inference_ms": 1.163226098859929, "mean_action_processing_ms": 0.14156672833113368, "mean_env_wait_ms": 3.0944791225740405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067980289459228516, "StateBufferConnector_ms": 0.005387544631958008, "ViewRequirementAgentConnector_ms": 0.14467334747314453}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209268, "num_agent_steps_trained": 209268, "num_env_steps_sampled": 209268, "num_env_steps_trained": 209268, "num_env_steps_sampled_this_iter": 2099, "num_env_steps_trained_this_iter": 2099, "num_env_steps_sampled_throughput_per_sec": 202.95459767157806, "num_env_steps_trained_throughput_per_sec": 202.95459767157806, "timesteps_total": 209268, "num_steps_trained_this_iter": 2099, "agent_timesteps_total": 209268, "timers": {"training_iteration_time_ms": 10302.07, "sample_time_ms": 10066.569, "load_time_ms": 0.457, "load_throughput": 4698802.899, "learn_time_ms": 234.605, "learn_throughput": 9146.879, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 209268, "num_env_steps_trained": 209268, "num_agent_steps_sampled": 209268, "num_agent_steps_trained": 209268}, "done": false, "episodes_total": 1097, "training_iteration": 97, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-16-37", "timestamp": 1706271397, "time_this_iter_s": 10.34325885772705, "time_total_s": 1022.2101640701294, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 1022.2101640701294, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 78.64999999999999, "ram_util_percent": 16.15714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.239605671260506, "cur_kl_coeff": 4.0389678347315807e-29, "cur_lr": 0.0003, "total_loss": 6.818494617938995, "policy_loss": -0.034725133155006915, "vf_loss": 8.573006644845009, "vf_explained_var": 5.207955837249756e-06, "kl": 0.003080120632656341, "entropy": 0.5185821875929832, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 3120.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 211335, "num_env_steps_trained": 211335, "num_agent_steps_sampled": 211335, "num_agent_steps_trained": 211335}, "sampler_results": {"episode_reward_max": 267.7608590321694, "episode_reward_min": 59.801488597361896, "episode_reward_mean": 224.37971314864708, "episode_len_mean": 277.07, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057, 266.6815002206353, 229.97292193591497, 265.0400508921451, 231.73269256012796, 231.9835389310668, 229.56524656075106, 233.0622186893349, 228.49474768789983, 226.8136636741622, 257.5294557907132, 267.7608590321694, 231.85398354289342, 230.10414403727125, 226.87744971425798, 228.06876475120237, 231.53327190376265, 264.22642054498516, 232.21665250010196, 59.801488597361896, 230.5380540470047, 228.68410321625134, 261.1017959735534, 255.9198642441225, 264.0539010002119, 225.81519527236713, 267.236595743661, 229.10940857473597, 261.55245150881296, 265.9396241964437, 267.41850372894515, 227.8560411475705, 235.78811506724253, 264.2472823913266, 257.4082274325691, 228.82845776340437, 227.63693963249037], "episode_lengths": [301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 292, 301, 301, 301, 301, 301, 301, 301, 301, 78, 301, 301, 301, 293, 301, 301, 301, 301, 301, 301, 301, 301, 269, 300, 294, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3630497946668779, "mean_inference_ms": 1.1631548888072265, "mean_action_processing_ms": 0.1415621994933486, "mean_env_wait_ms": 3.0940681804541317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006747722625732422, "StateBufferConnector_ms": 0.005342245101928711, "ViewRequirementAgentConnector_ms": 0.14407682418823242}}, "episode_reward_max": 267.7608590321694, "episode_reward_min": 59.801488597361896, "episode_reward_mean": 224.37971314864708, "episode_len_mean": 277.07, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [236.06891044424412, 238.76911305971106, 234.67682338116472, 233.1691334775929, 237.4444487638595, 235.51253163066497, 230.71159136439638, 228.55098802606355, 235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057, 266.6815002206353, 229.97292193591497, 265.0400508921451, 231.73269256012796, 231.9835389310668, 229.56524656075106, 233.0622186893349, 228.49474768789983, 226.8136636741622, 257.5294557907132, 267.7608590321694, 231.85398354289342, 230.10414403727125, 226.87744971425798, 228.06876475120237, 231.53327190376265, 264.22642054498516, 232.21665250010196, 59.801488597361896, 230.5380540470047, 228.68410321625134, 261.1017959735534, 255.9198642441225, 264.0539010002119, 225.81519527236713, 267.236595743661, 229.10940857473597, 261.55245150881296, 265.9396241964437, 267.41850372894515, 227.8560411475705, 235.78811506724253, 264.2472823913266, 257.4082274325691, 228.82845776340437, 227.63693963249037], "episode_lengths": [301, 301, 301, 301, 301, 275, 301, 301, 301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 292, 301, 301, 301, 301, 301, 301, 301, 301, 78, 301, 301, 301, 293, 301, 301, 301, 301, 301, 301, 301, 301, 269, 300, 294, 301, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3630497946668779, "mean_inference_ms": 1.1631548888072265, "mean_action_processing_ms": 0.1415621994933486, "mean_env_wait_ms": 3.0940681804541317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006747722625732422, "StateBufferConnector_ms": 0.005342245101928711, "ViewRequirementAgentConnector_ms": 0.14407682418823242}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211335, "num_agent_steps_trained": 211335, "num_env_steps_sampled": 211335, "num_env_steps_trained": 211335, "num_env_steps_sampled_this_iter": 2067, "num_env_steps_trained_this_iter": 2067, "num_env_steps_sampled_throughput_per_sec": 203.23471167803928, "num_env_steps_trained_throughput_per_sec": 203.23471167803928, "timesteps_total": 211335, "num_steps_trained_this_iter": 2067, "agent_timesteps_total": 211335, "timers": {"training_iteration_time_ms": 10313.201, "sample_time_ms": 10078.708, "load_time_ms": 0.458, "load_throughput": 4663104.853, "learn_time_ms": 233.597, "learn_throughput": 9137.97, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 211335, "num_env_steps_trained": 211335, "num_agent_steps_sampled": 211335, "num_agent_steps_trained": 211335}, "done": false, "episodes_total": 1104, "training_iteration": 98, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-16-47", "timestamp": 1706271407, "time_this_iter_s": 10.171637535095215, "time_total_s": 1032.3818016052246, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 1032.3818016052246, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 77.46000000000001, "ram_util_percent": 16.179999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.158872872591019, "cur_kl_coeff": 2.0194839173657903e-29, "cur_lr": 0.0003, "total_loss": 5.6839795261621475, "policy_loss": -0.026044582249596715, "vf_loss": 7.143750004470348, "vf_explained_var": 2.8908252716064453e-06, "kl": 0.0025214293047558164, "entropy": 0.4975980017334223, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 3152.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 213558, "num_env_steps_trained": 213558, "num_agent_steps_sampled": 213558, "num_agent_steps_trained": 213558}, "sampler_results": {"episode_reward_max": 267.7608590321694, "episode_reward_min": 59.801488597361896, "episode_reward_mean": 223.41284795045033, "episode_len_mean": 275.48, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057, 266.6815002206353, 229.97292193591497, 265.0400508921451, 231.73269256012796, 231.9835389310668, 229.56524656075106, 233.0622186893349, 228.49474768789983, 226.8136636741622, 257.5294557907132, 267.7608590321694, 231.85398354289342, 230.10414403727125, 226.87744971425798, 228.06876475120237, 231.53327190376265, 264.22642054498516, 232.21665250010196, 59.801488597361896, 230.5380540470047, 228.68410321625134, 261.1017959735534, 255.9198642441225, 264.0539010002119, 225.81519527236713, 267.236595743661, 229.10940857473597, 261.55245150881296, 265.9396241964437, 267.41850372894515, 227.8560411475705, 235.78811506724253, 264.2472823913266, 257.4082274325691, 228.82845776340437, 227.63693963249037, 231.78664833010686, 201.94794489811378, 227.2621983839223, 231.1849295983879, 239.43662716270762, 229.33852272112267, 186.6228523090945, 230.6372969245661], "episode_lengths": [301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 292, 301, 301, 301, 301, 301, 301, 301, 301, 78, 301, 301, 301, 293, 301, 301, 301, 301, 301, 301, 301, 301, 269, 300, 294, 301, 301, 301, 231, 301, 301, 271, 301, 216, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3630211480546307, "mean_inference_ms": 1.1630120924391503, "mean_action_processing_ms": 0.14154748281230575, "mean_env_wait_ms": 3.0933141130952135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006851673126220703, "StateBufferConnector_ms": 0.005380392074584961, "ViewRequirementAgentConnector_ms": 0.144761323928833}}, "episode_reward_max": 267.7608590321694, "episode_reward_min": 59.801488597361896, "episode_reward_mean": 223.41284795045033, "episode_len_mean": 275.48, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [235.45373619384645, 185.42732094068293, 182.8777297362671, 211.7082752509587, 188.0977533157638, 231.26301099018787, 228.93226702746497, 174.79638689002837, 179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057, 266.6815002206353, 229.97292193591497, 265.0400508921451, 231.73269256012796, 231.9835389310668, 229.56524656075106, 233.0622186893349, 228.49474768789983, 226.8136636741622, 257.5294557907132, 267.7608590321694, 231.85398354289342, 230.10414403727125, 226.87744971425798, 228.06876475120237, 231.53327190376265, 264.22642054498516, 232.21665250010196, 59.801488597361896, 230.5380540470047, 228.68410321625134, 261.1017959735534, 255.9198642441225, 264.0539010002119, 225.81519527236713, 267.236595743661, 229.10940857473597, 261.55245150881296, 265.9396241964437, 267.41850372894515, 227.8560411475705, 235.78811506724253, 264.2472823913266, 257.4082274325691, 228.82845776340437, 227.63693963249037, 231.78664833010686, 201.94794489811378, 227.2621983839223, 231.1849295983879, 239.43662716270762, 229.33852272112267, 186.6228523090945, 230.6372969245661], "episode_lengths": [301, 218, 213, 246, 219, 301, 301, 205, 207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 292, 301, 301, 301, 301, 301, 301, 301, 301, 78, 301, 301, 301, 293, 301, 301, 301, 301, 301, 301, 301, 301, 269, 300, 294, 301, 301, 301, 231, 301, 301, 271, 301, 216, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3630211480546307, "mean_inference_ms": 1.1630120924391503, "mean_action_processing_ms": 0.14154748281230575, "mean_env_wait_ms": 3.0933141130952135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006851673126220703, "StateBufferConnector_ms": 0.005380392074584961, "ViewRequirementAgentConnector_ms": 0.144761323928833}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 213558, "num_agent_steps_trained": 213558, "num_env_steps_sampled": 213558, "num_env_steps_trained": 213558, "num_env_steps_sampled_this_iter": 2223, "num_env_steps_trained_this_iter": 2223, "num_env_steps_sampled_throughput_per_sec": 210.79825545419257, "num_env_steps_trained_throughput_per_sec": 210.79825545419257, "timesteps_total": 213558, "num_steps_trained_this_iter": 2223, "agent_timesteps_total": 213558, "timers": {"training_iteration_time_ms": 10286.924, "sample_time_ms": 10046.567, "load_time_ms": 0.477, "load_throughput": 4497701.215, "learn_time_ms": 239.418, "learn_throughput": 8959.661, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 213558, "num_env_steps_trained": 213558, "num_agent_steps_sampled": 213558, "num_agent_steps_trained": 213558}, "done": false, "episodes_total": 1112, "training_iteration": 99, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-16-58", "timestamp": 1706271418, "time_this_iter_s": 10.54716420173645, "time_total_s": 1042.928965806961, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 1042.928965806961, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 71.60666666666667, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.924714639782906, "cur_kl_coeff": 1.0097419586828952e-29, "cur_lr": 0.0003, "total_loss": 6.223578914999962, "policy_loss": -0.02685778500745073, "vf_loss": 7.819597080349922, "vf_explained_var": 3.034248948097229e-06, "kl": 0.001625749527677911, "entropy": 0.5240940172225237, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 3184.5, "diff_num_grad_updates_vs_sampler_policy": 15.5}}, "num_env_steps_sampled": 215697, "num_env_steps_trained": 215697, "num_agent_steps_sampled": 215697, "num_agent_steps_trained": 215697}, "sampler_results": {"episode_reward_max": 267.7608590321694, "episode_reward_min": 59.801488597361896, "episode_reward_mean": 225.00144211838335, "episode_len_mean": 276.83, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057, 266.6815002206353, 229.97292193591497, 265.0400508921451, 231.73269256012796, 231.9835389310668, 229.56524656075106, 233.0622186893349, 228.49474768789983, 226.8136636741622, 257.5294557907132, 267.7608590321694, 231.85398354289342, 230.10414403727125, 226.87744971425798, 228.06876475120237, 231.53327190376265, 264.22642054498516, 232.21665250010196, 59.801488597361896, 230.5380540470047, 228.68410321625134, 261.1017959735534, 255.9198642441225, 264.0539010002119, 225.81519527236713, 267.236595743661, 229.10940857473597, 261.55245150881296, 265.9396241964437, 267.41850372894515, 227.8560411475705, 235.78811506724253, 264.2472823913266, 257.4082274325691, 228.82845776340437, 227.63693963249037, 231.78664833010686, 201.94794489811378, 227.2621983839223, 231.1849295983879, 239.43662716270762, 229.33852272112267, 186.6228523090945, 230.6372969245661, 221.87310904466318, 212.063843481506, 228.7336911080833, 230.4913680980208, 211.292553707848, 241.48871603061508, 226.68474716773045, 224.78786850003152], "episode_lengths": [207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 292, 301, 301, 301, 301, 301, 301, 301, 301, 78, 301, 301, 301, 293, 301, 301, 301, 301, 301, 301, 301, 301, 269, 300, 294, 301, 301, 301, 231, 301, 301, 271, 301, 216, 301, 251, 248, 301, 262, 243, 277, 301, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3629915163483656, "mean_inference_ms": 1.1629282619322217, "mean_action_processing_ms": 0.14154168129776046, "mean_env_wait_ms": 3.092799295195364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006811618804931641, "StateBufferConnector_ms": 0.005399942398071289, "ViewRequirementAgentConnector_ms": 0.14508509635925293}}, "episode_reward_max": 267.7608590321694, "episode_reward_min": 59.801488597361896, "episode_reward_mean": 225.00144211838335, "episode_len_mean": 276.83, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [179.91982544912062, 178.30798029263758, 163.45710785399993, 232.67872988170475, 177.6373411730778, 179.01768563084428, 186.9300512194184, 172.32684852859012, 206.78585851895875, 232.8188446699888, 236.49837474943737, 174.22800466958896, 231.1505478444851, 178.7282473538465, 240.3717031886617, 177.58566496349226, 227.41973624037115, 162.75321072816664, 233.90303343126408, 230.56454864984798, 232.75973558371416, 236.48072737035824, 233.31911086581337, 231.00629817786466, 150.5494054105166, 232.8994006076143, 183.40634348221408, 211.2745439516957, 232.72303828081405, 231.06627669481534, 229.89447094651624, 186.0239624031396, 227.89211232588568, 234.54781752361964, 234.76713575507947, 234.6486672237807, 216.85750590986996, 224.5993864752612, 265.480787635143, 235.07121442456162, 232.07676926117045, 236.0429769193119, 228.96583519692598, 240.31778104136626, 231.8414565823556, 254.03925019377775, 230.63308020646414, 229.78922637719057, 266.6815002206353, 229.97292193591497, 265.0400508921451, 231.73269256012796, 231.9835389310668, 229.56524656075106, 233.0622186893349, 228.49474768789983, 226.8136636741622, 257.5294557907132, 267.7608590321694, 231.85398354289342, 230.10414403727125, 226.87744971425798, 228.06876475120237, 231.53327190376265, 264.22642054498516, 232.21665250010196, 59.801488597361896, 230.5380540470047, 228.68410321625134, 261.1017959735534, 255.9198642441225, 264.0539010002119, 225.81519527236713, 267.236595743661, 229.10940857473597, 261.55245150881296, 265.9396241964437, 267.41850372894515, 227.8560411475705, 235.78811506724253, 264.2472823913266, 257.4082274325691, 228.82845776340437, 227.63693963249037, 231.78664833010686, 201.94794489811378, 227.2621983839223, 231.1849295983879, 239.43662716270762, 229.33852272112267, 186.6228523090945, 230.6372969245661, 221.87310904466318, 212.063843481506, 228.7336911080833, 230.4913680980208, 211.292553707848, 241.48871603061508, 226.68474716773045, 224.78786850003152], "episode_lengths": [207, 207, 189, 301, 205, 208, 217, 202, 239, 301, 301, 202, 301, 204, 301, 207, 301, 189, 301, 301, 301, 301, 301, 301, 176, 301, 211, 241, 301, 301, 259, 216, 301, 301, 301, 301, 246, 258, 300, 269, 301, 301, 301, 301, 301, 287, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 301, 292, 301, 301, 301, 301, 301, 301, 301, 301, 78, 301, 301, 301, 293, 301, 301, 301, 301, 301, 301, 301, 301, 269, 300, 294, 301, 301, 301, 231, 301, 301, 271, 301, 216, 301, 251, 248, 301, 262, 243, 277, 301, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3629915163483656, "mean_inference_ms": 1.1629282619322217, "mean_action_processing_ms": 0.14154168129776046, "mean_env_wait_ms": 3.092799295195364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006811618804931641, "StateBufferConnector_ms": 0.005399942398071289, "ViewRequirementAgentConnector_ms": 0.14508509635925293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215697, "num_agent_steps_trained": 215697, "num_env_steps_sampled": 215697, "num_env_steps_trained": 215697, "num_env_steps_sampled_this_iter": 2139, "num_env_steps_trained_this_iter": 2139, "num_env_steps_sampled_throughput_per_sec": 194.28905757157483, "num_env_steps_trained_throughput_per_sec": 194.28905757157483, "timesteps_total": 215697, "num_steps_trained_this_iter": 2139, "agent_timesteps_total": 215697, "timers": {"training_iteration_time_ms": 10311.29, "sample_time_ms": 10071.623, "load_time_ms": 0.48, "load_throughput": 4461108.222, "learn_time_ms": 238.724, "learn_throughput": 8972.27, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 215697, "num_env_steps_trained": 215697, "num_agent_steps_sampled": 215697, "num_agent_steps_trained": 215697}, "done": true, "episodes_total": 1120, "training_iteration": 100, "trial_id": "5b9b0_00000", "date": "2024-01-26_12-17-09", "timestamp": 1706271429, "time_this_iter_s": 11.010771036148071, "time_total_s": 1053.9397368431091, "pid": 22552, "hostname": "0952f4717eb8", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPoleLeftRightEnv", "env_config": {"time_limit": 300}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": true, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x799034ec79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 8, "shuffle_sequences": true, "vf_loss_coeff": 0.8, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 1053.9397368431091, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 82.41250000000001, "ram_util_percent": 16.125}}
